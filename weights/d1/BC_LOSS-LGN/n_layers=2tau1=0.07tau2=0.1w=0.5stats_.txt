Epoch 0 [7.3s]: train==[2.71862=6.39166 + 2.71797 + 0.00089]
Epoch 1 [7.2s]: train==[2.63220=6.38702 + 2.63155 + 0.00089]
Epoch 2 [7.7s]: train==[2.54271=6.37670 + 2.54206 + 0.00089]
Epoch 3 [7.0s]: train==[2.46361=6.36521 + 2.46296 + 0.00089]
Epoch 4 [7.1s]: train==[2.37496=6.34930 + 2.37431 + 0.00089]
valid:{'recall': 0.042943645, 'hit_ratio': 0.12061206, 'precision': 0.016111627, 'ndcg': 0.029933771, 'mrr': 0.044414792, 'map': 0.04365142}
test_id:{'recall': 0.04618221, 'hit_ratio': 0.17, 'precision': 0.022833375, 'ndcg': 0.036642898, 'mrr': 0.059416007, 'map': 0.056555685}
Epoch 5 [8.9s]: train==[8.57110=6.23767 + 2.33255 + 0.00089]
Epoch 6 [8.8s]: train==[8.24951=5.91413 + 2.33449 + 0.00089]
Epoch 7 [8.5s]: train==[7.78033=5.44642 + 2.33301 + 0.00089]
Epoch 8 [8.6s]: train==[7.31780=4.98116 + 2.33576 + 0.00089]
Epoch 9 [8.7s]: train==[6.94721=4.62110 + 2.32522 + 0.00089]
valid:{'recall': 0.7978729, 'hit_ratio': 0.97029704, 'precision': 0.17398788, 'ndcg': 0.5556679, 'mrr': 0.5470319, 'map': 0.50696933}
test_id:{'recall': 0.844798, 'hit_ratio': 0.98333335, 'precision': 0.2839171, 'ndcg': 0.7849699, 'mrr': 0.8674306, 'map': 0.7937335}
Epoch 10 [8.8s]: train==[6.73172=4.39538 + 2.33545 + 0.00089]
Epoch 11 [8.1s]: train==[6.55832=4.22952 + 2.32791 + 0.00089]
Epoch 12 [12.4s]: train==[6.41920=4.09010 + 2.32822 + 0.00089]
Epoch 13 [10.6s]: train==[6.30770=3.97547 + 2.33134 + 0.00089]
Epoch 14 [13.8s]: train==[6.20153=3.87075 + 2.32988 + 0.00089]
valid:{'recall': 0.8704297, 'hit_ratio': 0.9990999, 'precision': 0.20450139, 'ndcg': 0.63331145, 'mrr': 0.6116162, 'map': 0.5625298}
test_id:{'recall': 0.9300536, 'hit_ratio': 1.0, 'precision': 0.33000037, 'ndcg': 0.9107165, 'mrr': 0.95539784, 'map': 0.91236603}
Epoch 15 [9.1s]: train==[6.10568=3.77423 + 2.33056 + 0.00089]
Epoch 16 [11.0s]: train==[6.01751=3.68330 + 2.33332 + 0.00089]
Epoch 17 [11.0s]: train==[5.92246=3.59349 + 2.32808 + 0.00089]
Epoch 18 [12.2s]: train==[5.82199=3.49039 + 2.33071 + 0.00089]
Epoch 19 [10.6s]: train==[5.74544=3.41403 + 2.33051 + 0.00089]
valid:{'recall': 0.89167184, 'hit_ratio': 1.0, 'precision': 0.21629255, 'ndcg': 0.6466241, 'mrr': 0.61460686, 'map': 0.5620929}
test_id:{'recall': 0.9483712, 'hit_ratio': 1.0, 'precision': 0.34575057, 'ndcg': 0.9450589, 'mrr': 0.9852361, 'map': 0.9438217}
Epoch 20 [9.8s]: train==[5.67238=3.33932 + 2.33217 + 0.00089]
Epoch 21 [11.0s]: train==[5.57622=3.24818 + 2.32714 + 0.00089]
Epoch 22 [11.9s]: train==[5.51314=3.17489 + 2.33736 + 0.00089]
Epoch 23 [11.1s]: train==[5.40935=3.08051 + 2.32795 + 0.00089]
Epoch 24 [13.7s]: train==[5.34101=3.00404 + 2.33608 + 0.00089]
valid:{'recall': 0.898825, 'hit_ratio': 1.0, 'precision': 0.22061309, 'ndcg': 0.6469824, 'mrr': 0.6120094, 'map': 0.5561667}
test_id:{'recall': 0.94895744, 'hit_ratio': 1.0, 'precision': 0.34725076, 'ndcg': 0.95105034, 'mrr': 0.99391663, 'map': 0.95049846}
Epoch 25 [13.3s]: train==[5.27634=2.94516 + 2.33029 + 0.00089]
Epoch 26 [12.2s]: train==[5.20843=2.87739 + 2.33015 + 0.00090]
Epoch 27 [13.3s]: train==[5.13515=2.80775 + 2.32651 + 0.00090]
Epoch 28 [9.0s]: train==[5.07130=2.73895 + 2.33145 + 0.00090]
Epoch 29 [15.2s]: train==[5.01653=2.68897 + 2.32667 + 0.00090]
valid:{'recall': 0.89754605, 'hit_ratio': 1.0, 'precision': 0.2189929, 'ndcg': 0.64572996, 'mrr': 0.6131945, 'map': 0.5554173}
test_id:{'recall': 0.94493747, 'hit_ratio': 1.0, 'precision': 0.34475073, 'ndcg': 0.9464598, 'mrr': 0.9930833, 'map': 0.9468264}
Epoch 30 [15.8s]: train==[4.95562=2.62386 + 2.33086 + 0.00090]
Epoch 31 [11.7s]: train==[4.90293=2.57607 + 2.32596 + 0.00090]
Epoch 32 [11.0s]: train==[4.84506=2.51749 + 2.32667 + 0.00090]
Epoch 33 [9.8s]: train==[4.80388=2.47545 + 2.32753 + 0.00090]
Epoch 34 [9.4s]: train==[4.75291=2.42876 + 2.32326 + 0.00090]
valid:{'recall': 0.8961145, 'hit_ratio': 1.0, 'precision': 0.21791276, 'ndcg': 0.64411145, 'mrr': 0.61354715, 'map': 0.5534744}
test_id:{'recall': 0.9411303, 'hit_ratio': 1.0, 'precision': 0.34375063, 'ndcg': 0.9426125, 'mrr': 0.99204165, 'map': 0.94265866}
Epoch 35 [11.3s]: train==[4.69699=2.36994 + 2.32616 + 0.00090]
Epoch 36 [14.5s]: train==[4.66955=2.33156 + 2.33710 + 0.00090]
Epoch 37 [11.2s]: train==[4.61062=2.28034 + 2.32938 + 0.00090]
Epoch 38 [10.1s]: train==[4.57172=2.24410 + 2.32672 + 0.00090]
Epoch 39 [10.8s]: train==[4.52592=2.19090 + 2.33411 + 0.00090]
valid:{'recall': 0.8942529, 'hit_ratio': 1.0, 'precision': 0.21719268, 'ndcg': 0.6408414, 'mrr': 0.6121397, 'map': 0.5506224}
test_id:{'recall': 0.9360903, 'hit_ratio': 1.0, 'precision': 0.34133396, 'ndcg': 0.9351472, 'mrr': 0.9919999, 'map': 0.93382794}
Epoch 40 [8.7s]: train==[4.50179=2.16420 + 2.33669 + 0.00090]
Epoch 41 [16.5s]: train==[4.45686=2.12250 + 2.33346 + 0.00090]
Epoch 42 [18.5s]: train==[4.41435=2.08390 + 2.32955 + 0.00090]
Epoch 43 [15.9s]: train==[4.37467=2.04648 + 2.32729 + 0.00090]
Epoch 44 [15.8s]: train==[4.34527=2.01751 + 2.32686 + 0.00090]
valid:{'recall': 0.8924815, 'hit_ratio': 1.0, 'precision': 0.21611254, 'ndcg': 0.6382482, 'mrr': 0.6056353, 'map': 0.54960144}
test_id:{'recall': 0.9312108, 'hit_ratio': 1.0, 'precision': 0.33983386, 'ndcg': 0.9284965, 'mrr': 0.9931528, 'map': 0.9247098}
Epoch 45 [16.6s]: train==[4.31691=1.98538 + 2.33063 + 0.00090]
Epoch 46 [14.3s]: train==[4.28868=1.95549 + 2.33229 + 0.00090]
Epoch 47 [18.3s]: train==[4.25455=1.91818 + 2.33547 + 0.00090]
Epoch 48 [22.1s]: train==[4.22271=1.89535 + 2.32645 + 0.00090]
Epoch 49 [13.4s]: train==[4.19451=1.86141 + 2.33220 + 0.00090]
valid:{'recall': 0.8896735, 'hit_ratio': 0.9990999, 'precision': 0.21512254, 'ndcg': 0.6426109, 'mrr': 0.61252695, 'map': 0.5585827}
test_id:{'recall': 0.92787975, 'hit_ratio': 1.0, 'precision': 0.3398338, 'ndcg': 0.92500275, 'mrr': 0.993125, 'map': 0.92102754}
Epoch 50 [14.4s]: train==[4.16809=1.83565 + 2.33154 + 0.00090]
Epoch 51 [15.0s]: train==[4.13818=1.80902 + 2.32825 + 0.00090]
Epoch 52 [15.3s]: train==[4.12011=1.79259 + 2.32662 + 0.00090]
Epoch 53 [17.4s]: train==[4.09446=1.76240 + 2.33115 + 0.00090]
Epoch 54 [14.0s]: train==[4.07696=1.74248 + 2.33357 + 0.00090]
valid:{'recall': 0.8872812, 'hit_ratio': 0.9981998, 'precision': 0.21395233, 'ndcg': 0.648386, 'mrr': 0.6222041, 'map': 0.5693026}
test_id:{'recall': 0.9225292, 'hit_ratio': 1.0, 'precision': 0.33800048, 'ndcg': 0.9214594, 'mrr': 0.98950005, 'map': 0.9219909}
Epoch 55 [18.0s]: train==[4.05337=1.72151 + 2.33095 + 0.00090]
Epoch 56 [9.6s]: train==[4.02236=1.69226 + 2.32920 + 0.00090]
Epoch 57 [8.9s]: train==[4.01508=1.68563 + 2.32855 + 0.00090]
Epoch 58 [14.6s]: train==[3.98881=1.65861 + 2.32930 + 0.00090]
Epoch 59 [9.8s]: train==[3.97131=1.64206 + 2.32834 + 0.00090]
valid:{'recall': 0.8880851, 'hit_ratio': 0.99729973, 'precision': 0.2140424, 'ndcg': 0.6558484, 'mrr': 0.6280007, 'map': 0.5801648}
test_id:{'recall': 0.92175007, 'hit_ratio': 1.0, 'precision': 0.3387505, 'ndcg': 0.92078936, 'mrr': 0.98709124, 'map': 0.9219713}
Epoch 60 [9.8s]: train==[3.94185=1.61443 + 2.32652 + 0.00090]
Epoch 61 [9.6s]: train==[3.93432=1.60875 + 2.32466 + 0.00090]
Epoch 62 [13.3s]: train==[3.90760=1.58486 + 2.32183 + 0.00090]
Epoch 63 [13.5s]: train==[3.90992=1.58106 + 2.32796 + 0.00090]
Epoch 64 [15.6s]: train==[3.88542=1.55546 + 2.32905 + 0.00090]
valid:{'recall': 0.8890793, 'hit_ratio': 0.99729973, 'precision': 0.21467243, 'ndcg': 0.65509, 'mrr': 0.62205255, 'map': 0.5791793}
test_id:{'recall': 0.91872597, 'hit_ratio': 0.99916667, 'precision': 0.33858398, 'ndcg': 0.91489744, 'mrr': 0.98231953, 'map': 0.9152723}
Epoch 65 [13.5s]: train==[3.88261=1.54855 + 2.33316 + 0.00090]
Epoch 66 [9.2s]: train==[3.85751=1.53405 + 2.32256 + 0.00090]
Epoch 67 [11.5s]: train==[3.85719=1.52698 + 2.32930 + 0.00090]
Epoch 68 [12.6s]: train==[3.84317=1.51366 + 2.32861 + 0.00090]
Epoch 69 [11.1s]: train==[3.82581=1.49499 + 2.32992 + 0.00090]
valid:{'recall': 0.8891636, 'hit_ratio': 0.99639964, 'precision': 0.21431237, 'ndcg': 0.65653676, 'mrr': 0.6202473, 'map': 0.5826609}
test_id:{'recall': 0.91475034, 'hit_ratio': 0.99916667, 'precision': 0.33733395, 'ndcg': 0.91149575, 'mrr': 0.980764, 'map': 0.9136155}
Epoch 70 [10.6s]: train==[3.81414=1.48144 + 2.33180 + 0.00090]
Epoch 71 [9.7s]: train==[3.81177=1.47576 + 2.33511 + 0.00090]
Epoch 72 [12.5s]: train==[3.79988=1.46901 + 2.32996 + 0.00090]
Epoch 73 [11.0s]: train==[3.78988=1.45605 + 2.33293 + 0.00090]
Epoch 74 [10.5s]: train==[3.77175=1.44571 + 2.32514 + 0.00090]
valid:{'recall': 0.88995236, 'hit_ratio': 0.99729973, 'precision': 0.21512245, 'ndcg': 0.6586639, 'mrr': 0.6249005, 'map': 0.5847396}
test_id:{'recall': 0.9151721, 'hit_ratio': 0.99916667, 'precision': 0.3377507, 'ndcg': 0.90957105, 'mrr': 0.979633, 'map': 0.9099491}
Epoch 75 [13.3s]: train==[3.76727=1.43614 + 2.33022 + 0.00090]
Epoch 76 [13.5s]: train==[3.75683=1.42562 + 2.33030 + 0.00090]
Epoch 77 [10.5s]: train==[3.74436=1.41305 + 2.33040 + 0.00090]
Epoch 78 [14.1s]: train==[3.74150=1.41129 + 2.32931 + 0.00090]
Epoch 79 [14.4s]: train==[3.73569=1.40565 + 2.32914 + 0.00090]
valid:{'recall': 0.8917974, 'hit_ratio': 0.99639964, 'precision': 0.21566255, 'ndcg': 0.65986615, 'mrr': 0.62378037, 'map': 0.5820253}
test_id:{'recall': 0.91309875, 'hit_ratio': 0.99833333, 'precision': 0.33683386, 'ndcg': 0.9047941, 'mrr': 0.9756249, 'map': 0.9038466}
Epoch 80 [13.6s]: train==[3.72975=1.39855 + 2.33031 + 0.00090]
Epoch 81 [10.3s]: train==[3.70744=1.37913 + 2.32741 + 0.00090]
Epoch 82 [12.4s]: train==[3.71180=1.37870 + 2.33221 + 0.00090]
Epoch 83 [13.2s]: train==[3.69709=1.36293 + 2.33326 + 0.00090]
Epoch 84 [11.9s]: train==[3.69804=1.36162 + 2.33552 + 0.00090]
valid:{'recall': 0.89262843, 'hit_ratio': 0.99639964, 'precision': 0.21683274, 'ndcg': 0.657113, 'mrr': 0.61616606, 'map': 0.5780966}
test_id:{'recall': 0.91469455, 'hit_ratio': 0.99833333, 'precision': 0.33758372, 'ndcg': 0.90388185, 'mrr': 0.97343045, 'map': 0.90074384}
Epoch 85 [13.7s]: train==[3.68802=1.35382 + 2.33330 + 0.00090]
Epoch 86 [9.7s]: train==[3.68136=1.34933 + 2.33113 + 0.00090]
Epoch 87 [12.8s]: train==[3.68222=1.34587 + 2.33544 + 0.00090]
Epoch 88 [13.5s]: train==[3.66425=1.33309 + 2.33026 + 0.00090]
Epoch 89 [12.7s]: train==[3.66624=1.33636 + 2.32898 + 0.00090]
valid:{'recall': 0.890827, 'hit_ratio': 0.99639964, 'precision': 0.21638265, 'ndcg': 0.65405786, 'mrr': 0.61494464, 'map': 0.5735779}
test_id:{'recall': 0.91667265, 'hit_ratio': 0.99833333, 'precision': 0.33841705, 'ndcg': 0.90339506, 'mrr': 0.973619, 'map': 0.8965457}
Epoch 90 [12.5s]: train==[3.66859=1.32975 + 2.33794 + 0.00090]
Epoch 91 [11.5s]: train==[3.65132=1.31898 + 2.33144 + 0.00090]
Epoch 92 [10.7s]: train==[3.64874=1.31098 + 2.33687 + 0.00090]
Epoch 93 [12.0s]: train==[3.62498=1.30091 + 2.32318 + 0.00090]
Epoch 94 [9.5s]: train==[3.63566=1.30670 + 2.32805 + 0.00090]
valid:{'recall': 0.8916927, 'hit_ratio': 0.99729973, 'precision': 0.21728274, 'ndcg': 0.6559218, 'mrr': 0.61640835, 'map': 0.5759917}
test_id:{'recall': 0.9163425, 'hit_ratio': 0.99833333, 'precision': 0.33841705, 'ndcg': 0.8996719, 'mrr': 0.9732915, 'map': 0.8884302}
Epoch 95 [14.5s]: train==[3.63412=1.30076 + 2.33247 + 0.00090]
Epoch 96 [12.5s]: train==[3.62056=1.28896 + 2.33070 + 0.00090]
Epoch 97 [10.8s]: train==[3.63541=1.30260 + 2.33191 + 0.00090]
Epoch 98 [17.9s]: train==[3.61839=1.28059 + 2.33691 + 0.00090]
Epoch 99 [10.1s]: train==[3.61847=1.28847 + 2.32910 + 0.00090]
valid:{'recall': 0.89237374, 'hit_ratio': 0.99729973, 'precision': 0.21755275, 'ndcg': 0.6516685, 'mrr': 0.60919255, 'map': 0.5714449}
test_id:{'recall': 0.91423035, 'hit_ratio': 0.99833333, 'precision': 0.33766702, 'ndcg': 0.89571786, 'mrr': 0.9638689, 'map': 0.8868983}
The best epoch is  24
valid:{'recall': 0.898825, 'hit_ratio': 1.0, 'precision': 0.22061309, 'ndcg': 0.6469824, 'mrr': 0.6120094, 'map': 0.5561667}
test_id:{'recall': 0.94895744, 'hit_ratio': 1.0, 'precision': 0.34725076, 'ndcg': 0.95105034, 'mrr': 0.99391663, 'map': 0.95049846}
The best epoch is  24
