Epoch 0 [4.7s]: train==[2.18584=5.91719 + 2.18551 + 0.00045]
Epoch 1 [3.6s]: train==[1.74913=5.86099 + 1.74880 + 0.00045]
Epoch 2 [4.5s]: train==[1.31856=5.80677 + 1.31823 + 0.00045]
Epoch 3 [4.1s]: train==[0.94330=5.74029 + 0.94297 + 0.00045]
Epoch 4 [3.6s]: train==[0.69641=5.67926 + 0.69608 + 0.00045]
valid:{'recall': 0.11823523, 'hit_ratio': 0.2628263, 'precision': 0.019486934, 'ndcg': 0.05963417, 'mrr': 0.068386875, 'map': 0.06177856}
test_id:{'recall': 0.11280744, 'hit_ratio': 0.33333334, 'precision': 0.028249925, 'ndcg': 0.0674231, 'mrr': 0.08683098, 'map': 0.07762864}
Epoch 5 [5.5s]: train==[5.33752=4.72741 + 0.60967 + 0.00045]
Epoch 6 [6.1s]: train==[3.99935=3.38481 + 0.61409 + 0.00045]
Epoch 7 [6.8s]: train==[3.47307=2.86009 + 0.61253 + 0.00045]
Epoch 8 [5.7s]: train==[3.16198=2.55018 + 0.61134 + 0.00045]
Epoch 9 [4.9s]: train==[2.92039=2.31035 + 0.60959 + 0.00045]
valid:{'recall': 0.96716136, 'hit_ratio': 1.0, 'precision': 0.13460921, 'ndcg': 0.6474002, 'mrr': 0.5594311, 'map': 0.5107629}
test_id:{'recall': 0.979714, 'hit_ratio': 1.0, 'precision': 0.18937534, 'ndcg': 0.94903237, 'mrr': 0.97919434, 'map': 0.9254018}
Epoch 10 [6.1s]: train==[2.73414=2.12821 + 0.60548 + 0.00045]
Epoch 11 [5.0s]: train==[2.56835=1.95766 + 0.61023 + 0.00045]
Epoch 12 [5.4s]: train==[2.42421=1.81345 + 0.61030 + 0.00045]
Epoch 13 [5.2s]: train==[2.30917=1.69584 + 0.61288 + 0.00045]
Epoch 14 [5.1s]: train==[2.19866=1.58706 + 0.61115 + 0.00045]
valid:{'recall': 0.9617487, 'hit_ratio': 1.0, 'precision': 0.13195392, 'ndcg': 0.6649187, 'mrr': 0.5976309, 'map': 0.5319293}
test_id:{'recall': 0.9782008, 'hit_ratio': 1.0, 'precision': 0.18912536, 'ndcg': 0.96217877, 'mrr': 0.99658334, 'map': 0.9419148}
Epoch 15 [5.6s]: train==[2.09330=1.48158 + 0.61126 + 0.00045]
Epoch 16 [6.5s]: train==[2.00866=1.39925 + 0.60895 + 0.00045]
Epoch 17 [5.3s]: train==[1.92524=1.31509 + 0.60969 + 0.00045]
Epoch 18 [7.4s]: train==[1.85685=1.24835 + 0.60805 + 0.00045]
Epoch 19 [6.0s]: train==[1.81577=1.20284 + 0.61247 + 0.00045]
valid:{'recall': 0.9595465, 'hit_ratio': 0.9981998, 'precision': 0.13231394, 'ndcg': 0.68766844, 'mrr': 0.6198853, 'map': 0.56534964}
test_id:{'recall': 0.9703224, 'hit_ratio': 1.0, 'precision': 0.18812534, 'ndcg': 0.9449872, 'mrr': 0.99440277, 'map': 0.91407156}
Epoch 20 [6.0s]: train==[1.76484=1.15181 + 0.61257 + 0.00045]
Epoch 21 [5.5s]: train==[1.71262=1.10197 + 0.61020 + 0.00045]
Epoch 22 [5.2s]: train==[1.68250=1.07202 + 0.61002 + 0.00045]
Epoch 23 [5.6s]: train==[1.66015=1.04932 + 0.61037 + 0.00045]
Epoch 24 [6.3s]: train==[1.63919=1.02534 + 0.61340 + 0.00045]
valid:{'recall': 0.96246725, 'hit_ratio': 0.9981998, 'precision': 0.1337091, 'ndcg': 0.6971903, 'mrr': 0.6287575, 'map': 0.57633007}
test_id:{'recall': 0.96500415, 'hit_ratio': 1.0, 'precision': 0.18804197, 'ndcg': 0.9313425, 'mrr': 0.98498017, 'map': 0.8960119}
Epoch 25 [6.0s]: train==[1.60085=0.99219 + 0.60821 + 0.00045]
Epoch 26 [6.2s]: train==[1.58434=0.97524 + 0.60865 + 0.00045]
Epoch 27 [6.1s]: train==[1.57160=0.96028 + 0.61087 + 0.00045]
Epoch 28 [5.9s]: train==[1.56630=0.95442 + 0.61143 + 0.00045]
Epoch 29 [6.1s]: train==[1.54376=0.93455 + 0.60876 + 0.00045]
valid:{'recall': 0.9587688, 'hit_ratio': 0.9981998, 'precision': 0.13258396, 'ndcg': 0.6837016, 'mrr': 0.6168763, 'map': 0.5596875}
test_id:{'recall': 0.96014374, 'hit_ratio': 1.0, 'precision': 0.1867086, 'ndcg': 0.9208552, 'mrr': 0.98423606, 'map': 0.8805175}
Epoch 30 [6.6s]: train==[1.53350=0.92759 + 0.60546 + 0.00045]
Epoch 31 [6.0s]: train==[1.52899=0.91932 + 0.60922 + 0.00045]
Epoch 32 [5.9s]: train==[1.53408=0.92196 + 0.61167 + 0.00045]
Epoch 33 [5.8s]: train==[1.51661=0.90551 + 0.61065 + 0.00045]
Epoch 34 [5.5s]: train==[1.50410=0.89553 + 0.60812 + 0.00045]
valid:{'recall': 0.95687807, 'hit_ratio': 0.9981998, 'precision': 0.1325389, 'ndcg': 0.6772981, 'mrr': 0.6066991, 'map': 0.5538332}
test_id:{'recall': 0.9634259, 'hit_ratio': 1.0, 'precision': 0.18770857, 'ndcg': 0.91818887, 'mrr': 0.9767639, 'map': 0.8740767}
Epoch 35 [5.5s]: train==[1.50751=0.89410 + 0.61295 + 0.00045]
Epoch 36 [5.9s]: train==[1.49905=0.88731 + 0.61129 + 0.00045]
Epoch 37 [6.1s]: train==[1.50391=0.88961 + 0.61385 + 0.00045]
Epoch 38 [6.0s]: train==[1.49195=0.88379 + 0.60771 + 0.00045]
Epoch 39 [6.6s]: train==[1.48926=0.87864 + 0.61017 + 0.00045]
valid:{'recall': 0.9548922, 'hit_ratio': 0.9981998, 'precision': 0.13154885, 'ndcg': 0.67984915, 'mrr': 0.615119, 'map': 0.5584013}
test_id:{'recall': 0.9590978, 'hit_ratio': 1.0, 'precision': 0.18608348, 'ndcg': 0.9103361, 'mrr': 0.97263885, 'map': 0.86427855}
Epoch 40 [5.5s]: train==[1.48010=0.87280 + 0.60685 + 0.00045]
Epoch 41 [7.5s]: train==[1.48428=0.87374 + 0.61009 + 0.00045]
Epoch 42 [5.8s]: train==[1.49182=0.87789 + 0.61349 + 0.00045]
Epoch 43 [5.6s]: train==[1.47981=0.86730 + 0.61206 + 0.00045]
Epoch 44 [5.3s]: train==[1.47422=0.86395 + 0.60982 + 0.00045]
valid:{'recall': 0.9546392, 'hit_ratio': 0.9981998, 'precision': 0.13168387, 'ndcg': 0.66850287, 'mrr': 0.5972042, 'map': 0.54441494}
test_id:{'recall': 0.95682335, 'hit_ratio': 1.0, 'precision': 0.18575016, 'ndcg': 0.90555817, 'mrr': 0.9660417, 'map': 0.8599535}
Epoch 45 [5.2s]: train==[1.46904=0.85813 + 0.61047 + 0.00045]
Epoch 46 [5.8s]: train==[1.48198=0.87216 + 0.60937 + 0.00045]
Epoch 47 [6.5s]: train==[1.47770=0.86621 + 0.61105 + 0.00045]
Epoch 48 [5.7s]: train==[1.46916=0.85711 + 0.61160 + 0.00045]
Epoch 49 [5.5s]: train==[1.46324=0.85399 + 0.60880 + 0.00045]
valid:{'recall': 0.955044, 'hit_ratio': 0.9981998, 'precision': 0.13154884, 'ndcg': 0.6719083, 'mrr': 0.60645777, 'map': 0.5471582}
test_id:{'recall': 0.95787865, 'hit_ratio': 1.0, 'precision': 0.1857502, 'ndcg': 0.9105527, 'mrr': 0.9711667, 'map': 0.8673577}
Epoch 50 [5.7s]: train==[1.47325=0.86246 + 0.61034 + 0.00045]
Epoch 51 [5.6s]: train==[1.46023=0.85558 + 0.60421 + 0.00045]
Epoch 52 [6.7s]: train==[1.47252=0.85917 + 0.61291 + 0.00045]
Epoch 53 [6.0s]: train==[1.47029=0.85752 + 0.61232 + 0.00045]
Epoch 54 [6.3s]: train==[1.46158=0.85234 + 0.60880 + 0.00045]
valid:{'recall': 0.95227337, 'hit_ratio': 0.9981998, 'precision': 0.13073875, 'ndcg': 0.66366756, 'mrr': 0.5933957, 'map': 0.53910863}
test_id:{'recall': 0.9532468, 'hit_ratio': 1.0, 'precision': 0.1842919, 'ndcg': 0.90094006, 'mrr': 0.9628194, 'map': 0.8559901}
Epoch 55 [5.9s]: train==[1.46762=0.85668 + 0.61049 + 0.00045]
Epoch 56 [5.7s]: train==[1.46036=0.84982 + 0.61010 + 0.00045]
Epoch 57 [6.1s]: train==[1.46995=0.85503 + 0.61447 + 0.00045]
Epoch 58 [5.7s]: train==[1.47373=0.86186 + 0.61142 + 0.00045]
Epoch 59 [5.6s]: train==[1.46556=0.85489 + 0.61022 + 0.00045]
valid:{'recall': 0.952365, 'hit_ratio': 0.9981998, 'precision': 0.13064875, 'ndcg': 0.6772506, 'mrr': 0.6178368, 'map': 0.55520177}
test_id:{'recall': 0.9552951, 'hit_ratio': 1.0, 'precision': 0.18458353, 'ndcg': 0.9068334, 'mrr': 0.96699536, 'map': 0.8651676}
Epoch 60 [6.1s]: train==[1.46950=0.85731 + 0.61174 + 0.00045]
Epoch 61 [5.5s]: train==[1.46433=0.85376 + 0.61013 + 0.00045]
Epoch 62 [5.8s]: train==[1.45759=0.84610 + 0.61105 + 0.00045]
Epoch 63 [5.8s]: train==[1.46461=0.85323 + 0.61094 + 0.00045]
Epoch 64 [6.7s]: train==[1.47555=0.86037 + 0.61473 + 0.00045]
valid:{'recall': 0.95034146, 'hit_ratio': 0.9981998, 'precision': 0.13019864, 'ndcg': 0.65987855, 'mrr': 0.5891103, 'map': 0.5355905}
test_id:{'recall': 0.9552116, 'hit_ratio': 1.0, 'precision': 0.18425027, 'ndcg': 0.9011803, 'mrr': 0.9652592, 'map': 0.8527472}
Epoch 65 [5.3s]: train==[1.45659=0.84852 + 0.60762 + 0.00045]
Epoch 66 [5.1s]: train==[1.46870=0.85556 + 0.61269 + 0.00045]
Epoch 67 [6.4s]: train==[1.47456=0.86056 + 0.61355 + 0.00045]
Epoch 68 [6.0s]: train==[1.45953=0.84794 + 0.61115 + 0.00045]
Epoch 69 [5.8s]: train==[1.46034=0.84923 + 0.61066 + 0.00045]
valid:{'recall': 0.94796795, 'hit_ratio': 0.9981998, 'precision': 0.12938859, 'ndcg': 0.67129016, 'mrr': 0.6080044, 'map': 0.5523447}
test_id:{'recall': 0.9528387, 'hit_ratio': 1.0, 'precision': 0.18391685, 'ndcg': 0.90309745, 'mrr': 0.9665693, 'map': 0.859351}
Epoch 70 [6.0s]: train==[1.46518=0.85429 + 0.61045 + 0.00045]
Epoch 71 [6.3s]: train==[1.46779=0.85454 + 0.61281 + 0.00045]
Epoch 72 [6.1s]: train==[1.45718=0.84934 + 0.60739 + 0.00045]
Epoch 73 [5.9s]: train==[1.46590=0.85360 + 0.61186 + 0.00045]
Epoch 74 [5.8s]: train==[1.46838=0.85778 + 0.61015 + 0.00045]
valid:{'recall': 0.9478585, 'hit_ratio': 0.9990999, 'precision': 0.12920853, 'ndcg': 0.6686982, 'mrr': 0.59965837, 'map': 0.55040616}
test_id:{'recall': 0.95270425, 'hit_ratio': 1.0, 'precision': 0.18341689, 'ndcg': 0.9022548, 'mrr': 0.96238345, 'map': 0.8595456}
Epoch 75 [6.5s]: train==[1.46439=0.85325 + 0.61069 + 0.00045]
Epoch 76 [6.1s]: train==[1.45950=0.84948 + 0.60957 + 0.00045]
Epoch 77 [6.0s]: train==[1.46320=0.85167 + 0.61108 + 0.00045]
Epoch 78 [5.9s]: train==[1.46342=0.85214 + 0.61084 + 0.00045]
Epoch 79 [5.7s]: train==[1.46762=0.85491 + 0.61226 + 0.00045]
valid:{'recall': 0.94914204, 'hit_ratio': 0.9990999, 'precision': 0.12965862, 'ndcg': 0.669375, 'mrr': 0.60365134, 'map': 0.5477518}
test_id:{'recall': 0.95342124, 'hit_ratio': 1.0, 'precision': 0.18333356, 'ndcg': 0.90331423, 'mrr': 0.9677157, 'map': 0.8592112}
Epoch 80 [5.7s]: train==[1.46655=0.85356 + 0.61254 + 0.00045]
Epoch 81 [5.3s]: train==[1.46749=0.85545 + 0.61159 + 0.00045]
Epoch 82 [5.9s]: train==[1.46588=0.85553 + 0.60990 + 0.00045]
Epoch 83 [6.3s]: train==[1.46119=0.84977 + 0.61097 + 0.00045]
Epoch 84 [6.3s]: train==[1.45983=0.85068 + 0.60871 + 0.00045]
valid:{'recall': 0.9505275, 'hit_ratio': 0.9990999, 'precision': 0.12979363, 'ndcg': 0.6697889, 'mrr': 0.6086366, 'map': 0.5460397}
test_id:{'recall': 0.9545733, 'hit_ratio': 1.0, 'precision': 0.18408355, 'ndcg': 0.90731066, 'mrr': 0.97110116, 'map': 0.86466116}
Epoch 85 [5.4s]: train==[1.46492=0.85068 + 0.61378 + 0.00045]
Epoch 86 [6.0s]: train==[1.46220=0.84979 + 0.61196 + 0.00045]
Epoch 87 [6.2s]: train==[1.46359=0.85003 + 0.61311 + 0.00045]
Epoch 88 [6.4s]: train==[1.46177=0.85015 + 0.61118 + 0.00045]
Epoch 89 [6.3s]: train==[1.45676=0.84620 + 0.61011 + 0.00045]
valid:{'recall': 0.9465685, 'hit_ratio': 0.9990999, 'precision': 0.12875849, 'ndcg': 0.66341764, 'mrr': 0.59534496, 'map': 0.542561}
test_id:{'recall': 0.9500551, 'hit_ratio': 1.0, 'precision': 0.18254189, 'ndcg': 0.89939076, 'mrr': 0.9678009, 'map': 0.8552076}
Epoch 90 [5.6s]: train==[1.45490=0.84465 + 0.60980 + 0.00045]
Epoch 91 [5.5s]: train==[1.46804=0.85248 + 0.61512 + 0.00045]
Epoch 92 [6.0s]: train==[1.45795=0.84678 + 0.61072 + 0.00045]
Epoch 93 [6.2s]: train==[1.46493=0.85256 + 0.61192 + 0.00045]
Epoch 94 [6.7s]: train==[1.45743=0.84965 + 0.60733 + 0.00045]
valid:{'recall': 0.94824463, 'hit_ratio': 1.0, 'precision': 0.12893853, 'ndcg': 0.6633604, 'mrr': 0.59699506, 'map': 0.54105943}
test_id:{'recall': 0.9494922, 'hit_ratio': 1.0, 'precision': 0.18250024, 'ndcg': 0.9063941, 'mrr': 0.97729623, 'map': 0.86747926}
Epoch 95 [6.6s]: train==[1.45276=0.84271 + 0.60960 + 0.00045]
Epoch 96 [5.2s]: train==[1.45702=0.84524 + 0.61133 + 0.00045]
Epoch 97 [6.0s]: train==[1.45912=0.84752 + 0.61115 + 0.00045]
Epoch 98 [7.2s]: train==[1.45994=0.84792 + 0.61157 + 0.00045]
Epoch 99 [5.7s]: train==[1.45383=0.84602 + 0.60736 + 0.00045]
valid:{'recall': 0.94510657, 'hit_ratio': 1.0, 'precision': 0.1284885, 'ndcg': 0.6701354, 'mrr': 0.6123415, 'map': 0.55250347}
test_id:{'recall': 0.9476104, 'hit_ratio': 1.0, 'precision': 0.18200018, 'ndcg': 0.90145326, 'mrr': 0.96805555, 'map': 0.86293924}
Epoch 100 [5.9s]: train==[1.45445=0.84146 + 0.61254 + 0.00045]
Epoch 101 [5.7s]: train==[1.45950=0.84789 + 0.61117 + 0.00045]
Epoch 102 [6.5s]: train==[1.46306=0.84999 + 0.61263 + 0.00045]
Epoch 103 [4.9s]: train==[1.45629=0.84608 + 0.60976 + 0.00045]
Epoch 104 [5.2s]: train==[1.46109=0.85149 + 0.60915 + 0.00045]
valid:{'recall': 0.9480455, 'hit_ratio': 0.9990999, 'precision': 0.12929855, 'ndcg': 0.6657087, 'mrr': 0.59912163, 'map': 0.54404837}
test_id:{'recall': 0.9468873, 'hit_ratio': 1.0, 'precision': 0.18170847, 'ndcg': 0.89433, 'mrr': 0.9611909, 'map': 0.85246545}
Epoch 105 [5.7s]: train==[1.45944=0.85029 + 0.60870 + 0.00045]
Epoch 106 [5.3s]: train==[1.46200=0.85045 + 0.61110 + 0.00045]
Epoch 107 [5.7s]: train==[1.45259=0.84244 + 0.60970 + 0.00045]
Epoch 108 [6.5s]: train==[1.46889=0.85621 + 0.61224 + 0.00045]
Epoch 109 [7.1s]: train==[1.45762=0.84933 + 0.60784 + 0.00045]
valid:{'recall': 0.94373274, 'hit_ratio': 0.9990999, 'precision': 0.1277684, 'ndcg': 0.66719997, 'mrr': 0.6102823, 'map': 0.5490903}
test_id:{'recall': 0.94721365, 'hit_ratio': 1.0, 'precision': 0.18162517, 'ndcg': 0.8984082, 'mrr': 0.96602315, 'map': 0.8580286}
The best epoch is  9
valid:{'recall': 0.96716136, 'hit_ratio': 1.0, 'precision': 0.13460921, 'ndcg': 0.6474002, 'mrr': 0.5594311, 'map': 0.5107629}
test_id:{'recall': 0.979714, 'hit_ratio': 1.0, 'precision': 0.18937534, 'ndcg': 0.94903237, 'mrr': 0.97919434, 'map': 0.9254018}
The best epoch is  9
Epoch 0 [4.7s]: train==[2.25198=6.00528 + 2.25165 + 0.00045]
Epoch 1 [4.3s]: train==[1.83050=5.95682 + 1.83017 + 0.00045]
Epoch 2 [5.1s]: train==[1.39744=5.89328 + 1.39711 + 0.00045]
Epoch 3 [4.9s]: train==[0.99367=5.82454 + 0.99334 + 0.00045]
Epoch 4 [4.9s]: train==[0.72981=5.77268 + 0.72948 + 0.00045]
valid:{'recall': 0.110559724, 'hit_ratio': 0.25112513, 'precision': 0.018766856, 'ndcg': 0.054154035, 'mrr': 0.060522195, 'map': 0.05499439}
test_id:{'recall': 0.09469325, 'hit_ratio': 0.30166668, 'precision': 0.024749955, 'ndcg': 0.0561173, 'mrr': 0.0745233, 'map': 0.06707483}
Epoch 5 [5.7s]: train==[5.46642=4.83552 + 0.63045 + 0.00045]
Epoch 6 [6.1s]: train==[4.05876=3.43217 + 0.62613 + 0.00045]
Epoch 7 [7.1s]: train==[3.54732=2.92068 + 0.62619 + 0.00045]
Epoch 8 [8.0s]: train==[3.23749=2.61194 + 0.62509 + 0.00046]
Epoch 9 [6.6s]: train==[3.00874=2.38222 + 0.62607 + 0.00046]
valid:{'recall': 0.9677286, 'hit_ratio': 1.0, 'precision': 0.13456419, 'ndcg': 0.6753978, 'mrr': 0.6029796, 'map': 0.5431055}
test_id:{'recall': 0.9806222, 'hit_ratio': 1.0, 'precision': 0.19020866, 'ndcg': 0.9436388, 'mrr': 0.9665555, 'map': 0.9205204}
Epoch 10 [6.6s]: train==[2.81453=2.18468 + 0.62939 + 0.00046]
Epoch 11 [6.0s]: train==[2.64073=2.00884 + 0.63144 + 0.00046]
Epoch 12 [5.8s]: train==[2.50189=1.87240 + 0.62904 + 0.00046]
Epoch 13 [5.7s]: train==[2.37312=1.74639 + 0.62628 + 0.00046]
Epoch 14 [5.9s]: train==[2.26669=1.63886 + 0.62737 + 0.00046]
valid:{'recall': 0.9594358, 'hit_ratio': 1.0, 'precision': 0.13100882, 'ndcg': 0.67840713, 'mrr': 0.61074877, 'map': 0.55043584}
test_id:{'recall': 0.98003703, 'hit_ratio': 1.0, 'precision': 0.19012533, 'ndcg': 0.9604351, 'mrr': 0.9900278, 'map': 0.9388916}
Epoch 15 [6.1s]: train==[2.14945=1.52254 + 0.62646 + 0.00046]
Epoch 16 [5.6s]: train==[2.06646=1.43772 + 0.62828 + 0.00046]
Epoch 17 [5.0s]: train==[1.98618=1.36047 + 0.62525 + 0.00046]
Epoch 18 [7.3s]: train==[1.90850=1.28301 + 0.62504 + 0.00046]
Epoch 19 [6.6s]: train==[1.84582=1.21882 + 0.62655 + 0.00046]
valid:{'recall': 0.9571712, 'hit_ratio': 0.9990999, 'precision': 0.13132383, 'ndcg': 0.68284255, 'mrr': 0.6216859, 'map': 0.55738455}
test_id:{'recall': 0.9703111, 'hit_ratio': 1.0, 'precision': 0.18770863, 'ndcg': 0.94892627, 'mrr': 0.9928816, 'map': 0.92144144}
Epoch 20 [6.0s]: train==[1.79133=1.16571 + 0.62516 + 0.00046]
Epoch 21 [5.6s]: train==[1.75545=1.12817 + 0.62682 + 0.00046]
Epoch 22 [6.5s]: train==[1.71207=1.08668 + 0.62493 + 0.00046]
Epoch 23 [5.9s]: train==[1.69183=1.06419 + 0.62717 + 0.00046]
Epoch 24 [6.2s]: train==[1.65577=1.02893 + 0.62638 + 0.00046]
valid:{'recall': 0.95742416, 'hit_ratio': 0.9981998, 'precision': 0.13217889, 'ndcg': 0.70066726, 'mrr': 0.6446437, 'map': 0.5835408}
test_id:{'recall': 0.9694781, 'hit_ratio': 1.0, 'precision': 0.18866697, 'ndcg': 0.9316392, 'mrr': 0.98225045, 'map': 0.890702}
Epoch 25 [6.0s]: train==[1.64343=1.01502 + 0.62795 + 0.00046]
Epoch 26 [5.9s]: train==[1.62420=0.99671 + 0.62703 + 0.00046]
Epoch 27 [6.6s]: train==[1.60500=0.97692 + 0.62762 + 0.00046]
Epoch 28 [6.0s]: train==[1.59093=0.96318 + 0.62729 + 0.00046]
Epoch 29 [6.2s]: train==[1.57393=0.94555 + 0.62792 + 0.00046]
valid:{'recall': 0.95511776, 'hit_ratio': 0.9990999, 'precision': 0.1314588, 'ndcg': 0.6953491, 'mrr': 0.64032793, 'map': 0.5792989}
test_id:{'recall': 0.97088134, 'hit_ratio': 1.0, 'precision': 0.18941693, 'ndcg': 0.9293056, 'mrr': 0.9848952, 'map': 0.88357836}
Epoch 30 [6.7s]: train==[1.56224=0.93550 + 0.62629 + 0.00046]
Epoch 31 [5.8s]: train==[1.55776=0.93119 + 0.62611 + 0.00045]
Epoch 32 [5.6s]: train==[1.55201=0.92137 + 0.63019 + 0.00045]
Epoch 33 [5.1s]: train==[1.54613=0.91823 + 0.62745 + 0.00045]
Epoch 34 [5.7s]: train==[1.52735=0.90038 + 0.62651 + 0.00045]
valid:{'recall': 0.95570254, 'hit_ratio': 0.9990999, 'precision': 0.13159381, 'ndcg': 0.6832831, 'mrr': 0.616913, 'map': 0.56285435}
test_id:{'recall': 0.970954, 'hit_ratio': 1.0, 'precision': 0.19000022, 'ndcg': 0.9245427, 'mrr': 0.9754604, 'map': 0.8774683}
Epoch 35 [6.1s]: train==[1.53463=0.90496 + 0.62921 + 0.00045]
Epoch 36 [5.8s]: train==[1.52044=0.89546 + 0.62452 + 0.00045]
Epoch 37 [5.9s]: train==[1.51324=0.88557 + 0.62722 + 0.00045]
Epoch 38 [5.4s]: train==[1.51442=0.88789 + 0.62608 + 0.00045]
Epoch 39 [5.9s]: train==[1.51675=0.88599 + 0.63031 + 0.00045]
valid:{'recall': 0.95154214, 'hit_ratio': 0.9981998, 'precision': 0.13010865, 'ndcg': 0.68600523, 'mrr': 0.6327765, 'map': 0.5682689}
test_id:{'recall': 0.96353537, 'hit_ratio': 1.0, 'precision': 0.1871669, 'ndcg': 0.91859007, 'mrr': 0.97406465, 'map': 0.8755894}
Epoch 40 [7.1s]: train==[1.51058=0.88285 + 0.62728 + 0.00045]
Epoch 41 [6.7s]: train==[1.51497=0.88715 + 0.62737 + 0.00045]
Epoch 42 [6.4s]: train==[1.50692=0.87666 + 0.62981 + 0.00045]
Epoch 43 [5.8s]: train==[1.50229=0.87262 + 0.62922 + 0.00045]
Epoch 44 [5.7s]: train==[1.50735=0.88022 + 0.62668 + 0.00045]
valid:{'recall': 0.94850117, 'hit_ratio': 0.9990999, 'precision': 0.12929866, 'ndcg': 0.6806544, 'mrr': 0.6181659, 'map': 0.5648564}
test_id:{'recall': 0.965199, 'hit_ratio': 1.0, 'precision': 0.18754192, 'ndcg': 0.91710126, 'mrr': 0.97389793, 'map': 0.8695523}
Epoch 45 [5.5s]: train==[1.49380=0.86807 + 0.62528 + 0.00045]
Epoch 46 [6.3s]: train==[1.50485=0.87187 + 0.63253 + 0.00045]
Epoch 47 [5.7s]: train==[1.50287=0.87525 + 0.62717 + 0.00045]
Epoch 48 [6.0s]: train==[1.49285=0.86719 + 0.62521 + 0.00045]
Epoch 49 [6.0s]: train==[1.48832=0.86102 + 0.62684 + 0.00045]
valid:{'recall': 0.9498704, 'hit_ratio': 0.9990999, 'precision': 0.12961364, 'ndcg': 0.6851866, 'mrr': 0.62522125, 'map': 0.5692271}
test_id:{'recall': 0.9630654, 'hit_ratio': 1.0, 'precision': 0.18720856, 'ndcg': 0.91863066, 'mrr': 0.97410613, 'map': 0.8760613}
Epoch 50 [6.4s]: train==[1.50116=0.87031 + 0.63040 + 0.00045]
Epoch 51 [7.0s]: train==[1.48516=0.86165 + 0.62306 + 0.00045]
Epoch 52 [6.5s]: train==[1.48547=0.85992 + 0.62510 + 0.00045]
Epoch 53 [6.2s]: train==[1.48357=0.85782 + 0.62530 + 0.00045]
Epoch 54 [6.9s]: train==[1.49765=0.86840 + 0.62881 + 0.00045]
valid:{'recall': 0.94661915, 'hit_ratio': 0.9981998, 'precision': 0.12848854, 'ndcg': 0.67531013, 'mrr': 0.6135524, 'map': 0.5588143}
test_id:{'recall': 0.959256, 'hit_ratio': 1.0, 'precision': 0.18604188, 'ndcg': 0.90865356, 'mrr': 0.9633681, 'map': 0.8643885}
Epoch 55 [6.1s]: train==[1.48429=0.86004 + 0.62380 + 0.00045]
Epoch 56 [5.6s]: train==[1.49150=0.86324 + 0.62782 + 0.00045]
Epoch 57 [5.5s]: train==[1.48758=0.86155 + 0.62558 + 0.00045]
Epoch 58 [5.9s]: train==[1.48405=0.85605 + 0.62755 + 0.00045]
Epoch 59 [5.5s]: train==[1.49112=0.86144 + 0.62923 + 0.00045]
valid:{'recall': 0.9481953, 'hit_ratio': 0.9981998, 'precision': 0.12862355, 'ndcg': 0.67291385, 'mrr': 0.6075026, 'map': 0.55566686}
test_id:{'recall': 0.95361316, 'hit_ratio': 1.0, 'precision': 0.18429185, 'ndcg': 0.90725416, 'mrr': 0.96480715, 'map': 0.8687259}
Epoch 60 [6.1s]: train==[1.48884=0.86095 + 0.62745 + 0.00045]
Epoch 61 [5.4s]: train==[1.49213=0.86443 + 0.62725 + 0.00045]
Epoch 62 [6.4s]: train==[1.47728=0.85264 + 0.62419 + 0.00045]
Epoch 63 [6.8s]: train==[1.48547=0.85666 + 0.62836 + 0.00045]
Epoch 64 [5.7s]: train==[1.48469=0.85923 + 0.62501 + 0.00045]
valid:{'recall': 0.9438437, 'hit_ratio': 0.9981998, 'precision': 0.12763338, 'ndcg': 0.66755426, 'mrr': 0.60243464, 'map': 0.55069363}
test_id:{'recall': 0.9562148, 'hit_ratio': 0.99916667, 'precision': 0.18475018, 'ndcg': 0.9072067, 'mrr': 0.9686694, 'map': 0.8627476}
Epoch 65 [5.7s]: train==[1.48377=0.85725 + 0.62607 + 0.00045]
Epoch 66 [5.9s]: train==[1.49045=0.86049 + 0.62951 + 0.00045]
Epoch 67 [5.7s]: train==[1.47824=0.85028 + 0.62752 + 0.00045]
Epoch 68 [6.2s]: train==[1.47579=0.84974 + 0.62560 + 0.00045]
Epoch 69 [6.4s]: train==[1.47805=0.85401 + 0.62360 + 0.00045]
valid:{'recall': 0.9432515, 'hit_ratio': 0.9990999, 'precision': 0.12767841, 'ndcg': 0.6681497, 'mrr': 0.60352784, 'map': 0.55246633}
test_id:{'recall': 0.95690644, 'hit_ratio': 1.0, 'precision': 0.18487522, 'ndcg': 0.9116938, 'mrr': 0.9716355, 'map': 0.87058663}
Epoch 70 [5.9s]: train==[1.48756=0.86402 + 0.62309 + 0.00045]
Epoch 71 [5.5s]: train==[1.48002=0.85429 + 0.62528 + 0.00045]
Epoch 72 [5.8s]: train==[1.47963=0.85283 + 0.62635 + 0.00045]
Epoch 73 [6.6s]: train==[1.48078=0.85289 + 0.62745 + 0.00045]
Epoch 74 [5.7s]: train==[1.48745=0.85699 + 0.63001 + 0.00045]
valid:{'recall': 0.9437407, 'hit_ratio': 0.9981998, 'precision': 0.12772341, 'ndcg': 0.66546315, 'mrr': 0.5977354, 'map': 0.54790336}
test_id:{'recall': 0.9515036, 'hit_ratio': 0.99916667, 'precision': 0.18287522, 'ndcg': 0.8998232, 'mrr': 0.96018463, 'map': 0.8566542}
Epoch 75 [6.2s]: train==[1.48724=0.86056 + 0.62623 + 0.00045]
Epoch 76 [6.3s]: train==[1.48880=0.85921 + 0.62914 + 0.00045]
Epoch 77 [5.7s]: train==[1.48522=0.85896 + 0.62581 + 0.00045]
Epoch 78 [6.3s]: train==[1.49198=0.86253 + 0.62900 + 0.00045]
Epoch 79 [6.5s]: train==[1.47981=0.85582 + 0.62354 + 0.00045]
valid:{'recall': 0.9424283, 'hit_ratio': 0.9990999, 'precision': 0.12718335, 'ndcg': 0.6690219, 'mrr': 0.6081864, 'map': 0.5533703}
test_id:{'recall': 0.94995594, 'hit_ratio': 1.0, 'precision': 0.18245855, 'ndcg': 0.9051057, 'mrr': 0.96734357, 'map': 0.86706513}
Epoch 80 [5.7s]: train==[1.47889=0.84780 + 0.63064 + 0.00045]
Epoch 81 [5.8s]: train==[1.48686=0.86064 + 0.62576 + 0.00045]
Epoch 82 [5.9s]: train==[1.47701=0.85212 + 0.62444 + 0.00045]
Epoch 83 [5.9s]: train==[1.48688=0.85944 + 0.62699 + 0.00045]
Epoch 84 [6.0s]: train==[1.48416=0.85754 + 0.62617 + 0.00045]
valid:{'recall': 0.9440845, 'hit_ratio': 0.9981998, 'precision': 0.12808344, 'ndcg': 0.67056954, 'mrr': 0.60647565, 'map': 0.55531204}
test_id:{'recall': 0.9559987, 'hit_ratio': 1.0, 'precision': 0.18437521, 'ndcg': 0.90778995, 'mrr': 0.9613142, 'map': 0.86799175}
Epoch 85 [5.7s]: train==[1.48031=0.85014 + 0.62972 + 0.00045]
Epoch 86 [5.9s]: train==[1.48829=0.86021 + 0.62764 + 0.00045]
Epoch 87 [6.0s]: train==[1.48861=0.85830 + 0.62986 + 0.00045]
Epoch 88 [5.1s]: train==[1.47288=0.85096 + 0.62147 + 0.00045]
Epoch 89 [6.1s]: train==[1.48020=0.85382 + 0.62593 + 0.00045]
valid:{'recall': 0.94467455, 'hit_ratio': 0.9981998, 'precision': 0.1275884, 'ndcg': 0.6728961, 'mrr': 0.6074016, 'map': 0.5574059}
test_id:{'recall': 0.95364827, 'hit_ratio': 1.0, 'precision': 0.18333358, 'ndcg': 0.9057597, 'mrr': 0.968066, 'map': 0.864576}
Epoch 90 [6.3s]: train==[1.47957=0.85173 + 0.62739 + 0.00045]
Epoch 91 [6.4s]: train==[1.47475=0.84977 + 0.62453 + 0.00045]
Epoch 92 [5.7s]: train==[1.48485=0.85859 + 0.62580 + 0.00045]
Epoch 93 [5.9s]: train==[1.48613=0.85769 + 0.62799 + 0.00045]
Epoch 94 [6.2s]: train==[1.48063=0.85563 + 0.62455 + 0.00045]
valid:{'recall': 0.94521534, 'hit_ratio': 0.9981998, 'precision': 0.12776844, 'ndcg': 0.67590785, 'mrr': 0.6160251, 'map': 0.5608857}
test_id:{'recall': 0.95024335, 'hit_ratio': 1.0, 'precision': 0.18300018, 'ndcg': 0.9036065, 'mrr': 0.96416706, 'map': 0.86651176}
Epoch 95 [6.1s]: train==[1.48534=0.85645 + 0.62844 + 0.00045]
Epoch 96 [6.3s]: train==[1.49363=0.86412 + 0.62905 + 0.00045]
Epoch 97 [6.0s]: train==[1.47671=0.85201 + 0.62425 + 0.00045]
Epoch 98 [6.0s]: train==[1.47355=0.84744 + 0.62566 + 0.00045]
Epoch 99 [5.4s]: train==[1.47980=0.85262 + 0.62673 + 0.00045]
valid:{'recall': 0.9444615, 'hit_ratio': 0.9981998, 'precision': 0.1275434, 'ndcg': 0.67033, 'mrr': 0.6099666, 'map': 0.55322087}
test_id:{'recall': 0.94855344, 'hit_ratio': 1.0, 'precision': 0.18241687, 'ndcg': 0.9011271, 'mrr': 0.96100575, 'map': 0.86483276}
Epoch 100 [6.9s]: train==[1.49043=0.86273 + 0.62725 + 0.00045]
Epoch 101 [5.1s]: train==[1.48559=0.85566 + 0.62947 + 0.00045]
Epoch 102 [5.3s]: train==[1.48137=0.85507 + 0.62584 + 0.00045]
Epoch 103 [5.7s]: train==[1.49104=0.85982 + 0.63077 + 0.00045]
Epoch 104 [5.5s]: train==[1.47997=0.85068 + 0.62883 + 0.00045]
valid:{'recall': 0.9446598, 'hit_ratio': 0.9981998, 'precision': 0.12740842, 'ndcg': 0.6673279, 'mrr': 0.60493743, 'map': 0.5496118}
test_id:{'recall': 0.95056283, 'hit_ratio': 1.0, 'precision': 0.18254195, 'ndcg': 0.902571, 'mrr': 0.9634491, 'map': 0.8635785}
Epoch 105 [5.9s]: train==[1.47820=0.85541 + 0.62234 + 0.00045]
Epoch 106 [7.1s]: train==[1.48703=0.85881 + 0.62777 + 0.00045]
Epoch 107 [6.4s]: train==[1.47726=0.84906 + 0.62774 + 0.00045]
Epoch 108 [5.8s]: train==[1.47817=0.85377 + 0.62395 + 0.00045]
Epoch 109 [6.3s]: train==[1.47941=0.85352 + 0.62543 + 0.00045]
valid:{'recall': 0.94080216, 'hit_ratio': 0.9990999, 'precision': 0.12659836, 'ndcg': 0.668836, 'mrr': 0.6113278, 'map': 0.55445296}
test_id:{'recall': 0.94132334, 'hit_ratio': 1.0, 'precision': 0.18045853, 'ndcg': 0.89672536, 'mrr': 0.96384764, 'map': 0.8641933}
The best epoch is  9
valid:{'recall': 0.9677286, 'hit_ratio': 1.0, 'precision': 0.13456419, 'ndcg': 0.6753978, 'mrr': 0.6029796, 'map': 0.5431055}
test_id:{'recall': 0.9806222, 'hit_ratio': 1.0, 'precision': 0.19020866, 'ndcg': 0.9436388, 'mrr': 0.9665555, 'map': 0.9205204}
The best epoch is  9
Epoch 9 [6.5s]: train==[2.77572=2.15127 + 0.62400 + 0.00046]
valid:{'recall': 0.9677909, 'hit_ratio': 1.0, 'precision': 0.13415915, 'ndcg': 0.6763959, 'mrr': 0.6043758, 'map': 0.5438586}
test_id:{'recall': 0.982577, 'hit_ratio': 1.0, 'precision': 0.19100036, 'ndcg': 0.95347553, 'mrr': 0.9755833, 'map': 0.9330964}
Epoch 10 [6.3s]: train==[2.58355=1.95563 + 0.62746 + 0.00046]
Epoch 11 [6.1s]: train==[2.40415=1.77565 + 0.62804 + 0.00046]
Epoch 12 [6.4s]: train==[2.26588=1.63662 + 0.62879 + 0.00046]
Epoch 13 [5.8s]: train==[2.15279=1.52365 + 0.62867 + 0.00047]
Epoch 14 [5.8s]: train==[2.04630=1.41855 + 0.62728 + 0.00047]
valid:{'recall': 0.9546796, 'hit_ratio': 0.9981998, 'precision': 0.12884857, 'ndcg': 0.67486507, 'mrr': 0.61482155, 'map': 0.5473529}
test_id:{'recall': 0.9736953, 'hit_ratio': 1.0, 'precision': 0.1877503, 'ndcg': 0.95316976, 'mrr': 0.9932607, 'map': 0.92557067}
Epoch 15 [5.9s]: train==[1.94676=1.32124 + 0.62505 + 0.00047]
Epoch 16 [6.4s]: train==[1.87525=1.24685 + 0.62792 + 0.00047]
Epoch 17 [5.8s]: train==[1.81478=1.18738 + 0.62693 + 0.00048]
Epoch 18 [6.3s]: train==[1.75476=1.12845 + 0.62583 + 0.00048]
Epoch 19 [5.6s]: train==[1.72243=1.09439 + 0.62755 + 0.00048]
valid:{'recall': 0.95522624, 'hit_ratio': 0.99729973, 'precision': 0.13064875, 'ndcg': 0.6978162, 'mrr': 0.6429085, 'map': 0.57870036}
test_id:{'recall': 0.9694361, 'hit_ratio': 0.99916667, 'precision': 0.1877086, 'ndcg': 0.9331549, 'mrr': 0.97927743, 'map': 0.89460254}
Epoch 20 [6.4s]: train==[1.68403=1.05677 + 0.62678 + 0.00048]
Epoch 21 [5.8s]: train==[1.65686=1.02807 + 0.62832 + 0.00048]
Epoch 22 [6.0s]: train==[1.63995=1.00964 + 0.62983 + 0.00048]
Epoch 23 [5.2s]: train==[1.60958=0.98432 + 0.62478 + 0.00048]
Epoch 24 [6.0s]: train==[1.59635=0.96826 + 0.62761 + 0.00048]
valid:{'recall': 0.9517808, 'hit_ratio': 0.99729973, 'precision': 0.13042371, 'ndcg': 0.68870485, 'mrr': 0.6354419, 'map': 0.56970125}
test_id:{'recall': 0.9698171, 'hit_ratio': 0.99833333, 'precision': 0.1885836, 'ndcg': 0.9306438, 'mrr': 0.98459816, 'map': 0.88600504}
Epoch 25 [5.3s]: train==[1.57704=0.95194 + 0.62463 + 0.00048]
Epoch 26 [6.2s]: train==[1.56263=0.93647 + 0.62568 + 0.00048]
Epoch 27 [5.8s]: train==[1.54951=0.92453 + 0.62450 + 0.00048]
Epoch 28 [6.1s]: train==[1.54121=0.91733 + 0.62340 + 0.00048]
Epoch 29 [5.9s]: train==[1.54432=0.91604 + 0.62780 + 0.00048]
valid:{'recall': 0.952729, 'hit_ratio': 0.99729973, 'precision': 0.13087374, 'ndcg': 0.6817654, 'mrr': 0.6235823, 'map': 0.56245965}
test_id:{'recall': 0.9675874, 'hit_ratio': 0.99916667, 'precision': 0.18883353, 'ndcg': 0.9181082, 'mrr': 0.97329164, 'map': 0.8691786}
Epoch 30 [5.7s]: train==[1.53226=0.90655 + 0.62523 + 0.00048]
Epoch 31 [5.9s]: train==[1.52242=0.89762 + 0.62432 + 0.00048]
Epoch 32 [5.6s]: train==[1.52137=0.89669 + 0.62421 + 0.00048]
Epoch 33 [6.9s]: train==[1.51560=0.88818 + 0.62695 + 0.00048]
Epoch 34 [6.6s]: train==[1.51416=0.88621 + 0.62747 + 0.00048]
valid:{'recall': 0.95047724, 'hit_ratio': 0.99729973, 'precision': 0.12983865, 'ndcg': 0.6768585, 'mrr': 0.61357856, 'map': 0.5582655}
test_id:{'recall': 0.9652749, 'hit_ratio': 0.99916667, 'precision': 0.18825017, 'ndcg': 0.91440105, 'mrr': 0.9620991, 'map': 0.86966795}
Epoch 35 [6.2s]: train==[1.50509=0.88046 + 0.62416 + 0.00048]
Epoch 36 [6.4s]: train==[1.50481=0.87762 + 0.62671 + 0.00048]
Epoch 37 [5.9s]: train==[1.50353=0.88013 + 0.62293 + 0.00047]
Epoch 38 [5.8s]: train==[1.49726=0.87202 + 0.62477 + 0.00047]
Epoch 39 [6.0s]: train==[1.50400=0.87684 + 0.62669 + 0.00047]
valid:{'recall': 0.9515532, 'hit_ratio': 0.99729973, 'precision': 0.13019864, 'ndcg': 0.6709454, 'mrr': 0.60247916, 'map': 0.55004334}
test_id:{'recall': 0.96522605, 'hit_ratio': 0.99916667, 'precision': 0.18829188, 'ndcg': 0.91587985, 'mrr': 0.9712084, 'map': 0.8686266}
Epoch 40 [5.5s]: train==[1.49644=0.87038 + 0.62558 + 0.00047]
Epoch 41 [5.9s]: train==[1.49711=0.87015 + 0.62648 + 0.00047]
Epoch 42 [6.3s]: train==[1.49838=0.86807 + 0.62983 + 0.00047]
Epoch 43 [5.9s]: train==[1.50228=0.87410 + 0.62771 + 0.00047]
Epoch 44 [6.3s]: train==[1.49342=0.86380 + 0.62914 + 0.00047]
valid:{'recall': 0.9484483, 'hit_ratio': 0.99729973, 'precision': 0.12898353, 'ndcg': 0.67061776, 'mrr': 0.6023529, 'map': 0.5520405}
test_id:{'recall': 0.95959145, 'hit_ratio': 0.99916667, 'precision': 0.18612519, 'ndcg': 0.9105625, 'mrr': 0.9705718, 'map': 0.8644267}
Epoch 45 [6.1s]: train==[1.49389=0.86364 + 0.62978 + 0.00047]
Epoch 46 [5.5s]: train==[1.49077=0.86216 + 0.62814 + 0.00047]
Epoch 47 [5.7s]: train==[1.49294=0.86302 + 0.62945 + 0.00047]
Epoch 48 [5.6s]: train==[1.49010=0.86050 + 0.62912 + 0.00047]
Epoch 49 [5.9s]: train==[1.49134=0.86629 + 0.62458 + 0.00047]
valid:{'recall': 0.9463106, 'hit_ratio': 0.99729973, 'precision': 0.12866852, 'ndcg': 0.6726628, 'mrr': 0.6052182, 'map': 0.5554441}
test_id:{'recall': 0.95838875, 'hit_ratio': 0.99916667, 'precision': 0.18537523, 'ndcg': 0.9096229, 'mrr': 0.9660001, 'map': 0.8661626}
Epoch 50 [6.5s]: train==[1.49486=0.86876 + 0.62563 + 0.00047]
Epoch 51 [5.6s]: train==[1.49023=0.86232 + 0.62744 + 0.00047]
Epoch 52 [5.5s]: train==[1.48851=0.86243 + 0.62560 + 0.00047]
Epoch 53 [6.5s]: train==[1.49394=0.86685 + 0.62662 + 0.00047]
Epoch 54 [5.9s]: train==[1.49903=0.86928 + 0.62928 + 0.00047]
valid:{'recall': 0.9472044, 'hit_ratio': 0.99729973, 'precision': 0.12866852, 'ndcg': 0.67843217, 'mrr': 0.61518544, 'map': 0.56259406}
test_id:{'recall': 0.9590896, 'hit_ratio': 0.99916667, 'precision': 0.18575022, 'ndcg': 0.9088466, 'mrr': 0.9637083, 'map': 0.8636144}
Epoch 55 [5.7s]: train==[1.47763=0.85388 + 0.62328 + 0.00047]
Epoch 56 [6.1s]: train==[1.47996=0.85242 + 0.62707 + 0.00047]
Epoch 57 [5.9s]: train==[1.48471=0.85895 + 0.62529 + 0.00047]
Epoch 58 [6.2s]: train==[1.48878=0.86067 + 0.62763 + 0.00047]
Epoch 59 [5.3s]: train==[1.48661=0.86116 + 0.62497 + 0.00047]
valid:{'recall': 0.94423133, 'hit_ratio': 0.99729973, 'precision': 0.12808344, 'ndcg': 0.6730318, 'mrr': 0.6057364, 'map': 0.55709076}
test_id:{'recall': 0.9538541, 'hit_ratio': 0.99916667, 'precision': 0.18412517, 'ndcg': 0.90172005, 'mrr': 0.96262604, 'map': 0.85703856}
Epoch 60 [5.8s]: train==[1.49652=0.86859 + 0.62745 + 0.00047]
Epoch 61 [6.1s]: train==[1.48196=0.85678 + 0.62471 + 0.00047]
Epoch 62 [5.1s]: train==[1.48788=0.86111 + 0.62630 + 0.00047]
Epoch 63 [5.7s]: train==[1.48219=0.85670 + 0.62502 + 0.00047]
Epoch 64 [6.2s]: train==[1.48574=0.86147 + 0.62379 + 0.00047]
valid:{'recall': 0.9449508, 'hit_ratio': 0.99729973, 'precision': 0.12844352, 'ndcg': 0.67674536, 'mrr': 0.61678946, 'map': 0.56240493}
test_id:{'recall': 0.95482516, 'hit_ratio': 0.99916667, 'precision': 0.18466693, 'ndcg': 0.9054784, 'mrr': 0.9617315, 'map': 0.8639355}
Epoch 65 [6.4s]: train==[1.48031=0.85483 + 0.62500 + 0.00047]
Epoch 66 [6.3s]: train==[1.48734=0.86066 + 0.62621 + 0.00047]
Epoch 67 [6.3s]: train==[1.48812=0.86054 + 0.62710 + 0.00047]
Epoch 68 [5.9s]: train==[1.48312=0.85690 + 0.62575 + 0.00047]
Epoch 69 [5.7s]: train==[1.47927=0.85471 + 0.62408 + 0.00047]
valid:{'recall': 0.9424898, 'hit_ratio': 0.99729973, 'precision': 0.12731838, 'ndcg': 0.6737881, 'mrr': 0.6071673, 'map': 0.5610492}
test_id:{'recall': 0.9537064, 'hit_ratio': 0.99916667, 'precision': 0.18412529, 'ndcg': 0.9079332, 'mrr': 0.96571296, 'map': 0.86888844}
Epoch 70 [5.1s]: train==[1.48019=0.85301 + 0.62671 + 0.00047]
Epoch 71 [4.9s]: train==[1.49332=0.86464 + 0.62821 + 0.00047]
Epoch 72 [5.8s]: train==[1.48333=0.85473 + 0.62813 + 0.00047]
Epoch 73 [5.6s]: train==[1.49291=0.86195 + 0.63048 + 0.00047]
Epoch 74 [5.5s]: train==[1.48235=0.85499 + 0.62688 + 0.00047]
valid:{'recall': 0.943778, 'hit_ratio': 0.99729973, 'precision': 0.12767841, 'ndcg': 0.6666954, 'mrr': 0.59876, 'map': 0.55017745}
test_id:{'recall': 0.95119, 'hit_ratio': 0.99916667, 'precision': 0.18329191, 'ndcg': 0.8993801, 'mrr': 0.9605265, 'map': 0.8565683}
Epoch 75 [5.1s]: train==[1.48250=0.85315 + 0.62888 + 0.00047]
Epoch 76 [5.1s]: train==[1.48111=0.85446 + 0.62618 + 0.00048]
Epoch 77 [6.2s]: train==[1.48524=0.85942 + 0.62535 + 0.00048]
Epoch 78 [6.2s]: train==[1.48381=0.85600 + 0.62733 + 0.00048]
Epoch 79 [6.2s]: train==[1.48579=0.85641 + 0.62890 + 0.00048]
valid:{'recall': 0.9426318, 'hit_ratio': 0.99729973, 'precision': 0.1273184, 'ndcg': 0.67134196, 'mrr': 0.61193246, 'map': 0.55567735}
test_id:{'recall': 0.9480738, 'hit_ratio': 0.99916667, 'precision': 0.18241687, 'ndcg': 0.9011766, 'mrr': 0.96109885, 'map': 0.8645372}
Epoch 80 [5.9s]: train==[1.49077=0.86359 + 0.62670 + 0.00048]
Epoch 81 [5.5s]: train==[1.48194=0.85443 + 0.62704 + 0.00048]
Epoch 82 [5.4s]: train==[1.48309=0.85705 + 0.62557 + 0.00048]
Epoch 83 [5.2s]: train==[1.48253=0.85270 + 0.62935 + 0.00048]
Epoch 84 [5.6s]: train==[1.48300=0.85705 + 0.62547 + 0.00048]
valid:{'recall': 0.9443365, 'hit_ratio': 0.99729973, 'precision': 0.12803847, 'ndcg': 0.6627442, 'mrr': 0.5959827, 'map': 0.54380286}
test_id:{'recall': 0.95081747, 'hit_ratio': 0.99916667, 'precision': 0.18283358, 'ndcg': 0.90084565, 'mrr': 0.9633749, 'map': 0.8592092}
Epoch 85 [5.6s]: train==[1.48914=0.86067 + 0.62799 + 0.00048]
Epoch 86 [6.2s]: train==[1.48298=0.85563 + 0.62688 + 0.00048]
Epoch 87 [5.4s]: train==[1.48743=0.85579 + 0.63116 + 0.00048]
Epoch 88 [5.9s]: train==[1.48915=0.85917 + 0.62950 + 0.00048]
Epoch 89 [5.5s]: train==[1.48291=0.85459 + 0.62784 + 0.00048]
valid:{'recall': 0.94062823, 'hit_ratio': 0.99729973, 'precision': 0.12695834, 'ndcg': 0.6751936, 'mrr': 0.61765635, 'map': 0.5627084}
test_id:{'recall': 0.94498545, 'hit_ratio': 0.99916667, 'precision': 0.18104185, 'ndcg': 0.8972647, 'mrr': 0.9553893, 'map': 0.8606943}
Epoch 90 [6.5s]: train==[1.48686=0.86005 + 0.62634 + 0.00048]
Epoch 91 [5.2s]: train==[1.48243=0.85549 + 0.62646 + 0.00048]
Epoch 92 [5.9s]: train==[1.48240=0.85489 + 0.62704 + 0.00048]
Epoch 93 [5.4s]: train==[1.48111=0.85095 + 0.62968 + 0.00048]
Epoch 94 [6.1s]: train==[1.47970=0.85100 + 0.62822 + 0.00048]
valid:{'recall': 0.9434355, 'hit_ratio': 0.99729973, 'precision': 0.12772337, 'ndcg': 0.67089826, 'mrr': 0.6077745, 'map': 0.55564827}
test_id:{'recall': 0.9468368, 'hit_ratio': 0.99916667, 'precision': 0.18191686, 'ndcg': 0.9017112, 'mrr': 0.96362495, 'map': 0.86572874}
Epoch 95 [5.8s]: train==[1.47859=0.85170 + 0.62641 + 0.00048]
Epoch 96 [6.4s]: train==[1.47482=0.84995 + 0.62440 + 0.00048]
Epoch 97 [6.4s]: train==[1.47713=0.85061 + 0.62604 + 0.00048]
Epoch 98 [5.8s]: train==[1.48495=0.85703 + 0.62745 + 0.00048]
Epoch 99 [6.0s]: train==[1.48335=0.85551 + 0.62737 + 0.00048]
valid:{'recall': 0.940321, 'hit_ratio': 0.99729973, 'precision': 0.12655333, 'ndcg': 0.66468334, 'mrr': 0.60665715, 'map': 0.5489319}
test_id:{'recall': 0.94459665, 'hit_ratio': 1.0, 'precision': 0.18091686, 'ndcg': 0.89599824, 'mrr': 0.9612886, 'map': 0.85778546}
Epoch 100 [6.0s]: train==[1.47476=0.84880 + 0.62548 + 0.00048]
Epoch 101 [6.6s]: train==[1.48234=0.85632 + 0.62554 + 0.00048]
Epoch 102 [6.0s]: train==[1.49038=0.86290 + 0.62700 + 0.00048]
Epoch 103 [5.7s]: train==[1.47447=0.84915 + 0.62485 + 0.00048]
Epoch 104 [6.0s]: train==[1.48165=0.85235 + 0.62882 + 0.00048]
valid:{'recall': 0.9400548, 'hit_ratio': 0.99729973, 'precision': 0.12722836, 'ndcg': 0.6667404, 'mrr': 0.6049472, 'map': 0.5521586}
test_id:{'recall': 0.94580483, 'hit_ratio': 1.0, 'precision': 0.18083349, 'ndcg': 0.89781445, 'mrr': 0.96627027, 'map': 0.85835123}
Epoch 105 [5.6s]: train==[1.47646=0.85140 + 0.62458 + 0.00048]
Epoch 106 [5.8s]: train==[1.48559=0.85697 + 0.62814 + 0.00048]
Epoch 107 [4.9s]: train==[1.48163=0.85183 + 0.62933 + 0.00048]
Epoch 108 [5.3s]: train==[1.48762=0.85804 + 0.62910 + 0.00048]
Epoch 109 [5.0s]: train==[1.48051=0.85248 + 0.62755 + 0.00048]
valid:{'recall': 0.9413596, 'hit_ratio': 0.9981998, 'precision': 0.12704833, 'ndcg': 0.66771406, 'mrr': 0.61348206, 'map': 0.5502358}
test_id:{'recall': 0.944669, 'hit_ratio': 1.0, 'precision': 0.18054186, 'ndcg': 0.8969269, 'mrr': 0.96093, 'map': 0.859302}
The best epoch is  9
valid:{'recall': 0.9677909, 'hit_ratio': 1.0, 'precision': 0.13415915, 'ndcg': 0.6763959, 'mrr': 0.6043758, 'map': 0.5438586}
test_id:{'recall': 0.982577, 'hit_ratio': 1.0, 'precision': 0.19100036, 'ndcg': 0.95347553, 'mrr': 0.9755833, 'map': 0.9330964}
The best epoch is  9
Epoch 9 [5.5s]: train==[2.57727=1.94962 + 0.62719 + 0.00046]
valid:{'recall': 0.9645283, 'hit_ratio': 1.0, 'precision': 0.13240398, 'ndcg': 0.67818254, 'mrr': 0.61143124, 'map': 0.54740286}
test_id:{'recall': 0.98147124, 'hit_ratio': 1.0, 'precision': 0.19037534, 'ndcg': 0.9625247, 'mrr': 0.98703635, 'map': 0.945467}
Epoch 10 [5.9s]: train==[2.40500=1.77912 + 0.62542 + 0.00046]
Epoch 11 [6.0s]: train==[2.26404=1.63815 + 0.62542 + 0.00047]
Epoch 12 [6.3s]: train==[2.13305=1.50512 + 0.62746 + 0.00047]
Epoch 13 [6.4s]: train==[2.03058=1.40545 + 0.62466 + 0.00047]
Epoch 14 [5.6s]: train==[1.93762=1.31141 + 0.62574 + 0.00047]
valid:{'recall': 0.9547799, 'hit_ratio': 0.9990999, 'precision': 0.12929864, 'ndcg': 0.67339796, 'mrr': 0.60351783, 'map': 0.54665196}
test_id:{'recall': 0.97242266, 'hit_ratio': 1.0, 'precision': 0.18720861, 'ndcg': 0.9513603, 'mrr': 0.99130493, 'map': 0.92382365}
Epoch 15 [6.9s]: train==[1.86490=1.23674 + 0.62768 + 0.00048]
Epoch 16 [5.5s]: train==[1.80803=1.17770 + 0.62985 + 0.00048]
Epoch 17 [6.2s]: train==[1.75430=1.12370 + 0.63012 + 0.00048]
Epoch 18 [5.8s]: train==[1.71932=1.09066 + 0.62818 + 0.00048]
Epoch 19 [5.8s]: train==[1.68168=1.05374 + 0.62746 + 0.00048]
valid:{'recall': 0.95620775, 'hit_ratio': 0.9981998, 'precision': 0.13114382, 'ndcg': 0.6991577, 'mrr': 0.6399542, 'map': 0.581939}
test_id:{'recall': 0.97009856, 'hit_ratio': 0.99833333, 'precision': 0.18766691, 'ndcg': 0.93296313, 'mrr': 0.9813985, 'map': 0.89253783}
Epoch 20 [5.5s]: train==[1.65176=1.02776 + 0.62352 + 0.00048]
Epoch 21 [5.6s]: train==[1.63027=1.00155 + 0.62824 + 0.00048]
Epoch 22 [5.5s]: train==[1.60920=0.98353 + 0.62519 + 0.00048]
Epoch 23 [6.1s]: train==[1.59413=0.96636 + 0.62728 + 0.00048]
Epoch 24 [5.2s]: train==[1.57316=0.94668 + 0.62599 + 0.00048]
valid:{'recall': 0.95438534, 'hit_ratio': 0.9981998, 'precision': 0.13096379, 'ndcg': 0.6895867, 'mrr': 0.63009405, 'map': 0.56964934}
test_id:{'recall': 0.9684252, 'hit_ratio': 0.99916667, 'precision': 0.1886252, 'ndcg': 0.9218993, 'mrr': 0.9714864, 'map': 0.8767284}
Epoch 25 [5.9s]: train==[1.57092=0.94178 + 0.62866 + 0.00048]
Epoch 26 [5.7s]: train==[1.55886=0.93029 + 0.62808 + 0.00048]
Epoch 27 [4.9s]: train==[1.54235=0.91580 + 0.62607 + 0.00048]
Epoch 28 [5.9s]: train==[1.54176=0.91417 + 0.62711 + 0.00048]
Epoch 29 [7.1s]: train==[1.54541=0.91461 + 0.63032 + 0.00048]
valid:{'recall': 0.9503531, 'hit_ratio': 0.9981998, 'precision': 0.12979366, 'ndcg': 0.676969, 'mrr': 0.6131908, 'map': 0.5581928}
test_id:{'recall': 0.9636631, 'hit_ratio': 0.99916667, 'precision': 0.18741687, 'ndcg': 0.9132248, 'mrr': 0.9638273, 'map': 0.8682774}
Epoch 30 [5.3s]: train==[1.52211=0.89623 + 0.62540 + 0.00048]
Epoch 31 [5.5s]: train==[1.51830=0.89397 + 0.62386 + 0.00048]
Epoch 32 [5.9s]: train==[1.51383=0.88893 + 0.62442 + 0.00048]
Epoch 33 [5.9s]: train==[1.50982=0.88771 + 0.62164 + 0.00048]
Epoch 34 [6.4s]: train==[1.51437=0.88802 + 0.62587 + 0.00048]
valid:{'recall': 0.9510356, 'hit_ratio': 0.9981998, 'precision': 0.13010864, 'ndcg': 0.6775434, 'mrr': 0.61428076, 'map': 0.55818}
test_id:{'recall': 0.9617684, 'hit_ratio': 0.99916667, 'precision': 0.18683353, 'ndcg': 0.9119008, 'mrr': 0.96563286, 'map': 0.8665856}
Epoch 35 [5.3s]: train==[1.50771=0.88281 + 0.62442 + 0.00048]
Epoch 36 [5.9s]: train==[1.51017=0.88101 + 0.62869 + 0.00048]
Epoch 37 [5.5s]: train==[1.49377=0.86825 + 0.62504 + 0.00048]
Epoch 9 [6.0s]: train==[2.40427=1.77310 + 0.63071 + 0.00046]
valid:{'recall': 0.9590836, 'hit_ratio': 1.0, 'precision': 0.13019873, 'ndcg': 0.6813819, 'mrr': 0.62054706, 'map': 0.55393255}
test_id:{'recall': 0.97901225, 'hit_ratio': 1.0, 'precision': 0.18929198, 'ndcg': 0.96357536, 'mrr': 0.990566, 'map': 0.9467838}
Epoch 10 [6.0s]: train==[2.25442=1.62851 + 0.62544 + 0.00047]
Epoch 11 [5.4s]: train==[2.12411=1.49985 + 0.62379 + 0.00047]
Epoch 12 [6.4s]: train==[2.03001=1.40186 + 0.62768 + 0.00047]
Epoch 13 [6.4s]: train==[1.93582=1.31145 + 0.62389 + 0.00047]
Epoch 14 [6.6s]: train==[1.85833=1.23124 + 0.62661 + 0.00048]
valid:{'recall': 0.95623314, 'hit_ratio': 0.9981998, 'precision': 0.13019866, 'ndcg': 0.6781476, 'mrr': 0.6117729, 'map': 0.5517352}
test_id:{'recall': 0.9705822, 'hit_ratio': 1.0, 'precision': 0.18737528, 'ndcg': 0.94791096, 'mrr': 0.99230367, 'map': 0.91794974}
Epoch 15 [7.1s]: train==[1.80890=1.18274 + 0.62568 + 0.00048]
Epoch 16 [5.6s]: train==[1.74513=1.12303 + 0.62162 + 0.00048]
Epoch 17 [5.8s]: train==[1.71557=1.08961 + 0.62548 + 0.00048]
Epoch 18 [7.1s]: train==[1.66806=1.04111 + 0.62647 + 0.00048]
Epoch 19 [6.7s]: train==[1.65319=1.02425 + 0.62846 + 0.00048]
valid:{'recall': 0.95585704, 'hit_ratio': 0.99729973, 'precision': 0.13123378, 'ndcg': 0.69485635, 'mrr': 0.63877213, 'map': 0.5739888}
test_id:{'recall': 0.9673786, 'hit_ratio': 0.99916667, 'precision': 0.1877502, 'ndcg': 0.9259596, 'mrr': 0.979027, 'map': 0.8823369}
Epoch 20 [6.2s]: train==[1.63480=1.00949 + 0.62483 + 0.00048]
Epoch 21 [6.4s]: train==[1.61921=0.98905 + 0.62968 + 0.00048]
Epoch 22 [6.5s]: train==[1.59865=0.96919 + 0.62898 + 0.00048]
Epoch 23 [5.8s]: train==[1.57518=0.95088 + 0.62382 + 0.00048]
Epoch 24 [6.4s]: train==[1.57614=0.94510 + 0.63055 + 0.00048]
valid:{'recall': 0.95311975, 'hit_ratio': 0.9981998, 'precision': 0.1305137, 'ndcg': 0.68227816, 'mrr': 0.6157683, 'map': 0.5637425}
test_id:{'recall': 0.9700506, 'hit_ratio': 0.99833333, 'precision': 0.18904187, 'ndcg': 0.9189957, 'mrr': 0.96773314, 'map': 0.8695866}
Epoch 25 [6.1s]: train==[1.55639=0.93114 + 0.62477 + 0.00048]
Epoch 26 [5.7s]: train==[1.54810=0.92229 + 0.62533 + 0.00048]
Epoch 27 [6.4s]: train==[1.53733=0.91015 + 0.62670 + 0.00048]
Epoch 28 [6.8s]: train==[1.52399=0.89986 + 0.62364 + 0.00048]
Epoch 29 [7.7s]: train==[1.52935=0.90236 + 0.62650 + 0.00048]
valid:{'recall': 0.9530203, 'hit_ratio': 0.9981998, 'precision': 0.13073877, 'ndcg': 0.68656814, 'mrr': 0.629267, 'map': 0.56889814}
test_id:{'recall': 0.9668494, 'hit_ratio': 0.99916667, 'precision': 0.18858354, 'ndcg': 0.9198644, 'mrr': 0.969623, 'map': 0.87619555}
The best epoch is  9
valid:{'recall': 0.9590836, 'hit_ratio': 1.0, 'precision': 0.13019873, 'ndcg': 0.6813819, 'mrr': 0.62054706, 'map': 0.55393255}
test_id:{'recall': 0.97901225, 'hit_ratio': 1.0, 'precision': 0.18929198, 'ndcg': 0.96357536, 'mrr': 0.990566, 'map': 0.9467838}
The best epoch is  9
Epoch 9 [6.0s]: train==[2.24552=1.61853 + 0.62653 + 0.00047]
valid:{'recall': 0.9564543, 'hit_ratio': 0.9990999, 'precision': 0.12947863, 'ndcg': 0.6813559, 'mrr': 0.6207987, 'map': 0.5557262}
test_id:{'recall': 0.9772673, 'hit_ratio': 1.0, 'precision': 0.1885003, 'ndcg': 0.9611676, 'mrr': 0.9915695, 'map': 0.94102246}
Epoch 10 [6.0s]: train==[2.13762=1.51033 + 0.62682 + 0.00047]
Epoch 11 [6.9s]: train==[2.04236=1.41065 + 0.63124 + 0.00047]
Epoch 12 [5.8s]: train==[1.93640=1.30617 + 0.62975 + 0.00048]
Epoch 13 [6.3s]: train==[1.87862=1.24500 + 0.63315 + 0.00048]
Epoch 14 [6.0s]: train==[1.80471=1.17776 + 0.62647 + 0.00048]
valid:{'recall': 0.9546856, 'hit_ratio': 0.99639964, 'precision': 0.12983868, 'ndcg': 0.6916915, 'mrr': 0.63138264, 'map': 0.5709916}
test_id:{'recall': 0.96551716, 'hit_ratio': 0.99916667, 'precision': 0.18591693, 'ndcg': 0.9396339, 'mrr': 0.98876894, 'map': 0.9088794}
Epoch 15 [5.9s]: train==[1.75584=1.13080 + 0.62455 + 0.00048]
Epoch 16 [5.7s]: train==[1.71669=1.08898 + 0.62723 + 0.00048]
Epoch 17 [6.2s]: train==[1.68113=1.05309 + 0.62756 + 0.00048]
Epoch 18 [5.7s]: train==[1.64913=1.02084 + 0.62781 + 0.00049]
Epoch 19 [5.8s]: train==[1.62422=0.99619 + 0.62754 + 0.00049]
valid:{'recall': 0.9527584, 'hit_ratio': 0.99729973, 'precision': 0.13019872, 'ndcg': 0.6950611, 'mrr': 0.6422689, 'map': 0.5791448}
test_id:{'recall': 0.96829927, 'hit_ratio': 0.99916667, 'precision': 0.18825024, 'ndcg': 0.92692965, 'mrr': 0.9815926, 'map': 0.88238996}
Epoch 20 [6.3s]: train==[1.60030=0.97457 + 0.62524 + 0.00049]
Epoch 21 [6.6s]: train==[1.60483=0.97360 + 0.63074 + 0.00049]
Epoch 22 [6.0s]: train==[1.57660=0.95090 + 0.62521 + 0.00049]
Epoch 23 [6.2s]: train==[1.56321=0.93294 + 0.62978 + 0.00049]
Epoch 24 [6.1s]: train==[1.54648=0.92159 + 0.62441 + 0.00049]
valid:{'recall': 0.95267266, 'hit_ratio': 0.99729973, 'precision': 0.13069375, 'ndcg': 0.6883606, 'mrr': 0.63308835, 'map': 0.57041126}
test_id:{'recall': 0.9679318, 'hit_ratio': 0.99833333, 'precision': 0.18862522, 'ndcg': 0.9201427, 'mrr': 0.9715912, 'map': 0.873422}
Epoch 25 [6.2s]: train==[1.54596=0.91725 + 0.62823 + 0.00049]
Epoch 26 [5.1s]: train==[1.54209=0.91302 + 0.62858 + 0.00049]
Epoch 27 [6.8s]: train==[1.53705=0.90738 + 0.62919 + 0.00049]
Epoch 28 [5.6s]: train==[1.53426=0.90482 + 0.62896 + 0.00048]
Epoch 29 [5.4s]: train==[1.52516=0.89854 + 0.62613 + 0.00048]
valid:{'recall': 0.9498592, 'hit_ratio': 0.99729973, 'precision': 0.12974864, 'ndcg': 0.67417777, 'mrr': 0.6118215, 'map': 0.5547531}
test_id:{'recall': 0.96618754, 'hit_ratio': 0.99916667, 'precision': 0.18825021, 'ndcg': 0.9155766, 'mrr': 0.9658829, 'map': 0.86916554}
The best epoch is  9
valid:{'recall': 0.9564543, 'hit_ratio': 0.9990999, 'precision': 0.12947863, 'ndcg': 0.6813559, 'mrr': 0.6207987, 'map': 0.5557262}
test_id:{'recall': 0.9772673, 'hit_ratio': 1.0, 'precision': 0.1885003, 'ndcg': 0.9611676, 'mrr': 0.9915695, 'map': 0.94102246}
The best epoch is  9
Epoch 9 [5.8s]: train==[2.14001=1.51209 + 0.62745 + 0.00047]
valid:{'recall': 0.9526475, 'hit_ratio': 0.9981998, 'precision': 0.1279485, 'ndcg': 0.6749626, 'mrr': 0.6163146, 'map': 0.5485448}
test_id:{'recall': 0.97541076, 'hit_ratio': 1.0, 'precision': 0.18775031, 'ndcg': 0.95667875, 'mrr': 0.991843, 'map': 0.93219036}
Epoch 10 [6.3s]: train==[2.02119=1.39595 + 0.62476 + 0.00047]
Epoch 11 [4.7s]: train==[1.94462=1.31627 + 0.62787 + 0.00048]
Epoch 12 [5.7s]: train==[1.85867=1.22870 + 0.62949 + 0.00048]
Epoch 13 [4.4s]: train==[1.79053=1.16514 + 0.62491 + 0.00048]
Epoch 14 [4.6s]: train==[1.74564=1.11753 + 0.62763 + 0.00048]
valid:{'recall': 0.95440966, 'hit_ratio': 0.99639964, 'precision': 0.13010864, 'ndcg': 0.6856689, 'mrr': 0.6215884, 'map': 0.56377673}
test_id:{'recall': 0.9662964, 'hit_ratio': 0.99916667, 'precision': 0.18641691, 'ndcg': 0.9349883, 'mrr': 0.9861063, 'map': 0.8995043}
Epoch 15 [5.6s]: train==[1.70960=1.08135 + 0.62777 + 0.00049]
Epoch 16 [4.8s]: train==[1.66714=1.04197 + 0.62468 + 0.00049]
Epoch 17 [4.9s]: train==[1.64538=1.01809 + 0.62679 + 0.00049]
Epoch 18 [4.6s]: train==[1.63136=1.00186 + 0.62900 + 0.00049]
Epoch 19 [5.1s]: train==[1.60980=0.98073 + 0.62859 + 0.00049]
valid:{'recall': 0.9538178, 'hit_ratio': 0.99729973, 'precision': 0.1305137, 'ndcg': 0.6909031, 'mrr': 0.637307, 'map': 0.5714924}
test_id:{'recall': 0.96587586, 'hit_ratio': 0.99833333, 'precision': 0.18758358, 'ndcg': 0.9224053, 'mrr': 0.9771815, 'map': 0.87837994}
Epoch 20 [5.8s]: train==[1.59248=0.96129 + 0.63070 + 0.00049]
Epoch 21 [4.6s]: train==[1.57884=0.95109 + 0.62726 + 0.00049]
Epoch 22 [4.4s]: train==[1.56457=0.93659 + 0.62749 + 0.00049]
Epoch 23 [5.4s]: train==[1.55377=0.92533 + 0.62795 + 0.00049]
Epoch 24 [6.0s]: train==[1.54613=0.91889 + 0.62675 + 0.00049]
valid:{'recall': 0.9562052, 'hit_ratio': 0.99729973, 'precision': 0.13190885, 'ndcg': 0.68857795, 'mrr': 0.6260756, 'map': 0.56869364}
test_id:{'recall': 0.96747303, 'hit_ratio': 0.99916667, 'precision': 0.18854195, 'ndcg': 0.916479, 'mrr': 0.9655078, 'map': 0.8689859}
Epoch 25 [4.8s]: train==[1.53894=0.91091 + 0.62754 + 0.00049]
Epoch 26 [6.0s]: train==[1.53080=0.90158 + 0.62873 + 0.00049]
Epoch 27 [4.4s]: train==[1.53005=0.90345 + 0.62611 + 0.00049]
Epoch 28 [4.9s]: train==[1.51899=0.89451 + 0.62399 + 0.00049]
Epoch 29 [4.5s]: train==[1.52463=0.89714 + 0.62700 + 0.00049]
valid:{'recall': 0.95185244, 'hit_ratio': 0.99729973, 'precision': 0.13033369, 'ndcg': 0.68393826, 'mrr': 0.62371486, 'map': 0.56565684}
test_id:{'recall': 0.96313596, 'hit_ratio': 0.99916667, 'precision': 0.18737522, 'ndcg': 0.9107456, 'mrr': 0.962681, 'map': 0.8643013}
The best epoch is  24
valid:{'recall': 0.9562052, 'hit_ratio': 0.99729973, 'precision': 0.13190885, 'ndcg': 0.68857795, 'mrr': 0.6260756, 'map': 0.56869364}
test_id:{'recall': 0.96747303, 'hit_ratio': 0.99916667, 'precision': 0.18854195, 'ndcg': 0.916479, 'mrr': 0.9655078, 'map': 0.8689859}
The best epoch is  24
Epoch 9 [6.3s]: train==[2.03486=1.40733 + 0.62705 + 0.00047]
valid:{'recall': 0.9526796, 'hit_ratio': 0.9981998, 'precision': 0.12826349, 'ndcg': 0.6681483, 'mrr': 0.6065427, 'map': 0.53975624}
test_id:{'recall': 0.9712152, 'hit_ratio': 1.0, 'precision': 0.18629195, 'ndcg': 0.9524598, 'mrr': 0.99305654, 'map': 0.92754954}
The best epoch is  9
valid:{'recall': 0.9526796, 'hit_ratio': 0.9981998, 'precision': 0.12826349, 'ndcg': 0.6681483, 'mrr': 0.6065427, 'map': 0.53975624}
test_id:{'recall': 0.9712152, 'hit_ratio': 1.0, 'precision': 0.18629195, 'ndcg': 0.9524598, 'mrr': 0.99305654, 'map': 0.92754954}
The best epoch is  9
Epoch 9 [6.4s]: train==[1.93911=1.31255 + 0.62608 + 0.00048]
valid:{'recall': 0.95368207, 'hit_ratio': 0.9981998, 'precision': 0.12871353, 'ndcg': 0.6716098, 'mrr': 0.6026128, 'map': 0.5448591}
test_id:{'recall': 0.9711164, 'hit_ratio': 0.99833333, 'precision': 0.18641697, 'ndcg': 0.9484849, 'mrr': 0.9900317, 'map': 0.9197928}
The best epoch is  9
valid:{'recall': 0.95368207, 'hit_ratio': 0.9981998, 'precision': 0.12871353, 'ndcg': 0.6716098, 'mrr': 0.6026128, 'map': 0.5448591}
test_id:{'recall': 0.9711164, 'hit_ratio': 0.99833333, 'precision': 0.18641697, 'ndcg': 0.9484849, 'mrr': 0.9900317, 'map': 0.9197928}
The best epoch is  9
Epoch 9 [5.8s]: train==[1.86024=1.23191 + 0.62785 + 0.00048]
valid:{'recall': 0.9524753, 'hit_ratio': 0.99729973, 'precision': 0.12880354, 'ndcg': 0.683145, 'mrr': 0.62112653, 'map': 0.5612005}
test_id:{'recall': 0.9680174, 'hit_ratio': 0.99833333, 'precision': 0.18608366, 'ndcg': 0.94115937, 'mrr': 0.98722196, 'map': 0.90894866}
The best epoch is  9
valid:{'recall': 0.9524753, 'hit_ratio': 0.99729973, 'precision': 0.12880354, 'ndcg': 0.683145, 'mrr': 0.62112653, 'map': 0.5612005}
test_id:{'recall': 0.9680174, 'hit_ratio': 0.99833333, 'precision': 0.18608366, 'ndcg': 0.94115937, 'mrr': 0.98722196, 'map': 0.90894866}
The best epoch is  9
Epoch 9 [6.4s]: train==[1.79809=1.16999 + 0.62761 + 0.00048]
valid:{'recall': 0.9529752, 'hit_ratio': 0.99639964, 'precision': 0.12947859, 'ndcg': 0.69020903, 'mrr': 0.6319898, 'map': 0.5701991}
test_id:{'recall': 0.9670239, 'hit_ratio': 0.9975, 'precision': 0.18629195, 'ndcg': 0.93886656, 'mrr': 0.9872285, 'map': 0.9055199}
The best epoch is  9
valid:{'recall': 0.9529752, 'hit_ratio': 0.99639964, 'precision': 0.12947859, 'ndcg': 0.69020903, 'mrr': 0.6319898, 'map': 0.5701991}
test_id:{'recall': 0.9670239, 'hit_ratio': 0.9975, 'precision': 0.18629195, 'ndcg': 0.93886656, 'mrr': 0.9872285, 'map': 0.9055199}
The best epoch is  9
Epoch 9 [5.9s]: train==[1.73761=1.11148 + 0.62565 + 0.00049]
valid:{'recall': 0.9533655, 'hit_ratio': 0.99729973, 'precision': 0.13010864, 'ndcg': 0.6888517, 'mrr': 0.62797606, 'map': 0.5690763}
test_id:{'recall': 0.9665195, 'hit_ratio': 0.9975, 'precision': 0.18658364, 'ndcg': 0.93105024, 'mrr': 0.9812602, 'map': 0.8926026}
The best epoch is  9
valid:{'recall': 0.9533655, 'hit_ratio': 0.99729973, 'precision': 0.13010864, 'ndcg': 0.6888517, 'mrr': 0.62797606, 'map': 0.5690763}
test_id:{'recall': 0.9665195, 'hit_ratio': 0.9975, 'precision': 0.18658364, 'ndcg': 0.93105024, 'mrr': 0.9812602, 'map': 0.8926026}
The best epoch is  9
Epoch 9 [6.5s]: train==[1.70847=1.08235 + 0.62563 + 0.00049]
valid:{'recall': 0.95424086, 'hit_ratio': 0.99639964, 'precision': 0.1304687, 'ndcg': 0.69785947, 'mrr': 0.6435432, 'map': 0.58045006}
test_id:{'recall': 0.9697805, 'hit_ratio': 0.9975, 'precision': 0.1881253, 'ndcg': 0.9338445, 'mrr': 0.9835405, 'map': 0.89326435}
The best epoch is  9
valid:{'recall': 0.95424086, 'hit_ratio': 0.99639964, 'precision': 0.1304687, 'ndcg': 0.69785947, 'mrr': 0.6435432, 'map': 0.58045006}
test_id:{'recall': 0.9697805, 'hit_ratio': 0.9975, 'precision': 0.1881253, 'ndcg': 0.9338445, 'mrr': 0.9835405, 'map': 0.89326435}
The best epoch is  9
Epoch 9 [5.6s]: train==[1.68021=1.05081 + 0.62891 + 0.00049]
valid:{'recall': 0.95165896, 'hit_ratio': 0.99639964, 'precision': 0.1301987, 'ndcg': 0.6958905, 'mrr': 0.6472679, 'map': 0.57939446}
test_id:{'recall': 0.96621275, 'hit_ratio': 0.9975, 'precision': 0.18708359, 'ndcg': 0.928697, 'mrr': 0.9808859, 'map': 0.88856333}
The best epoch is  9
valid:{'recall': 0.95165896, 'hit_ratio': 0.99639964, 'precision': 0.1301987, 'ndcg': 0.6958905, 'mrr': 0.6472679, 'map': 0.57939446}
test_id:{'recall': 0.96621275, 'hit_ratio': 0.9975, 'precision': 0.18708359, 'ndcg': 0.928697, 'mrr': 0.9808859, 'map': 0.88856333}
The best epoch is  9
Epoch 9 [6.1s]: train==[1.64451=1.01952 + 0.62450 + 0.00050]
valid:{'recall': 0.95082, 'hit_ratio': 0.99639964, 'precision': 0.13001862, 'ndcg': 0.6799001, 'mrr': 0.62340873, 'map': 0.55908537}
test_id:{'recall': 0.96379036, 'hit_ratio': 0.9975, 'precision': 0.18650025, 'ndcg': 0.9222481, 'mrr': 0.973597, 'map': 0.88197}
The best epoch is  9
valid:{'recall': 0.95082, 'hit_ratio': 0.99639964, 'precision': 0.13001862, 'ndcg': 0.6799001, 'mrr': 0.62340873, 'map': 0.55908537}
test_id:{'recall': 0.96379036, 'hit_ratio': 0.9975, 'precision': 0.18650025, 'ndcg': 0.9222481, 'mrr': 0.973597, 'map': 0.88197}
The best epoch is  9
Epoch 9 [6.3s]: train==[1.61794=0.98946 + 0.62798 + 0.00050]
valid:{'recall': 0.9506518, 'hit_ratio': 0.99729973, 'precision': 0.12983865, 'ndcg': 0.6895343, 'mrr': 0.6373708, 'map': 0.57197475}
test_id:{'recall': 0.9646123, 'hit_ratio': 0.99833333, 'precision': 0.18712524, 'ndcg': 0.92016083, 'mrr': 0.97308147, 'map': 0.87696433}
The best epoch is  9
valid:{'recall': 0.9506518, 'hit_ratio': 0.99729973, 'precision': 0.12983865, 'ndcg': 0.6895343, 'mrr': 0.6373708, 'map': 0.57197475}
test_id:{'recall': 0.9646123, 'hit_ratio': 0.99833333, 'precision': 0.18712524, 'ndcg': 0.92016083, 'mrr': 0.97308147, 'map': 0.87696433}
The best epoch is  9
Epoch 9 [7.5s]: train==[1.59872=0.97223 + 0.62599 + 0.00050]
valid:{'recall': 0.9501441, 'hit_ratio': 0.99729973, 'precision': 0.13010867, 'ndcg': 0.68933755, 'mrr': 0.6373274, 'map': 0.5740161}
test_id:{'recall': 0.9635786, 'hit_ratio': 0.99833333, 'precision': 0.18691689, 'ndcg': 0.91830355, 'mrr': 0.97344667, 'map': 0.87383634}
The best epoch is  9
valid:{'recall': 0.9501441, 'hit_ratio': 0.99729973, 'precision': 0.13010867, 'ndcg': 0.68933755, 'mrr': 0.6373274, 'map': 0.5740161}
test_id:{'recall': 0.9635786, 'hit_ratio': 0.99833333, 'precision': 0.18691689, 'ndcg': 0.91830355, 'mrr': 0.97344667, 'map': 0.87383634}
The best epoch is  9
