Epoch 0 [2.1s]: train==[0.69241=0.69241 + 0.00000]
Epoch 1 [1.5s]: train==[0.69164=0.69164 + 0.00000]
Epoch 2 [2.0s]: train==[0.69015=0.69014 + 0.00000]
Epoch 3 [2.1s]: train==[0.68747=0.68747 + 0.00000]
Epoch 4 [1.9s]: train==[0.68325=0.68325 + 0.00000]
valid:{'recall': 0.85921794, 'hit_ratio': 0.9927993, 'precision': 0.20432156, 'ndcg': 0.6175467, 'mrr': 0.59213954, 'map': 0.5438142}
test_id:{'recall': 0.91879904, 'hit_ratio': 1.0, 'precision': 0.32933402, 'ndcg': 0.874204, 'mrr': 0.93193847, 'map': 0.8662273}
Epoch 5 [2.1s]: train==[0.67688=0.67688 + 0.00000]
Epoch 6 [1.9s]: train==[0.66818=0.66818 + 0.00000]
Epoch 7 [1.9s]: train==[0.65717=0.65717 + 0.00000]
Epoch 8 [2.2s]: train==[0.64366=0.64365 + 0.00001]
Epoch 9 [2.3s]: train==[0.62785=0.62785 + 0.00001]
valid:{'recall': 0.9064041, 'hit_ratio': 0.9981998, 'precision': 0.21953298, 'ndcg': 0.64743555, 'mrr': 0.6023741, 'map': 0.54848903}
test_id:{'recall': 0.9732829, 'hit_ratio': 1.0, 'precision': 0.36825064, 'ndcg': 0.9488203, 'mrr': 0.95985645, 'map': 0.92879415}
Epoch 10 [2.0s]: train==[0.61046=0.61045 + 0.00001]
Epoch 11 [2.1s]: train==[0.59122=0.59121 + 0.00001]
Epoch 12 [2.2s]: train==[0.57040=0.57040 + 0.00001]
Epoch 13 [2.2s]: train==[0.54876=0.54876 + 0.00001]
Epoch 14 [2.1s]: train==[0.52711=0.52711 + 0.00001]
valid:{'recall': 0.9124458, 'hit_ratio': 0.9990999, 'precision': 0.22259323, 'ndcg': 0.6401124, 'mrr': 0.58598346, 'map': 0.5351565}
test_id:{'recall': 0.97941446, 'hit_ratio': 0.99833333, 'precision': 0.37366733, 'ndcg': 0.9557734, 'mrr': 0.9613819, 'map': 0.93402547}
Epoch 15 [2.2s]: train==[0.50432=0.50431 + 0.00001]
Epoch 16 [2.2s]: train==[0.48177=0.48176 + 0.00001]
Epoch 17 [2.5s]: train==[0.45983=0.45982 + 0.00001]
Epoch 18 [2.0s]: train==[0.43782=0.43781 + 0.00001]
Epoch 19 [2.1s]: train==[0.41695=0.41694 + 0.00001]
valid:{'recall': 0.91336083, 'hit_ratio': 0.9990999, 'precision': 0.22313325, 'ndcg': 0.63099104, 'mrr': 0.5687579, 'map': 0.52319413}
test_id:{'recall': 0.98048717, 'hit_ratio': 0.99833333, 'precision': 0.37491727, 'ndcg': 0.95735496, 'mrr': 0.96137035, 'map': 0.93607116}
Epoch 20 [1.8s]: train==[0.39696=0.39695 + 0.00001]
Epoch 21 [1.9s]: train==[0.37641=0.37640 + 0.00001]
Epoch 22 [2.3s]: train==[0.35631=0.35630 + 0.00001]
Epoch 23 [2.0s]: train==[0.33920=0.33919 + 0.00001]
Epoch 24 [2.1s]: train==[0.32189=0.32188 + 0.00001]
valid:{'recall': 0.91402817, 'hit_ratio': 0.9990999, 'precision': 0.22331327, 'ndcg': 0.6299499, 'mrr': 0.56663394, 'map': 0.52110684}
test_id:{'recall': 0.9807031, 'hit_ratio': 0.99916667, 'precision': 0.37533394, 'ndcg': 0.95783526, 'mrr': 0.9613843, 'map': 0.9368669}
Epoch 25 [2.0s]: train==[0.30771=0.30769 + 0.00001]
Epoch 26 [1.9s]: train==[0.29222=0.29220 + 0.00001]
Epoch 27 [1.9s]: train==[0.27615=0.27613 + 0.00002]
Epoch 28 [1.9s]: train==[0.26349=0.26348 + 0.00002]
Epoch 29 [2.1s]: train==[0.25245=0.25243 + 0.00002]
valid:{'recall': 0.91419715, 'hit_ratio': 0.9990999, 'precision': 0.2234933, 'ndcg': 0.63113815, 'mrr': 0.56808907, 'map': 0.52236974}
test_id:{'recall': 0.98102933, 'hit_ratio': 0.99833333, 'precision': 0.3759173, 'ndcg': 0.95818615, 'mrr': 0.9612578, 'map': 0.9368036}
Epoch 30 [2.3s]: train==[0.23922=0.23921 + 0.00002]
Epoch 31 [1.9s]: train==[0.22900=0.22898 + 0.00002]
Epoch 32 [2.3s]: train==[0.21955=0.21953 + 0.00002]
Epoch 33 [1.9s]: train==[0.21062=0.21061 + 0.00002]
Epoch 34 [1.9s]: train==[0.20303=0.20302 + 0.00002]
valid:{'recall': 0.914258, 'hit_ratio': 0.9990999, 'precision': 0.22358331, 'ndcg': 0.6322278, 'mrr': 0.5700092, 'map': 0.5235504}
test_id:{'recall': 0.98134845, 'hit_ratio': 0.99833333, 'precision': 0.37650064, 'ndcg': 0.9585308, 'mrr': 0.9619722, 'map': 0.9368683}
Epoch 35 [1.9s]: train==[0.19418=0.19416 + 0.00002]
Epoch 36 [2.2s]: train==[0.18773=0.18771 + 0.00002]
Epoch 37 [2.1s]: train==[0.18131=0.18129 + 0.00002]
Epoch 38 [2.2s]: train==[0.17519=0.17517 + 0.00002]
Epoch 39 [2.3s]: train==[0.16859=0.16856 + 0.00002]
valid:{'recall': 0.9139881, 'hit_ratio': 0.9990999, 'precision': 0.22385336, 'ndcg': 0.6326197, 'mrr': 0.5701292, 'map': 0.52414644}
test_id:{'recall': 0.98159844, 'hit_ratio': 0.99833333, 'precision': 0.37700066, 'ndcg': 0.9588347, 'mrr': 0.9619722, 'map': 0.9369979}
Epoch 40 [2.2s]: train==[0.16190=0.16188 + 0.00002]
Epoch 41 [2.2s]: train==[0.15682=0.15680 + 0.00002]
Epoch 42 [1.7s]: train==[0.15286=0.15284 + 0.00002]
Epoch 43 [1.7s]: train==[0.14733=0.14731 + 0.00002]
Epoch 44 [1.9s]: train==[0.14281=0.14279 + 0.00002]
valid:{'recall': 0.91399723, 'hit_ratio': 0.9990999, 'precision': 0.22385336, 'ndcg': 0.6324407, 'mrr': 0.5692077, 'map': 0.5239241}
test_id:{'recall': 0.9815058, 'hit_ratio': 0.99833333, 'precision': 0.37691733, 'ndcg': 0.9587014, 'mrr': 0.9619722, 'map': 0.93685967}
Epoch 45 [2.0s]: train==[0.14066=0.14063 + 0.00002]
Epoch 46 [2.5s]: train==[0.13566=0.13564 + 0.00002]
Epoch 47 [2.1s]: train==[0.13198=0.13196 + 0.00003]
Epoch 48 [2.5s]: train==[0.13173=0.13170 + 0.00003]
Epoch 49 [2.3s]: train==[0.12712=0.12709 + 0.00003]
valid:{'recall': 0.91444725, 'hit_ratio': 0.9990999, 'precision': 0.22403337, 'ndcg': 0.63233733, 'mrr': 0.5680791, 'map': 0.52360064}
test_id:{'recall': 0.98154753, 'hit_ratio': 0.99916667, 'precision': 0.37700066, 'ndcg': 0.9590824, 'mrr': 0.96252775, 'map': 0.9374289}
Epoch 50 [1.9s]: train==[0.12187=0.12185 + 0.00003]
Epoch 51 [2.2s]: train==[0.12108=0.12105 + 0.00003]
Epoch 52 [3.9s]: train==[0.11613=0.11610 + 0.00003]
Epoch 53 [3.6s]: train==[0.11692=0.11689 + 0.00003]
Epoch 54 [2.8s]: train==[0.11339=0.11337 + 0.00003]
valid:{'recall': 0.91481394, 'hit_ratio': 1.0, 'precision': 0.22466344, 'ndcg': 0.632838, 'mrr': 0.5680641, 'map': 0.5241349}
test_id:{'recall': 0.9819522, 'hit_ratio': 0.99916667, 'precision': 0.377834, 'ndcg': 0.95996064, 'mrr': 0.96322215, 'map': 0.9382912}
Epoch 55 [4.5s]: train==[0.11285=0.11282 + 0.00003]
Epoch 56 [7.5s]: train==[0.10949=0.10946 + 0.00003]
Epoch 57 [6.7s]: train==[0.10684=0.10681 + 0.00003]
Epoch 58 [5.0s]: train==[0.10728=0.10725 + 0.00003]
Epoch 59 [3.3s]: train==[0.10314=0.10311 + 0.00003]
valid:{'recall': 0.9145314, 'hit_ratio': 0.9990999, 'precision': 0.22448342, 'ndcg': 0.63210636, 'mrr': 0.5652513, 'map': 0.5234436}
test_id:{'recall': 0.9819225, 'hit_ratio': 0.99916667, 'precision': 0.37775066, 'ndcg': 0.9605958, 'mrr': 0.9640555, 'map': 0.9393342}
Epoch 60 [5.7s]: train==[0.10242=0.10239 + 0.00003]
Epoch 61 [4.0s]: train==[0.10007=0.10004 + 0.00003]
Epoch 62 [5.4s]: train==[0.09832=0.09829 + 0.00003]
Epoch 63 [5.3s]: train==[0.09610=0.09606 + 0.00003]
Epoch 64 [6.1s]: train==[0.09623=0.09620 + 0.00003]
valid:{'recall': 0.914566, 'hit_ratio': 0.9990999, 'precision': 0.22457343, 'ndcg': 0.6318758, 'mrr': 0.56375116, 'map': 0.5232225}
test_id:{'recall': 0.9820417, 'hit_ratio': 0.99916667, 'precision': 0.37775066, 'ndcg': 0.96154135, 'mrr': 0.96528566, 'map': 0.94058484}
Epoch 65 [3.6s]: train==[0.09186=0.09183 + 0.00003]
Epoch 66 [3.7s]: train==[0.09293=0.09289 + 0.00003]
Epoch 67 [5.4s]: train==[0.09396=0.09392 + 0.00003]
Epoch 68 [4.0s]: train==[0.09248=0.09245 + 0.00003]
Epoch 69 [4.9s]: train==[0.08914=0.08911 + 0.00003]
valid:{'recall': 0.9147519, 'hit_ratio': 0.9990999, 'precision': 0.22457342, 'ndcg': 0.6318374, 'mrr': 0.56334615, 'map': 0.5231714}
test_id:{'recall': 0.9819854, 'hit_ratio': 0.99916667, 'precision': 0.37775066, 'ndcg': 0.9637086, 'mrr': 0.9682023, 'map': 0.9435912}
Epoch 70 [4.5s]: train==[0.08974=0.08971 + 0.00003]
Epoch 71 [3.4s]: train==[0.08710=0.08707 + 0.00003]
Epoch 72 [4.3s]: train==[0.08737=0.08733 + 0.00003]
Epoch 73 [2.2s]: train==[0.08628=0.08624 + 0.00003]
Epoch 74 [3.2s]: train==[0.08641=0.08638 + 0.00003]
valid:{'recall': 0.916102, 'hit_ratio': 0.9990999, 'precision': 0.22511347, 'ndcg': 0.63253945, 'mrr': 0.56334615, 'map': 0.5232082}
test_id:{'recall': 0.98194915, 'hit_ratio': 0.99916667, 'precision': 0.3776673, 'ndcg': 0.9670534, 'mrr': 0.97278565, 'map': 0.94819903}
Epoch 75 [5.7s]: train==[0.08590=0.08587 + 0.00004]
Epoch 76 [4.4s]: train==[0.08516=0.08513 + 0.00004]
Epoch 77 [7.3s]: train==[0.08028=0.08024 + 0.00004]
Epoch 78 [7.6s]: train==[0.08270=0.08266 + 0.00004]
Epoch 79 [3.5s]: train==[0.08127=0.08123 + 0.00004]
valid:{'recall': 0.91606987, 'hit_ratio': 0.9990999, 'precision': 0.22502345, 'ndcg': 0.63262814, 'mrr': 0.5629285, 'map': 0.5236307}
test_id:{'recall': 0.9820139, 'hit_ratio': 0.99916667, 'precision': 0.3776673, 'ndcg': 0.9732027, 'mrr': 0.981119, 'map': 0.95650053}
Epoch 80 [6.8s]: train==[0.07969=0.07965 + 0.00004]
Epoch 81 [3.9s]: train==[0.07920=0.07916 + 0.00004]
Epoch 82 [6.5s]: train==[0.08360=0.08357 + 0.00004]
Epoch 83 [4.8s]: train==[0.08245=0.08242 + 0.00004]
Epoch 84 [6.1s]: train==[0.08177=0.08173 + 0.00004]
valid:{'recall': 0.91606987, 'hit_ratio': 0.9990999, 'precision': 0.22502345, 'ndcg': 0.63281214, 'mrr': 0.56270355, 'map': 0.52401465}
test_id:{'recall': 0.9820139, 'hit_ratio': 0.99916667, 'precision': 0.3776673, 'ndcg': 0.98029387, 'mrr': 0.99070233, 'map': 0.96613544}
Epoch 85 [5.7s]: train==[0.08076=0.08073 + 0.00004]
Epoch 86 [5.3s]: train==[0.07846=0.07843 + 0.00004]
Epoch 87 [6.3s]: train==[0.07463=0.07459 + 0.00004]
Epoch 88 [5.9s]: train==[0.07906=0.07902 + 0.00004]
Epoch 89 [6.3s]: train==[0.07549=0.07545 + 0.00004]
valid:{'recall': 0.91599363, 'hit_ratio': 0.9981998, 'precision': 0.22484343, 'ndcg': 0.6327048, 'mrr': 0.56260353, 'map': 0.52389854}
test_id:{'recall': 0.9818916, 'hit_ratio': 0.99916667, 'precision': 0.37750062, 'ndcg': 0.98269194, 'mrr': 0.99403566, 'map': 0.969631}
Epoch 90 [7.5s]: train==[0.07699=0.07695 + 0.00004]
Epoch 91 [5.8s]: train==[0.07563=0.07559 + 0.00004]
Epoch 92 [3.1s]: train==[0.07546=0.07542 + 0.00004]
Epoch 93 [3.8s]: train==[0.07658=0.07654 + 0.00004]
Epoch 94 [3.3s]: train==[0.07211=0.07207 + 0.00004]
valid:{'recall': 0.91597986, 'hit_ratio': 0.9981998, 'precision': 0.22475341, 'ndcg': 0.63267624, 'mrr': 0.5625586, 'map': 0.523943}
test_id:{'recall': 0.9818285, 'hit_ratio': 0.99916667, 'precision': 0.377334, 'ndcg': 0.9846758, 'mrr': 0.996744, 'map': 0.97243726}
Epoch 95 [5.3s]: train==[0.07471=0.07467 + 0.00004]
Epoch 96 [7.6s]: train==[0.07494=0.07490 + 0.00004]
Epoch 97 [2.3s]: train==[0.07308=0.07304 + 0.00004]
Epoch 98 [3.0s]: train==[0.07476=0.07472 + 0.00004]
Epoch 99 [8.8s]: train==[0.07458=0.07454 + 0.00004]
valid:{'recall': 0.91589355, 'hit_ratio': 0.9981998, 'precision': 0.22457339, 'ndcg': 0.63256353, 'mrr': 0.56252104, 'map': 0.5239347}
test_id:{'recall': 0.9817105, 'hit_ratio': 0.99916667, 'precision': 0.3770007, 'ndcg': 0.9847349, 'mrr': 0.9971342, 'map': 0.97277254}
The best epoch is  74
valid:{'recall': 0.916102, 'hit_ratio': 0.9990999, 'precision': 0.22511347, 'ndcg': 0.63253945, 'mrr': 0.56334615, 'map': 0.5232082}
test_id:{'recall': 0.98194915, 'hit_ratio': 0.99916667, 'precision': 0.3776673, 'ndcg': 0.9670534, 'mrr': 0.97278565, 'map': 0.94819903}
The best epoch is  74
