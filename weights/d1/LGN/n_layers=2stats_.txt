Epoch 0 [1.9s]: train==[0.69246=0.69246 + 0.00000]
Epoch 1 [1.8s]: train==[0.69165=0.69164 + 0.00000]
Epoch 2 [1.5s]: train==[0.69013=0.69013 + 0.00000]
Epoch 3 [2.1s]: train==[0.68749=0.68748 + 0.00000]
Epoch 4 [2.6s]: train==[0.68320=0.68320 + 0.00000]
valid:{'recall': 0.9434373, 'hit_ratio': 0.9981998, 'precision': 0.12524827, 'ndcg': 0.6438905, 'mrr': 0.57762295, 'map': 0.5185082}
test_id:{'recall': 0.962655, 'hit_ratio': 1.0, 'precision': 0.18008368, 'ndcg': 0.8689168, 'mrr': 0.8959083, 'map': 0.81999916}
Epoch 5 [1.8s]: train==[0.67700=0.67700 + 0.00000]
Epoch 6 [1.7s]: train==[0.66844=0.66844 + 0.00000]
Epoch 7 [1.9s]: train==[0.65762=0.65762 + 0.00001]
Epoch 8 [2.0s]: train==[0.64417=0.64416 + 0.00001]
Epoch 9 [1.6s]: train==[0.62861=0.62860 + 0.00001]
valid:{'recall': 0.9785511, 'hit_ratio': 1.0, 'precision': 0.13843459, 'ndcg': 0.6568506, 'mrr': 0.56279504, 'map': 0.51313716}
test_id:{'recall': 0.9850684, 'hit_ratio': 1.0, 'precision': 0.19137534, 'ndcg': 0.92427325, 'mrr': 0.9338336, 'map': 0.8924841}
Epoch 10 [2.4s]: train==[0.61093=0.61093 + 0.00001]
Epoch 11 [2.2s]: train==[0.59193=0.59192 + 0.00001]
Epoch 12 [2.2s]: train==[0.57100=0.57100 + 0.00001]
Epoch 13 [2.2s]: train==[0.55005=0.55004 + 0.00001]
Epoch 14 [2.0s]: train==[0.52823=0.52822 + 0.00001]
valid:{'recall': 0.9823787, 'hit_ratio': 0.9981998, 'precision': 0.14027978, 'ndcg': 0.6524107, 'mrr': 0.5492129, 'map': 0.50587344}
test_id:{'recall': 0.9869454, 'hit_ratio': 0.99833333, 'precision': 0.19266704, 'ndcg': 0.93380797, 'mrr': 0.943361, 'map': 0.9048178}
Epoch 15 [1.8s]: train==[0.50525=0.50524 + 0.00001]
Epoch 16 [1.7s]: train==[0.48310=0.48309 + 0.00001]
Epoch 17 [1.8s]: train==[0.46132=0.46132 + 0.00001]
Epoch 18 [2.2s]: train==[0.43887=0.43886 + 0.00001]
Epoch 19 [2.1s]: train==[0.41798=0.41796 + 0.00001]
valid:{'recall': 0.98293686, 'hit_ratio': 0.99729973, 'precision': 0.14059481, 'ndcg': 0.65366197, 'mrr': 0.5488702, 'map': 0.5073421}
test_id:{'recall': 0.98748374, 'hit_ratio': 0.99833333, 'precision': 0.19312538, 'ndcg': 0.9397841, 'mrr': 0.9519305, 'map': 0.91233116}
Epoch 20 [1.8s]: train==[0.39661=0.39660 + 0.00001]
Epoch 21 [2.2s]: train==[0.37665=0.37664 + 0.00001]
Epoch 22 [1.9s]: train==[0.35802=0.35801 + 0.00001]
Epoch 23 [1.9s]: train==[0.34071=0.34069 + 0.00001]
Epoch 24 [1.6s]: train==[0.32367=0.32366 + 0.00001]
valid:{'recall': 0.98317003, 'hit_ratio': 0.99729973, 'precision': 0.14063981, 'ndcg': 0.6566074, 'mrr': 0.55308217, 'map': 0.5109075}
test_id:{'recall': 0.9879487, 'hit_ratio': 0.99833333, 'precision': 0.19345869, 'ndcg': 0.9443514, 'mrr': 0.95677185, 'map': 0.9188709}
Epoch 25 [2.2s]: train==[0.30808=0.30806 + 0.00001]
Epoch 26 [2.3s]: train==[0.29287=0.29286 + 0.00001]
Epoch 27 [1.9s]: train==[0.27770=0.27769 + 0.00002]
Epoch 28 [2.5s]: train==[0.26635=0.26633 + 0.00002]
Epoch 29 [2.1s]: train==[0.25196=0.25195 + 0.00002]
valid:{'recall': 0.9834504, 'hit_ratio': 0.9990999, 'precision': 0.14077482, 'ndcg': 0.6586694, 'mrr': 0.55588573, 'map': 0.5132599}
test_id:{'recall': 0.98850685, 'hit_ratio': 0.99833333, 'precision': 0.19387539, 'ndcg': 0.94754183, 'mrr': 0.9592871, 'map': 0.9233072}
Epoch 30 [2.3s]: train==[0.24288=0.24286 + 0.00002]
Epoch 31 [2.2s]: train==[0.23078=0.23076 + 0.00002]
Epoch 32 [2.0s]: train==[0.21991=0.21989 + 0.00002]
Epoch 33 [1.7s]: train==[0.21151=0.21149 + 0.00002]
Epoch 34 [1.9s]: train==[0.20224=0.20222 + 0.00002]
valid:{'recall': 0.9837696, 'hit_ratio': 0.9990999, 'precision': 0.14099985, 'ndcg': 0.66008294, 'mrr': 0.5580599, 'map': 0.51490015}
test_id:{'recall': 0.9894039, 'hit_ratio': 0.99916667, 'precision': 0.19458376, 'ndcg': 0.94952685, 'mrr': 0.96025, 'map': 0.92638946}
Epoch 35 [2.2s]: train==[0.19610=0.19608 + 0.00002]
Epoch 36 [2.2s]: train==[0.18842=0.18840 + 0.00002]
Epoch 37 [2.2s]: train==[0.17958=0.17956 + 0.00002]
Epoch 38 [2.0s]: train==[0.17502=0.17500 + 0.00002]
Epoch 39 [2.2s]: train==[0.16729=0.16726 + 0.00002]
valid:{'recall': 0.98416966, 'hit_ratio': 0.9990999, 'precision': 0.14144993, 'ndcg': 0.66163844, 'mrr': 0.5596349, 'map': 0.51664627}
test_id:{'recall': 0.9904016, 'hit_ratio': 0.99916667, 'precision': 0.19550042, 'ndcg': 0.9528083, 'mrr': 0.9608674, 'map': 0.93200713}
Epoch 40 [3.6s]: train==[0.16305=0.16303 + 0.00002]
Epoch 41 [1.8s]: train==[0.15845=0.15842 + 0.00002]
Epoch 42 [2.2s]: train==[0.15243=0.15241 + 0.00002]
Epoch 43 [2.1s]: train==[0.14827=0.14825 + 0.00002]
Epoch 44 [2.0s]: train==[0.14387=0.14385 + 0.00002]
valid:{'recall': 0.98421955, 'hit_ratio': 0.9990999, 'precision': 0.14144993, 'ndcg': 0.66295636, 'mrr': 0.5613152, 'map': 0.5182853}
test_id:{'recall': 0.99119335, 'hit_ratio': 0.99916667, 'precision': 0.19612539, 'ndcg': 0.95431775, 'mrr': 0.9612778, 'map': 0.93397367}
Epoch 45 [3.2s]: train==[0.14063=0.14060 + 0.00002]
Epoch 46 [2.1s]: train==[0.13537=0.13535 + 0.00003]
Epoch 47 [2.1s]: train==[0.13338=0.13335 + 0.00003]
Epoch 48 [2.2s]: train==[0.12945=0.12943 + 0.00003]
Epoch 49 [2.1s]: train==[0.12540=0.12538 + 0.00003]
valid:{'recall': 0.9843362, 'hit_ratio': 1.0, 'precision': 0.14153992, 'ndcg': 0.6637399, 'mrr': 0.5626303, 'map': 0.5192943}
test_id:{'recall': 0.99167925, 'hit_ratio': 0.99916667, 'precision': 0.19654204, 'ndcg': 0.95535886, 'mrr': 0.96123075, 'map': 0.93529093}
Epoch 50 [2.8s]: train==[0.12405=0.12402 + 0.00003]
Epoch 51 [6.5s]: train==[0.11957=0.11954 + 0.00003]
Epoch 52 [5.7s]: train==[0.11790=0.11787 + 0.00003]
Epoch 53 [8.1s]: train==[0.11537=0.11534 + 0.00003]
Epoch 54 [5.8s]: train==[0.11218=0.11215 + 0.00003]
valid:{'recall': 0.9848181, 'hit_ratio': 1.0, 'precision': 0.14194497, 'ndcg': 0.6644829, 'mrr': 0.564151, 'map': 0.51987845}
test_id:{'recall': 0.99235374, 'hit_ratio': 0.99916667, 'precision': 0.19716707, 'ndcg': 0.9559715, 'mrr': 0.96123075, 'map': 0.9356583}
Epoch 55 [6.2s]: train==[0.11076=0.11073 + 0.00003]
Epoch 56 [7.1s]: train==[0.10851=0.10848 + 0.00003]
Epoch 57 [4.2s]: train==[0.10421=0.10418 + 0.00003]
Epoch 58 [5.4s]: train==[0.10389=0.10386 + 0.00003]
Epoch 59 [7.3s]: train==[0.10223=0.10220 + 0.00003]
valid:{'recall': 0.984868, 'hit_ratio': 1.0, 'precision': 0.14198996, 'ndcg': 0.6645454, 'mrr': 0.56371844, 'map': 0.5200362}
test_id:{'recall': 0.99266213, 'hit_ratio': 0.99916667, 'precision': 0.1973754, 'ndcg': 0.95618004, 'mrr': 0.96123075, 'map': 0.9356796}
Epoch 60 [5.8s]: train==[0.10188=0.10185 + 0.00003]
Epoch 61 [6.1s]: train==[0.09920=0.09917 + 0.00003]
Epoch 62 [6.0s]: train==[0.09702=0.09699 + 0.00003]
Epoch 63 [4.6s]: train==[0.09863=0.09860 + 0.00003]
Epoch 64 [5.1s]: train==[0.09502=0.09499 + 0.00003]
valid:{'recall': 0.98483473, 'hit_ratio': 1.0, 'precision': 0.14194497, 'ndcg': 0.6644062, 'mrr': 0.56340605, 'map': 0.51990956}
test_id:{'recall': 0.99322283, 'hit_ratio': 0.99916667, 'precision': 0.19783372, 'ndcg': 0.9566334, 'mrr': 0.961203, 'map': 0.9358439}
Epoch 65 [3.9s]: train==[0.09486=0.09483 + 0.00003]
Epoch 66 [4.2s]: train==[0.09367=0.09364 + 0.00003]
Epoch 67 [4.6s]: train==[0.09207=0.09204 + 0.00003]
Epoch 68 [2.9s]: train==[0.09370=0.09366 + 0.00003]
Epoch 69 [4.7s]: train==[0.09033=0.09029 + 0.00003]
valid:{'recall': 0.9848026, 'hit_ratio': 1.0, 'precision': 0.14189997, 'ndcg': 0.66436857, 'mrr': 0.56340605, 'map': 0.51988494}
test_id:{'recall': 0.9933299, 'hit_ratio': 0.99916667, 'precision': 0.19791706, 'ndcg': 0.95674723, 'mrr': 0.961203, 'map': 0.93600595}
Epoch 70 [2.4s]: train==[0.08881=0.08878 + 0.00003]
Epoch 71 [6.2s]: train==[0.08723=0.08720 + 0.00003]
Epoch 72 [7.5s]: train==[0.08844=0.08840 + 0.00003]
Epoch 73 [7.7s]: train==[0.08638=0.08635 + 0.00004]
Epoch 74 [5.7s]: train==[0.08932=0.08928 + 0.00004]
valid:{'recall': 0.98468477, 'hit_ratio': 0.9990999, 'precision': 0.14180996, 'ndcg': 0.6643825, 'mrr': 0.563346, 'map': 0.52004415}
test_id:{'recall': 0.9933952, 'hit_ratio': 0.99916667, 'precision': 0.19791707, 'ndcg': 0.9571651, 'mrr': 0.96161115, 'map': 0.9367145}
Epoch 75 [4.7s]: train==[0.08421=0.08417 + 0.00004]
Epoch 76 [4.1s]: train==[0.08462=0.08458 + 0.00004]
Epoch 77 [6.1s]: train==[0.08344=0.08340 + 0.00004]
Epoch 78 [6.3s]: train==[0.08278=0.08274 + 0.00004]
Epoch 79 [3.9s]: train==[0.08017=0.08013 + 0.00004]
valid:{'recall': 0.9847598, 'hit_ratio': 0.9990999, 'precision': 0.14185496, 'ndcg': 0.66466963, 'mrr': 0.5633911, 'map': 0.5205066}
test_id:{'recall': 0.9936983, 'hit_ratio': 0.99916667, 'precision': 0.19816709, 'ndcg': 0.9614363, 'mrr': 0.9670213, 'map': 0.9423517}
Epoch 80 [5.8s]: train==[0.08222=0.08219 + 0.00004]
Epoch 81 [5.0s]: train==[0.08019=0.08016 + 0.00004]
Epoch 82 [6.4s]: train==[0.07859=0.07855 + 0.00004]
Epoch 83 [2.9s]: train==[0.07806=0.07803 + 0.00004]
Epoch 84 [3.6s]: train==[0.07791=0.07787 + 0.00004]
valid:{'recall': 0.98472756, 'hit_ratio': 0.9990999, 'precision': 0.14180997, 'ndcg': 0.66472006, 'mrr': 0.5632353, 'map': 0.52069503}
test_id:{'recall': 0.99383646, 'hit_ratio': 0.99833333, 'precision': 0.19829209, 'ndcg': 0.9643223, 'mrr': 0.97030556, 'map': 0.9462441}
Epoch 85 [3.9s]: train==[0.07850=0.07846 + 0.00004]
Epoch 86 [3.2s]: train==[0.07730=0.07726 + 0.00004]
Epoch 87 [4.8s]: train==[0.07919=0.07915 + 0.00004]
Epoch 88 [5.8s]: train==[0.07755=0.07751 + 0.00004]
Epoch 89 [5.3s]: train==[0.07543=0.07539 + 0.00004]
valid:{'recall': 0.9847252, 'hit_ratio': 0.9990999, 'precision': 0.14180996, 'ndcg': 0.66483057, 'mrr': 0.56322604, 'map': 0.5208962}
test_id:{'recall': 0.9939525, 'hit_ratio': 0.99833333, 'precision': 0.19837542, 'ndcg': 0.9702665, 'mrr': 0.97822225, 'map': 0.95428795}
Epoch 90 [3.6s]: train==[0.07395=0.07391 + 0.00004]
Epoch 91 [4.6s]: train==[0.07522=0.07518 + 0.00004]
Epoch 92 [3.7s]: train==[0.07522=0.07518 + 0.00004]
Epoch 93 [4.3s]: train==[0.07514=0.07510 + 0.00004]
Epoch 94 [3.4s]: train==[0.07288=0.07284 + 0.00004]
valid:{'recall': 0.9845173, 'hit_ratio': 0.9990999, 'precision': 0.14171995, 'ndcg': 0.6648387, 'mrr': 0.56323034, 'map': 0.5211094}
test_id:{'recall': 0.99418974, 'hit_ratio': 0.99833333, 'precision': 0.19858375, 'ndcg': 0.9753281, 'mrr': 0.9848889, 'map': 0.9609103}
Epoch 95 [7.1s]: train==[0.07707=0.07703 + 0.00004]
Epoch 96 [4.3s]: train==[0.06949=0.06945 + 0.00004]
Epoch 97 [2.7s]: train==[0.07201=0.07197 + 0.00004]
Epoch 98 [6.1s]: train==[0.07197=0.07193 + 0.00004]
Epoch 99 [7.4s]: train==[0.07257=0.07253 + 0.00004]
valid:{'recall': 0.9844519, 'hit_ratio': 0.9990999, 'precision': 0.14162993, 'ndcg': 0.66481835, 'mrr': 0.5632179, 'map': 0.52124274}
test_id:{'recall': 0.99418974, 'hit_ratio': 0.99833333, 'precision': 0.19858375, 'ndcg': 0.9780465, 'mrr': 0.98822224, 'map': 0.9646173}
The best epoch is  59
valid:{'recall': 0.984868, 'hit_ratio': 1.0, 'precision': 0.14198996, 'ndcg': 0.6645454, 'mrr': 0.56371844, 'map': 0.5200362}
test_id:{'recall': 0.99266213, 'hit_ratio': 0.99916667, 'precision': 0.1973754, 'ndcg': 0.95618004, 'mrr': 0.96123075, 'map': 0.9356796}
The best epoch is  59
