Epoch 0 [31.6s]: train==[2.02503=6.10496 + 2.02438 + 0.00075]
Epoch 1 [31.3s]: train==[1.31428=6.00520 + 1.31363 + 0.00075]
Epoch 2 [31.2s]: train==[1.22833=5.98341 + 1.22768 + 0.00075]
Epoch 3 [31.2s]: train==[1.20745=5.97516 + 1.20680 + 0.00075]
Epoch 0 [31.0s]: train==[2.08179=6.09121 + 2.08114 + 0.00075]
Epoch 1 [30.5s]: train==[1.32868=5.98892 + 1.32803 + 0.00075]
Epoch 2 [30.6s]: train==[1.23268=5.96395 + 1.23203 + 0.00075]
Epoch 3 [30.0s]: train==[1.20740=5.95483 + 1.20675 + 0.00075]
Epoch 4 [30.3s]: train==[1.19588=5.95017 + 1.19523 + 0.00075]
valid:{'recall': 0.04085758, 'hit_ratio': 0.11668747, 'precision': 0.006128393, 'ndcg': 0.022078682, 'mrr': 0.02615707, 'map': 0.025739918}
test_id:{'recall': 0.04085758, 'hit_ratio': 0.11668747, 'precision': 0.006128393, 'ndcg': 0.022078682, 'mrr': 0.02615707, 'map': 0.025739918}
Epoch 5 [32.0s]: train==[4.62883=3.43749 + 1.19058 + 0.00075]
Epoch 6 [32.1s]: train==[3.75452=2.56103 + 1.19274 + 0.00076]
Epoch 7 [32.1s]: train==[3.43719=2.24404 + 1.19238 + 0.00077]
Epoch 8 [31.7s]: train==[3.25997=2.06731 + 1.19190 + 0.00077]
Epoch 9 [32.0s]: train==[3.15169=1.95970 + 1.19121 + 0.00077]
valid:{'recall': 0.80144453, 'hit_ratio': 0.9774826, 'precision': 0.12018424, 'ndcg': 0.68484205, 'mrr': 0.78608614, 'map': 0.6590028}
test_id:{'recall': 0.80144453, 'hit_ratio': 0.9774826, 'precision': 0.12018424, 'ndcg': 0.68484205, 'mrr': 0.78608614, 'map': 0.6590028}
Epoch 10 [33.6s]: train==[3.07515=1.88292 + 1.19145 + 0.00078]
Epoch 11 [33.5s]: train==[3.01364=1.82226 + 1.19060 + 0.00078]
Epoch 12 [32.2s]: train==[2.97590=1.78210 + 1.19302 + 0.00078]
Epoch 13 [32.2s]: train==[2.94002=1.74810 + 1.19113 + 0.00078]
Epoch 14 [33.2s]: train==[2.92042=1.72750 + 1.19214 + 0.00078]
valid:{'recall': 0.8195095, 'hit_ratio': 0.98195755, 'precision': 0.1228903, 'ndcg': 0.7047611, 'mrr': 0.8007171, 'map': 0.6758099}
test_id:{'recall': 0.8195095, 'hit_ratio': 0.98195755, 'precision': 0.1228903, 'ndcg': 0.7047611, 'mrr': 0.8007171, 'map': 0.6758099}
Epoch 15 [33.5s]: train==[2.90380=1.71117 + 1.19184 + 0.00079]
Epoch 16 [33.1s]: train==[2.88784=1.69570 + 1.19135 + 0.00079]
Epoch 17 [34.3s]: train==[2.88053=1.68643 + 1.19331 + 0.00079]
Epoch 18 [34.0s]: train==[2.86789=1.67649 + 1.19061 + 0.00079]
Epoch 19 [34.2s]: train==[2.86189=1.66972 + 1.19138 + 0.00079]
valid:{'recall': 0.8272578, 'hit_ratio': 0.9835443, 'precision': 0.12405126, 'ndcg': 0.7122284, 'mrr': 0.80517435, 'map': 0.68075716}
test_id:{'recall': 0.8272578, 'hit_ratio': 0.9835443, 'precision': 0.12405126, 'ndcg': 0.7122284, 'mrr': 0.80517435, 'map': 0.68075716}
Epoch 20 [33.0s]: train==[2.85623=1.66411 + 1.19133 + 0.00079]
Epoch 21 [32.1s]: train==[2.85191=1.65938 + 1.19173 + 0.00079]
Epoch 22 [32.2s]: train==[2.84803=1.65468 + 1.19256 + 0.00080]
Epoch 23 [31.8s]: train==[2.84394=1.65013 + 1.19301 + 0.00080]
Epoch 24 [32.0s]: train==[2.84250=1.64841 + 1.19328 + 0.00080]
valid:{'recall': 0.83170384, 'hit_ratio': 0.98425746, 'precision': 0.12471741, 'ndcg': 0.7164747, 'mrr': 0.8092718, 'map': 0.6832829}
test_id:{'recall': 0.83170384, 'hit_ratio': 0.98425746, 'precision': 0.12471741, 'ndcg': 0.7164747, 'mrr': 0.8092718, 'map': 0.6832829}
Epoch 25 [32.0s]: train==[2.83485=1.64297 + 1.19108 + 0.00080]
Epoch 26 [31.9s]: train==[2.83332=1.64080 + 1.19172 + 0.00080]
Epoch 27 [32.1s]: train==[2.83166=1.63886 + 1.19200 + 0.00080]
Epoch 28 [32.0s]: train==[2.82993=1.63694 + 1.19219 + 0.00081]
Epoch 29 [32.2s]: train==[2.82852=1.63516 + 1.19255 + 0.00081]
valid:{'recall': 0.8343533, 'hit_ratio': 0.9844892, 'precision': 0.1251144, 'ndcg': 0.7193882, 'mrr': 0.8110052, 'map': 0.68500197}
test_id:{'recall': 0.8343533, 'hit_ratio': 0.9844892, 'precision': 0.1251144, 'ndcg': 0.7193882, 'mrr': 0.8110052, 'map': 0.68500197}
Epoch 30 [32.1s]: train==[2.82546=1.63220 + 1.19246 + 0.00081]
Epoch 31 [31.8s]: train==[2.82379=1.63022 + 1.19275 + 0.00081]
Epoch 32 [32.4s]: train==[2.82486=1.63141 + 1.19264 + 0.00081]
Epoch 33 [32.4s]: train==[2.82332=1.62860 + 1.19391 + 0.00081]
Epoch 34 [32.7s]: train==[2.81805=1.62539 + 1.19184 + 0.00082]
valid:{'recall': 0.8356922, 'hit_ratio': 0.9850419, 'precision': 0.12531465, 'ndcg': 0.7198971, 'mrr': 0.81100106, 'map': 0.6851837}
test_id:{'recall': 0.8356922, 'hit_ratio': 0.9850419, 'precision': 0.12531465, 'ndcg': 0.7198971, 'mrr': 0.81100106, 'map': 0.6851837}
Epoch 35 [32.7s]: train==[2.81538=1.62304 + 1.19153 + 0.00082]
Epoch 36 [32.4s]: train==[2.80970=1.61929 + 1.18959 + 0.00082]
Epoch 37 [32.3s]: train==[2.81289=1.62092 + 1.19115 + 0.00082]
Epoch 38 [32.2s]: train==[2.81901=1.62427 + 1.19392 + 0.00082]
Epoch 39 [32.3s]: train==[2.80912=1.61710 + 1.19120 + 0.00082]
valid:{'recall': 0.83723724, 'hit_ratio': 0.9854876, 'precision': 0.12554625, 'ndcg': 0.7200583, 'mrr': 0.8092426, 'map': 0.68421835}
test_id:{'recall': 0.83723724, 'hit_ratio': 0.9854876, 'precision': 0.12554625, 'ndcg': 0.7200608, 'mrr': 0.80925155, 'map': 0.6842259}
Epoch 40 [32.0s]: train==[2.81157=1.61832 + 1.19243 + 0.00082]
Epoch 41 [32.0s]: train==[2.80880=1.61807 + 1.18990 + 0.00083]
Epoch 42 [32.0s]: train==[2.81185=1.61834 + 1.19269 + 0.00083]
Epoch 43 [32.0s]: train==[2.80505=1.61398 + 1.19024 + 0.00083]
Epoch 44 [32.1s]: train==[2.80596=1.61354 + 1.19159 + 0.00083]
valid:{'recall': 0.83935094, 'hit_ratio': 0.9857372, 'precision': 0.12586303, 'ndcg': 0.7218319, 'mrr': 0.8117158, 'map': 0.6846484}
test_id:{'recall': 0.83935094, 'hit_ratio': 0.9857372, 'precision': 0.12586303, 'ndcg': 0.7218319, 'mrr': 0.8117158, 'map': 0.6846484}
Epoch 45 [32.1s]: train==[2.80589=1.61332 + 1.19174 + 0.00083]
Epoch 46 [32.2s]: train==[2.80671=1.61454 + 1.19133 + 0.00083]
Epoch 47 [32.5s]: train==[2.80197=1.61070 + 1.19044 + 0.00083]
Epoch 48 [32.4s]: train==[2.80218=1.61095 + 1.19040 + 0.00084]
Epoch 49 [32.6s]: train==[2.80023=1.60955 + 1.18984 + 0.00084]
valid:{'recall': 0.83988625, 'hit_ratio': 0.98579067, 'precision': 0.1259432, 'ndcg': 0.72160876, 'mrr': 0.81040746, 'map': 0.6839614}
test_id:{'recall': 0.83988625, 'hit_ratio': 0.98579067, 'precision': 0.1259432, 'ndcg': 0.7216088, 'mrr': 0.81040746, 'map': 0.6839615}
Epoch 50 [32.6s]: train==[2.80486=1.61096 + 1.19307 + 0.00084]
Epoch 51 [32.4s]: train==[2.80666=1.61254 + 1.19328 + 0.00084]
Epoch 52 [32.5s]: train==[2.79862=1.60722 + 1.19057 + 0.00084]
Epoch 53 [32.4s]: train==[2.80357=1.61043 + 1.19229 + 0.00084]
Epoch 54 [32.3s]: train==[2.80263=1.60905 + 1.19273 + 0.00084]
valid:{'recall': 0.8402193, 'hit_ratio': 0.98577285, 'precision': 0.12599316, 'ndcg': 0.7214499, 'mrr': 0.8099351, 'map': 0.6834742}
test_id:{'recall': 0.8402193, 'hit_ratio': 0.98577285, 'precision': 0.12599316, 'ndcg': 0.7214499, 'mrr': 0.8099351, 'map': 0.6834742}
Epoch 55 [32.3s]: train==[2.79844=1.60573 + 1.19186 + 0.00085]
Epoch 56 [32.1s]: train==[2.79520=1.60418 + 1.19018 + 0.00085]
Epoch 57 [32.5s]: train==[2.79799=1.60625 + 1.19088 + 0.00085]
Epoch 58 [32.0s]: train==[2.79450=1.60375 + 1.18990 + 0.00085]
Epoch 59 [32.1s]: train==[2.79623=1.60413 + 1.19125 + 0.00085]
valid:{'recall': 0.8402554, 'hit_ratio': 0.98525584, 'precision': 0.12599847, 'ndcg': 0.7219602, 'mrr': 0.80976224, 'map': 0.68442696}
test_id:{'recall': 0.8402554, 'hit_ratio': 0.98525584, 'precision': 0.12599847, 'ndcg': 0.72195953, 'mrr': 0.80976224, 'map': 0.6844259}
Epoch 60 [32.1s]: train==[2.79311=1.60192 + 1.19034 + 0.00085]
Epoch 61 [32.0s]: train==[2.79782=1.60470 + 1.19227 + 0.00085]
Epoch 62 [32.5s]: train==[2.79417=1.60243 + 1.19088 + 0.00085]
Epoch 63 [32.2s]: train==[2.79715=1.60364 + 1.19265 + 0.00086]
Epoch 64 [32.1s]: train==[2.79240=1.60093 + 1.19062 + 0.00086]
valid:{'recall': 0.8408837, 'hit_ratio': 0.98577285, 'precision': 0.12609258, 'ndcg': 0.7217801, 'mrr': 0.8096906, 'map': 0.68368334}
test_id:{'recall': 0.8408837, 'hit_ratio': 0.98577285, 'precision': 0.12609258, 'ndcg': 0.7217801, 'mrr': 0.8096906, 'map': 0.68368334}
Epoch 65 [33.4s]: train==[2.78801=1.59846 + 1.18868 + 0.00086]
Epoch 66 [33.5s]: train==[2.79362=1.60085 + 1.19191 + 0.00086]
Epoch 67 [32.0s]: train==[2.79252=1.60136 + 1.19029 + 0.00086]
Epoch 68 [32.1s]: train==[2.79209=1.60056 + 1.19067 + 0.00086]
Epoch 69 [33.7s]: train==[2.79350=1.60156 + 1.19108 + 0.00086]
valid:{'recall': 0.841134, 'hit_ratio': 0.98538065, 'precision': 0.12613006, 'ndcg': 0.72233576, 'mrr': 0.8098541, 'map': 0.6843526}
test_id:{'recall': 0.841134, 'hit_ratio': 0.98538065, 'precision': 0.12613006, 'ndcg': 0.72233576, 'mrr': 0.8098541, 'map': 0.6843526}
Epoch 70 [33.8s]: train==[2.79684=1.60322 + 1.19276 + 0.00087]
Epoch 71 [33.4s]: train==[2.79383=1.60063 + 1.19234 + 0.00087]
Epoch 72 [33.5s]: train==[2.79241=1.60050 + 1.19104 + 0.00087]
Epoch 73 [33.4s]: train==[2.78879=1.59813 + 1.18979 + 0.00087]
Epoch 74 [33.6s]: train==[2.79274=1.59952 + 1.19235 + 0.00087]
valid:{'recall': 0.84161395, 'hit_ratio': 0.9855589, 'precision': 0.12620227, 'ndcg': 0.7222688, 'mrr': 0.80942386, 'map': 0.6838867}
test_id:{'recall': 0.84161395, 'hit_ratio': 0.9855589, 'precision': 0.12620227, 'ndcg': 0.7222688, 'mrr': 0.80942386, 'map': 0.6838867}
Epoch 75 [33.4s]: train==[2.79025=1.59810 + 1.19128 + 0.00087]
Epoch 76 [33.5s]: train==[2.78797=1.59644 + 1.19065 + 0.00087]
Epoch 77 [33.0s]: train==[2.78731=1.59577 + 1.19067 + 0.00087]
Epoch 78 [33.2s]: train==[2.78685=1.59496 + 1.19102 + 0.00088]
Epoch 79 [33.3s]: train==[2.79414=1.59909 + 1.19417 + 0.00088]
valid:{'recall': 0.8422395, 'hit_ratio': 0.985755, 'precision': 0.12629579, 'ndcg': 0.72231716, 'mrr': 0.80898166, 'map': 0.6833319}
test_id:{'recall': 0.8422395, 'hit_ratio': 0.985755, 'precision': 0.12629579, 'ndcg': 0.72231716, 'mrr': 0.80898166, 'map': 0.6833319}
Epoch 80 [32.1s]: train==[2.78966=1.59717 + 1.19160 + 0.00088]
Epoch 81 [32.1s]: train==[2.78640=1.59574 + 1.18977 + 0.00088]
Epoch 82 [31.9s]: train==[2.78814=1.59586 + 1.19140 + 0.00088]
Epoch 83 [31.9s]: train==[2.78867=1.59660 + 1.19119 + 0.00088]
Epoch 84 [32.0s]: train==[2.79149=1.59866 + 1.19195 + 0.00088]
valid:{'recall': 0.84197164, 'hit_ratio': 0.9856659, 'precision': 0.12625572, 'ndcg': 0.72224355, 'mrr': 0.809466, 'map': 0.6834101}
test_id:{'recall': 0.84197164, 'hit_ratio': 0.9856659, 'precision': 0.12625572, 'ndcg': 0.72224355, 'mrr': 0.809466, 'map': 0.6834101}
Epoch 85 [32.0s]: train==[2.78794=1.59542 + 1.19164 + 0.00088]
Epoch 86 [32.1s]: train==[2.78532=1.59393 + 1.19051 + 0.00089]
Epoch 87 [31.9s]: train==[2.78765=1.59423 + 1.19253 + 0.00089]
Epoch 88 [31.9s]: train==[2.78614=1.59400 + 1.19126 + 0.00089]
Epoch 89 [32.2s]: train==[2.78868=1.59447 + 1.19331 + 0.00089]
valid:{'recall': 0.8422508, 'hit_ratio': 0.98568374, 'precision': 0.12629744, 'ndcg': 0.7220656, 'mrr': 0.80841625, 'map': 0.68279827}
test_id:{'recall': 0.8422508, 'hit_ratio': 0.98568374, 'precision': 0.12629744, 'ndcg': 0.7220656, 'mrr': 0.80841625, 'map': 0.68279827}
Epoch 90 [32.1s]: train==[2.78159=1.59172 + 1.18897 + 0.00089]
Epoch 91 [32.3s]: train==[2.78605=1.59319 + 1.19197 + 0.00089]
Epoch 92 [32.3s]: train==[2.78427=1.59219 + 1.19118 + 0.00089]
Epoch 93 [32.1s]: train==[2.78575=1.59390 + 1.19095 + 0.00089]
Epoch 94 [32.0s]: train==[2.78854=1.59615 + 1.19149 + 0.00090]
valid:{'recall': 0.84235805, 'hit_ratio': 0.9856659, 'precision': 0.12631358, 'ndcg': 0.721763, 'mrr': 0.8079436, 'map': 0.68264645}
test_id:{'recall': 0.84235805, 'hit_ratio': 0.9856659, 'precision': 0.12631358, 'ndcg': 0.721763, 'mrr': 0.8079436, 'map': 0.6826465}
Epoch 95 [32.1s]: train==[2.78566=1.59220 + 1.19257 + 0.00090]
Epoch 96 [33.8s]: train==[2.78617=1.59349 + 1.19177 + 0.00090]
Epoch 97 [33.1s]: train==[2.78094=1.58941 + 1.19063 + 0.00090]
Epoch 98 [33.7s]: train==[2.78992=1.59553 + 1.19348 + 0.00090]
Epoch 99 [33.2s]: train==[2.78277=1.59085 + 1.19101 + 0.00090]
valid:{'recall': 0.8425909, 'hit_ratio': 0.985755, 'precision': 0.12634836, 'ndcg': 0.72175145, 'mrr': 0.8078555, 'map': 0.682067}
test_id:{'recall': 0.8425909, 'hit_ratio': 0.985755, 'precision': 0.12634836, 'ndcg': 0.72175145, 'mrr': 0.8078555, 'map': 0.682067}
The best epoch is  99
valid:{'recall': 0.8425909, 'hit_ratio': 0.985755, 'precision': 0.12634836, 'ndcg': 0.72175145, 'mrr': 0.8078555, 'map': 0.6820669}
test_id:{'recall': 0.8425909, 'hit_ratio': 0.985755, 'precision': 0.12634836, 'ndcg': 0.72175145, 'mrr': 0.8078555, 'map': 0.682067}
The best epoch is  99
