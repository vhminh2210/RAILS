Epoch 0 [259.7s]: train==[0.60588=0.60587 + 0.00000]
Epoch 1 [378.4s]: train==[0.38466=0.38465 + 0.00001]
Epoch 2 [396.3s]: train==[0.26734=0.26733 + 0.00001]
Epoch 3 [386.3s]: train==[0.21697=0.21695 + 0.00002]
Epoch 4 [395.0s]: train==[0.19345=0.19343 + 0.00002]
valid:{'recall': 0.5021303, 'hit_ratio': 0.8432876, 'precision': 0.150668, 'ndcg': 0.47362542, 'mrr': 0.66259456, 'map': 0.5930584}
test_id:{'recall': 0.5021303, 'hit_ratio': 0.8432876, 'precision': 0.150668, 'ndcg': 0.47362542, 'mrr': 0.66259456, 'map': 0.5930584}
Epoch 5 [371.4s]: train==[0.18253=0.18250 + 0.00003]
Epoch 6 [363.1s]: train==[0.17496=0.17493 + 0.00003]
Epoch 7 [372.3s]: train==[0.17138=0.17135 + 0.00003]
Epoch 8 [362.9s]: train==[0.16987=0.16984 + 0.00003]
Epoch 9 [345.4s]: train==[0.16746=0.16742 + 0.00004]
valid:{'recall': 0.50152355, 'hit_ratio': 0.8427349, 'precision': 0.1504865, 'ndcg': 0.47349513, 'mrr': 0.663027, 'map': 0.5947414}
test_id:{'recall': 0.50152355, 'hit_ratio': 0.8427349, 'precision': 0.1504865, 'ndcg': 0.47349513, 'mrr': 0.663027, 'map': 0.5947414}
Epoch 10 [328.7s]: train==[0.16390=0.16386 + 0.00004]
Epoch 11 [382.2s]: train==[0.16556=0.16552 + 0.00004]
Epoch 12 [351.6s]: train==[0.16385=0.16381 + 0.00004]
Epoch 13 [375.1s]: train==[0.16371=0.16367 + 0.00004]
Epoch 14 [393.4s]: train==[0.16295=0.16292 + 0.00004]
valid:{'recall': 0.498929, 'hit_ratio': 0.8443038, 'precision': 0.1497112, 'ndcg': 0.47179788, 'mrr': 0.6629902, 'map': 0.5936386}
test_id:{'recall': 0.498929, 'hit_ratio': 0.8443038, 'precision': 0.1497112, 'ndcg': 0.47179788, 'mrr': 0.6629902, 'map': 0.5936386}
Epoch 15 [305.0s]: train==[0.16218=0.16214 + 0.00004]
Epoch 16 [311.1s]: train==[0.16169=0.16165 + 0.00004]
Epoch 17 [298.1s]: train==[0.16045=0.16041 + 0.00004]
Epoch 18 [298.6s]: train==[0.15929=0.15925 + 0.00004]
Epoch 19 [308.4s]: train==[0.15992=0.15987 + 0.00004]
valid:{'recall': 0.49931607, 'hit_ratio': 0.8446425, 'precision': 0.14982696, 'ndcg': 0.4695926, 'mrr': 0.6555769, 'map': 0.5905923}
test_id:{'recall': 0.49931607, 'hit_ratio': 0.8446425, 'precision': 0.14982696, 'ndcg': 0.4695926, 'mrr': 0.6555769, 'map': 0.5905923}
Epoch 20 [380.0s]: train==[0.15902=0.15898 + 0.00005]
Epoch 21 [330.0s]: train==[0.15840=0.15836 + 0.00005]
Epoch 22 [296.4s]: train==[0.15899=0.15895 + 0.00005]
Epoch 23 [330.1s]: train==[0.15764=0.15759 + 0.00005]
Epoch 24 [375.9s]: train==[0.15586=0.15580 + 0.00005]
valid:{'recall': 0.49761188, 'hit_ratio': 0.84770906, 'precision': 0.14931692, 'ndcg': 0.46852517, 'mrr': 0.6554826, 'map': 0.59040624}
test_id:{'recall': 0.49761188, 'hit_ratio': 0.84770906, 'precision': 0.14931692, 'ndcg': 0.46852517, 'mrr': 0.6554826, 'map': 0.59040624}
Epoch 25 [345.1s]: train==[0.15725=0.15720 + 0.00005]
Epoch 26 [309.1s]: train==[0.15549=0.15543 + 0.00006]
Epoch 27 [313.6s]: train==[0.15493=0.15487 + 0.00006]
Epoch 28 [354.3s]: train==[0.15540=0.15535 + 0.00006]
Epoch 29 [366.6s]: train==[0.15385=0.15379 + 0.00006]
valid:{'recall': 0.50204504, 'hit_ratio': 0.8490105, 'precision': 0.15064506, 'ndcg': 0.47064167, 'mrr': 0.6558453, 'map': 0.5896165}
test_id:{'recall': 0.50204504, 'hit_ratio': 0.8490105, 'precision': 0.15064506, 'ndcg': 0.47064167, 'mrr': 0.6558453, 'map': 0.5896165}
Epoch 30 [315.6s]: train==[0.15272=0.15265 + 0.00006]
Epoch 31 [330.0s]: train==[0.15366=0.15359 + 0.00007]
Epoch 32 [321.7s]: train==[0.15300=0.15293 + 0.00007]
Epoch 33 [303.9s]: train==[0.15090=0.15083 + 0.00007]
Epoch 34 [308.7s]: train==[0.14966=0.14958 + 0.00007]
valid:{'recall': 0.5082941, 'hit_ratio': 0.8536459, 'precision': 0.15251917, 'ndcg': 0.47608706, 'mrr': 0.6620369, 'map': 0.5934503}
test_id:{'recall': 0.5082941, 'hit_ratio': 0.8536459, 'precision': 0.15251917, 'ndcg': 0.47608706, 'mrr': 0.6620369, 'map': 0.5934503}
Epoch 35 [318.4s]: train==[0.14839=0.14831 + 0.00008]
Epoch 36 [309.5s]: train==[0.14711=0.14703 + 0.00008]
Epoch 37 [288.8s]: train==[0.14766=0.14758 + 0.00008]
Epoch 38 [317.8s]: train==[0.14630=0.14621 + 0.00009]
Epoch 39 [290.0s]: train==[0.14496=0.14487 + 0.00009]
valid:{'recall': 0.5220075, 'hit_ratio': 0.8612587, 'precision': 0.15663217, 'ndcg': 0.48451066, 'mrr': 0.6654914, 'map': 0.5950311}
test_id:{'recall': 0.5220075, 'hit_ratio': 0.8612587, 'precision': 0.15663217, 'ndcg': 0.48451066, 'mrr': 0.6654914, 'map': 0.5950311}
Epoch 40 [354.3s]: train==[0.14404=0.14394 + 0.00009]
Epoch 41 [313.5s]: train==[0.14120=0.14110 + 0.00010]
Epoch 42 [321.5s]: train==[0.14057=0.14047 + 0.00010]
Epoch 43 [284.2s]: train==[0.13850=0.13839 + 0.00011]
Epoch 44 [338.4s]: train==[0.13649=0.13638 + 0.00011]
valid:{'recall': 0.5377461, 'hit_ratio': 0.87320375, 'precision': 0.16135068, 'ndcg': 0.5000907, 'mrr': 0.6806125, 'map': 0.60771626}
test_id:{'recall': 0.5377461, 'hit_ratio': 0.87320375, 'precision': 0.16135068, 'ndcg': 0.5000907, 'mrr': 0.6806125, 'map': 0.60771626}
Epoch 45 [301.6s]: train==[0.13477=0.13466 + 0.00011]
Epoch 46 [292.9s]: train==[0.13301=0.13289 + 0.00012]
Epoch 47 [390.7s]: train==[0.13057=0.13045 + 0.00012]
Epoch 48 [310.3s]: train==[0.12898=0.12886 + 0.00013]
Epoch 49 [348.5s]: train==[0.12619=0.12606 + 0.00013]
valid:{'recall': 0.5635969, 'hit_ratio': 0.8901765, 'precision': 0.16910346, 'ndcg': 0.5246184, 'mrr': 0.7005027, 'map': 0.62775856}
test_id:{'recall': 0.5635969, 'hit_ratio': 0.8901765, 'precision': 0.16910346, 'ndcg': 0.5246184, 'mrr': 0.7005027, 'map': 0.62775856}
Epoch 50 [359.2s]: train==[0.12431=0.12417 + 0.00014]
Epoch 51 [369.5s]: train==[0.12174=0.12160 + 0.00014]
Epoch 52 [318.3s]: train==[0.11966=0.11951 + 0.00015]
Epoch 53 [337.4s]: train==[0.11651=0.11636 + 0.00015]
Epoch 54 [288.2s]: train==[0.11584=0.11569 + 0.00016]
valid:{'recall': 0.59082866, 'hit_ratio': 0.90670353, 'precision': 0.17726384, 'ndcg': 0.5491552, 'mrr': 0.7207791, 'map': 0.64648306}
test_id:{'recall': 0.59082866, 'hit_ratio': 0.90670353, 'precision': 0.17726384, 'ndcg': 0.5491552, 'mrr': 0.7207791, 'map': 0.64648306}
Epoch 55 [294.5s]: train==[0.11359=0.11343 + 0.00016]
Epoch 56 [302.1s]: train==[0.11232=0.11215 + 0.00017]
Epoch 57 [275.7s]: train==[0.11029=0.11012 + 0.00017]
Epoch 58 [361.5s]: train==[0.10818=0.10800 + 0.00018]
Epoch 59 [300.4s]: train==[0.10630=0.10612 + 0.00018]
valid:{'recall': 0.6081294, 'hit_ratio': 0.9173293, 'precision': 0.18244767, 'ndcg': 0.56695884, 'mrr': 0.73671776, 'map': 0.6618772}
test_id:{'recall': 0.6081294, 'hit_ratio': 0.9173293, 'precision': 0.18244767, 'ndcg': 0.56695884, 'mrr': 0.73671776, 'map': 0.6618772}
Epoch 60 [285.4s]: train==[0.10461=0.10443 + 0.00019]
Epoch 61 [306.3s]: train==[0.10404=0.10385 + 0.00019]
Epoch 62 [373.7s]: train==[0.10115=0.10095 + 0.00019]
Epoch 63 [308.0s]: train==[0.09877=0.09857 + 0.00020]
Epoch 64 [284.9s]: train==[0.09758=0.09738 + 0.00020]
valid:{'recall': 0.61474586, 'hit_ratio': 0.92157245, 'precision': 0.1844299, 'ndcg': 0.5768642, 'mrr': 0.74902076, 'map': 0.6721483}
test_id:{'recall': 0.61474586, 'hit_ratio': 0.92157245, 'precision': 0.1844299, 'ndcg': 0.5768642, 'mrr': 0.74902076, 'map': 0.6721483}
Epoch 65 [362.4s]: train==[0.09734=0.09713 + 0.00021]
Epoch 66 [293.0s]: train==[0.09554=0.09533 + 0.00021]
Epoch 67 [276.5s]: train==[0.09485=0.09463 + 0.00022]
Epoch 68 [277.9s]: train==[0.09334=0.09312 + 0.00022]
Epoch 69 [274.2s]: train==[0.09247=0.09225 + 0.00022]
valid:{'recall': 0.61802447, 'hit_ratio': 0.92397934, 'precision': 0.18541448, 'ndcg': 0.58223087, 'mrr': 0.75599533, 'map': 0.67772394}
test_id:{'recall': 0.61802447, 'hit_ratio': 0.92397934, 'precision': 0.18541448, 'ndcg': 0.58223087, 'mrr': 0.75599533, 'map': 0.67772394}
Epoch 70 [293.3s]: train==[0.09092=0.09070 + 0.00023]
Epoch 71 [366.7s]: train==[0.08968=0.08945 + 0.00023]
Epoch 72 [323.9s]: train==[0.08810=0.08787 + 0.00024]
Epoch 73 [279.2s]: train==[0.08741=0.08717 + 0.00024]
Epoch 74 [272.5s]: train==[0.08518=0.08494 + 0.00024]
valid:{'recall': 0.62223333, 'hit_ratio': 0.9264931, 'precision': 0.18667501, 'ndcg': 0.586304, 'mrr': 0.7591407, 'map': 0.6807797}
test_id:{'recall': 0.62223333, 'hit_ratio': 0.9264931, 'precision': 0.18667501, 'ndcg': 0.586304, 'mrr': 0.7591407, 'map': 0.6807797}
Epoch 75 [274.6s]: train==[0.08540=0.08515 + 0.00025]
Epoch 76 [307.2s]: train==[0.08544=0.08519 + 0.00025]
Epoch 77 [290.0s]: train==[0.08317=0.08292 + 0.00025]
Epoch 78 [265.5s]: train==[0.08171=0.08145 + 0.00026]
Epoch 79 [304.2s]: train==[0.08117=0.08091 + 0.00026]
valid:{'recall': 0.6295608, 'hit_ratio': 0.9287217, 'precision': 0.18886764, 'ndcg': 0.5911478, 'mrr': 0.7617622, 'map': 0.6814115}
test_id:{'recall': 0.6295608, 'hit_ratio': 0.9287217, 'precision': 0.18886764, 'ndcg': 0.5911478, 'mrr': 0.7617622, 'map': 0.6814115}
Epoch 80 [360.6s]: train==[0.08061=0.08035 + 0.00026]
Epoch 81 [328.6s]: train==[0.07977=0.07950 + 0.00027]
Epoch 82 [268.6s]: train==[0.07855=0.07828 + 0.00027]
Epoch 83 [337.1s]: train==[0.07858=0.07831 + 0.00027]
Epoch 84 [389.7s]: train==[0.07796=0.07768 + 0.00028]
valid:{'recall': 0.6389403, 'hit_ratio': 0.9307541, 'precision': 0.19167253, 'ndcg': 0.5970905, 'mrr': 0.7643659, 'map': 0.68131274}
test_id:{'recall': 0.6389403, 'hit_ratio': 0.9307541, 'precision': 0.19167253, 'ndcg': 0.5970905, 'mrr': 0.7643659, 'map': 0.68131274}
Epoch 85 [365.2s]: train==[0.07673=0.07645 + 0.00028]
Epoch 86 [331.5s]: train==[0.07609=0.07580 + 0.00028]
Epoch 87 [290.8s]: train==[0.07544=0.07516 + 0.00029]
Epoch 88 [337.0s]: train==[0.07419=0.07390 + 0.00029]
Epoch 89 [283.0s]: train==[0.07343=0.07313 + 0.00029]
valid:{'recall': 0.6455714, 'hit_ratio': 0.9322696, 'precision': 0.19365703, 'ndcg': 0.6020862, 'mrr': 0.7666583, 'map': 0.6817571}
test_id:{'recall': 0.6455714, 'hit_ratio': 0.9322696, 'precision': 0.19365703, 'ndcg': 0.6020862, 'mrr': 0.7666583, 'map': 0.6817571}
Epoch 90 [318.7s]: train==[0.07273=0.07243 + 0.00030]
Epoch 91 [273.0s]: train==[0.07152=0.07123 + 0.00030]
Epoch 92 [288.0s]: train==[0.07062=0.07031 + 0.00030]
Epoch 93 [276.8s]: train==[0.07064=0.07034 + 0.00030]
Epoch 94 [344.0s]: train==[0.06926=0.06895 + 0.00031]
valid:{'recall': 0.64915586, 'hit_ratio': 0.9335354, 'precision': 0.1947306, 'ndcg': 0.6056659, 'mrr': 0.76841956, 'map': 0.6837132}
test_id:{'recall': 0.64915586, 'hit_ratio': 0.9335354, 'precision': 0.1947306, 'ndcg': 0.6056659, 'mrr': 0.76841956, 'map': 0.6837132}
Epoch 95 [316.6s]: train==[0.06928=0.06897 + 0.00031]
Epoch 96 [358.6s]: train==[0.06885=0.06854 + 0.00031]
Epoch 97 [360.1s]: train==[0.06689=0.06657 + 0.00032]
Epoch 98 [277.8s]: train==[0.06739=0.06707 + 0.00032]
Epoch 99 [361.9s]: train==[0.06707=0.06675 + 0.00032]
valid:{'recall': 0.65183663, 'hit_ratio': 0.9345694, 'precision': 0.19553418, 'ndcg': 0.60852116, 'mrr': 0.7697294, 'map': 0.6852979}
test_id:{'recall': 0.65183663, 'hit_ratio': 0.9345694, 'precision': 0.19553418, 'ndcg': 0.60852116, 'mrr': 0.7697294, 'map': 0.6852979}
The best epoch is  99
valid:{'recall': 0.65183663, 'hit_ratio': 0.9345694, 'precision': 0.19553418, 'ndcg': 0.60852116, 'mrr': 0.7697294, 'map': 0.6852979}
test_id:{'recall': 0.65183663, 'hit_ratio': 0.9345694, 'precision': 0.19553418, 'ndcg': 0.60852116, 'mrr': 0.7697294, 'map': 0.6852979}
The best epoch is  99
