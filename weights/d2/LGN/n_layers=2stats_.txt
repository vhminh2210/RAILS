Epoch 0 [20.8s]: train==[0.69262=0.69262 + 0.00000]
Epoch 1 [29.4s]: train==[0.68674=0.68674 + 0.00000]
Epoch 2 [33.8s]: train==[0.66614=0.66614 + 0.00000]
Epoch 3 [30.0s]: train==[0.63151=0.63151 + 0.00000]
Epoch 4 [34.6s]: train==[0.58888=0.58888 + 0.00000]
valid:{'recall': 0.22177309, 'hit_ratio': 0.47720715, 'precision': 0.066533215, 'ndcg': 0.20277882, 'mrr': 0.3119063, 'map': 0.2902123}
test_id:{'recall': 0.22177309, 'hit_ratio': 0.47720715, 'precision': 0.066533215, 'ndcg': 0.20277882, 'mrr': 0.3119063, 'map': 0.2902123}
Epoch 5 [40.7s]: train==[0.54550=0.54550 + 0.00000]
Epoch 6 [49.8s]: train==[0.50416=0.50415 + 0.00000]
Epoch 7 [39.5s]: train==[0.46653=0.46653 + 0.00001]
Epoch 8 [39.6s]: train==[0.43443=0.43442 + 0.00001]
Epoch 9 [53.1s]: train==[0.40576=0.40575 + 0.00001]
valid:{'recall': 0.22279896, 'hit_ratio': 0.47816887, 'precision': 0.066840984, 'ndcg': 0.20305674, 'mrr': 0.31164005, 'map': 0.2894092}
test_id:{'recall': 0.22279896, 'hit_ratio': 0.47816887, 'precision': 0.066840984, 'ndcg': 0.20305674, 'mrr': 0.31164005, 'map': 0.2894092}
Epoch 10 [30.1s]: train==[0.38161=0.38160 + 0.00001]
Epoch 11 [36.8s]: train==[0.36034=0.36033 + 0.00001]
Epoch 12 [37.5s]: train==[0.34256=0.34255 + 0.00001]
Epoch 13 [46.2s]: train==[0.32560=0.32559 + 0.00001]
Epoch 14 [31.4s]: train==[0.31295=0.31294 + 0.00001]
valid:{'recall': 0.22363256, 'hit_ratio': 0.47932294, 'precision': 0.06709103, 'ndcg': 0.2031341, 'mrr': 0.31102744, 'map': 0.28897032}
test_id:{'recall': 0.22363256, 'hit_ratio': 0.47932294, 'precision': 0.06709103, 'ndcg': 0.2031341, 'mrr': 0.31102744, 'map': 0.28897032}
Epoch 15 [31.8s]: train==[0.30000=0.29999 + 0.00001]
Epoch 16 [46.4s]: train==[0.28941=0.28940 + 0.00002]
Epoch 17 [43.9s]: train==[0.28077=0.28075 + 0.00002]
Epoch 18 [37.8s]: train==[0.26972=0.26970 + 0.00002]
Epoch 19 [35.1s]: train==[0.26221=0.26220 + 0.00002]
valid:{'recall': 0.22382486, 'hit_ratio': 0.47970763, 'precision': 0.06714875, 'ndcg': 0.20337975, 'mrr': 0.3117196, 'map': 0.28925326}
test_id:{'recall': 0.22382486, 'hit_ratio': 0.47970763, 'precision': 0.06714875, 'ndcg': 0.20337975, 'mrr': 0.3117196, 'map': 0.28925326}
Epoch 20 [25.9s]: train==[0.25616=0.25614 + 0.00002]
Epoch 21 [30.9s]: train==[0.24990=0.24988 + 0.00002]
Epoch 22 [31.0s]: train==[0.24049=0.24047 + 0.00002]
Epoch 23 [46.3s]: train==[0.23667=0.23664 + 0.00002]
Epoch 24 [45.3s]: train==[0.23085=0.23082 + 0.00002]
valid:{'recall': 0.2240813, 'hit_ratio': 0.48028466, 'precision': 0.06722569, 'ndcg': 0.20380893, 'mrr': 0.3127372, 'map': 0.28985828}
test_id:{'recall': 0.2240813, 'hit_ratio': 0.48028466, 'precision': 0.06722569, 'ndcg': 0.20380893, 'mrr': 0.3127372, 'map': 0.28985828}
Epoch 25 [42.4s]: train==[0.22660=0.22657 + 0.00002]
Epoch 26 [33.4s]: train==[0.22335=0.22332 + 0.00003]
Epoch 27 [33.7s]: train==[0.21863=0.21861 + 0.00003]
Epoch 28 [41.0s]: train==[0.21449=0.21446 + 0.00003]
Epoch 29 [34.8s]: train==[0.21137=0.21134 + 0.00003]
valid:{'recall': 0.22420955, 'hit_ratio': 0.47970763, 'precision': 0.067264155, 'ndcg': 0.20383535, 'mrr': 0.31246677, 'map': 0.28964365}
test_id:{'recall': 0.22420955, 'hit_ratio': 0.47970763, 'precision': 0.067264155, 'ndcg': 0.20383535, 'mrr': 0.31246677, 'map': 0.28964365}
Epoch 30 [38.4s]: train==[0.20798=0.20795 + 0.00003]
Epoch 31 [41.2s]: train==[0.20456=0.20453 + 0.00003]
Epoch 32 [45.8s]: train==[0.20229=0.20226 + 0.00003]
Epoch 33 [35.4s]: train==[0.19975=0.19971 + 0.00003]
Epoch 34 [24.2s]: train==[0.19615=0.19612 + 0.00003]
valid:{'recall': 0.22414541, 'hit_ratio': 0.47951528, 'precision': 0.06724491, 'ndcg': 0.20400055, 'mrr': 0.31283772, 'map': 0.2901137}
test_id:{'recall': 0.22414541, 'hit_ratio': 0.47951528, 'precision': 0.06724491, 'ndcg': 0.20400055, 'mrr': 0.31283772, 'map': 0.2901137}
Epoch 35 [34.4s]: train==[0.19463=0.19460 + 0.00003]
Epoch 36 [44.1s]: train==[0.19229=0.19226 + 0.00003]
Epoch 37 [41.9s]: train==[0.18836=0.18832 + 0.00003]
Epoch 38 [48.8s]: train==[0.18666=0.18662 + 0.00003]
Epoch 39 [31.3s]: train==[0.18658=0.18654 + 0.00004]
valid:{'recall': 0.22408132, 'hit_ratio': 0.47855356, 'precision': 0.067225665, 'ndcg': 0.20394908, 'mrr': 0.3126483, 'map': 0.2897738}
test_id:{'recall': 0.22408132, 'hit_ratio': 0.47855356, 'precision': 0.067225665, 'ndcg': 0.20394908, 'mrr': 0.3126483, 'map': 0.2897738}
Epoch 40 [30.7s]: train==[0.18539=0.18536 + 0.00004]
Epoch 41 [29.8s]: train==[0.18045=0.18041 + 0.00004]
Epoch 42 [31.0s]: train==[0.17935=0.17932 + 0.00004]
Epoch 43 [42.2s]: train==[0.17757=0.17753 + 0.00004]
Epoch 44 [36.2s]: train==[0.17608=0.17604 + 0.00004]
valid:{'recall': 0.2245301, 'hit_ratio': 0.47970763, 'precision': 0.06736031, 'ndcg': 0.20411581, 'mrr': 0.31270152, 'map': 0.28985542}
test_id:{'recall': 0.2245301, 'hit_ratio': 0.47970763, 'precision': 0.06736031, 'ndcg': 0.20411581, 'mrr': 0.31270152, 'map': 0.28985542}
Epoch 45 [21.5s]: train==[0.17578=0.17574 + 0.00004]
Epoch 46 [53.5s]: train==[0.17409=0.17405 + 0.00004]
Epoch 47 [36.5s]: train==[0.17240=0.17236 + 0.00004]
Epoch 48 [27.4s]: train==[0.17096=0.17092 + 0.00004]
Epoch 49 [32.5s]: train==[0.16845=0.16841 + 0.00004]
valid:{'recall': 0.2245301, 'hit_ratio': 0.48028466, 'precision': 0.06736032, 'ndcg': 0.20422138, 'mrr': 0.3130054, 'map': 0.2903086}
test_id:{'recall': 0.2245301, 'hit_ratio': 0.48028466, 'precision': 0.06736032, 'ndcg': 0.20422138, 'mrr': 0.3130054, 'map': 0.2903086}
Epoch 50 [38.1s]: train==[0.16849=0.16845 + 0.00004]
Epoch 51 [31.1s]: train==[0.16675=0.16670 + 0.00004]
Epoch 52 [36.1s]: train==[0.16628=0.16623 + 0.00004]
Epoch 53 [33.3s]: train==[0.16481=0.16477 + 0.00004]
Epoch 54 [40.8s]: train==[0.16336=0.16331 + 0.00004]
valid:{'recall': 0.22459419, 'hit_ratio': 0.48009232, 'precision': 0.06737956, 'ndcg': 0.20431396, 'mrr': 0.31301093, 'map': 0.29040092}
test_id:{'recall': 0.22459419, 'hit_ratio': 0.48009232, 'precision': 0.06737956, 'ndcg': 0.20431396, 'mrr': 0.31301093, 'map': 0.29040092}
Epoch 55 [49.4s]: train==[0.16412=0.16407 + 0.00004]
Epoch 56 [43.4s]: train==[0.16088=0.16084 + 0.00004]
Epoch 57 [44.4s]: train==[0.16029=0.16025 + 0.00005]
Epoch 58 [33.4s]: train==[0.15807=0.15802 + 0.00005]
Epoch 59 [37.8s]: train==[0.15676=0.15671 + 0.00005]
valid:{'recall': 0.2245301, 'hit_ratio': 0.47989997, 'precision': 0.06736031, 'ndcg': 0.20429651, 'mrr': 0.312983, 'map': 0.29037708}
test_id:{'recall': 0.2245301, 'hit_ratio': 0.47989997, 'precision': 0.06736031, 'ndcg': 0.20429651, 'mrr': 0.312983, 'map': 0.29037708}
Epoch 60 [30.7s]: train==[0.15687=0.15682 + 0.00005]
Epoch 61 [47.2s]: train==[0.15575=0.15570 + 0.00005]
Epoch 62 [48.4s]: train==[0.15607=0.15603 + 0.00005]
Epoch 63 [22.9s]: train==[0.15525=0.15521 + 0.00005]
Epoch 64 [31.0s]: train==[0.15349=0.15344 + 0.00005]
valid:{'recall': 0.22491477, 'hit_ratio': 0.48028466, 'precision': 0.06747573, 'ndcg': 0.20435742, 'mrr': 0.31271052, 'map': 0.29007885}
test_id:{'recall': 0.22491477, 'hit_ratio': 0.48028466, 'precision': 0.06747573, 'ndcg': 0.20435742, 'mrr': 0.31271052, 'map': 0.29007885}
Epoch 65 [28.9s]: train==[0.15275=0.15270 + 0.00005]
Epoch 66 [25.1s]: train==[0.15164=0.15159 + 0.00005]
Epoch 67 [50.8s]: train==[0.14927=0.14922 + 0.00005]
Epoch 68 [41.5s]: train==[0.15046=0.15041 + 0.00005]
Epoch 69 [43.9s]: train==[0.14977=0.14972 + 0.00005]
valid:{'recall': 0.22491477, 'hit_ratio': 0.4808617, 'precision': 0.06747573, 'ndcg': 0.20397228, 'mrr': 0.31151536, 'map': 0.28934595}
test_id:{'recall': 0.22491477, 'hit_ratio': 0.4808617, 'precision': 0.06747573, 'ndcg': 0.20397228, 'mrr': 0.31151536, 'map': 0.28934595}
Epoch 70 [42.7s]: train==[0.15086=0.15081 + 0.00005]
Epoch 71 [52.4s]: train==[0.14900=0.14894 + 0.00005]
Epoch 72 [33.9s]: train==[0.14699=0.14694 + 0.00005]
Epoch 73 [28.2s]: train==[0.14505=0.14500 + 0.00005]
Epoch 74 [31.8s]: train==[0.14679=0.14674 + 0.00005]
valid:{'recall': 0.22510715, 'hit_ratio': 0.4808617, 'precision': 0.067533426, 'ndcg': 0.20417258, 'mrr': 0.31181562, 'map': 0.2893871}
test_id:{'recall': 0.22510715, 'hit_ratio': 0.4808617, 'precision': 0.067533426, 'ndcg': 0.20417258, 'mrr': 0.31181562, 'map': 0.2893871}
Epoch 75 [31.1s]: train==[0.14688=0.14683 + 0.00005]
Epoch 76 [31.1s]: train==[0.14324=0.14319 + 0.00005]
Epoch 77 [30.3s]: train==[0.14440=0.14434 + 0.00005]
Epoch 78 [30.7s]: train==[0.14315=0.14310 + 0.00005]
Epoch 79 [29.7s]: train==[0.14123=0.14118 + 0.00005]
valid:{'recall': 0.22510712, 'hit_ratio': 0.4808617, 'precision': 0.06753343, 'ndcg': 0.2039304, 'mrr': 0.3111011, 'map': 0.28861788}
test_id:{'recall': 0.22510712, 'hit_ratio': 0.4808617, 'precision': 0.06753343, 'ndcg': 0.2039304, 'mrr': 0.3111011, 'map': 0.28861788}
Epoch 80 [28.2s]: train==[0.14357=0.14352 + 0.00005]
Epoch 81 [31.5s]: train==[0.14144=0.14139 + 0.00005]
Epoch 82 [38.7s]: train==[0.13970=0.13965 + 0.00005]
Epoch 83 [39.9s]: train==[0.13972=0.13967 + 0.00005]
Epoch 84 [32.6s]: train==[0.13963=0.13957 + 0.00005]
valid:{'recall': 0.22529943, 'hit_ratio': 0.48124638, 'precision': 0.06759113, 'ndcg': 0.20382313, 'mrr': 0.31080818, 'map': 0.28838667}
test_id:{'recall': 0.22529943, 'hit_ratio': 0.48124638, 'precision': 0.06759113, 'ndcg': 0.20382313, 'mrr': 0.31080818, 'map': 0.28838667}
Epoch 85 [37.6s]: train==[0.13872=0.13867 + 0.00005]
Epoch 86 [36.6s]: train==[0.13813=0.13808 + 0.00005]
Epoch 87 [28.6s]: train==[0.13684=0.13678 + 0.00005]
Epoch 88 [26.2s]: train==[0.13637=0.13631 + 0.00006]
Epoch 89 [28.5s]: train==[0.13741=0.13735 + 0.00006]
valid:{'recall': 0.22523531, 'hit_ratio': 0.48105404, 'precision': 0.0675719, 'ndcg': 0.20340084, 'mrr': 0.30988783, 'map': 0.287385}
test_id:{'recall': 0.22523531, 'hit_ratio': 0.48105404, 'precision': 0.0675719, 'ndcg': 0.20340084, 'mrr': 0.30988783, 'map': 0.287385}
Epoch 90 [28.4s]: train==[0.13397=0.13392 + 0.00006]
Epoch 91 [29.0s]: train==[0.13423=0.13418 + 0.00006]
Epoch 92 [25.7s]: train==[0.13445=0.13439 + 0.00006]
Epoch 93 [30.8s]: train==[0.13414=0.13408 + 0.00006]
Epoch 94 [26.2s]: train==[0.13334=0.13328 + 0.00006]
valid:{'recall': 0.22523531, 'hit_ratio': 0.48105404, 'precision': 0.0675719, 'ndcg': 0.20289814, 'mrr': 0.30847162, 'map': 0.28644785}
test_id:{'recall': 0.22523531, 'hit_ratio': 0.48105404, 'precision': 0.0675719, 'ndcg': 0.20289814, 'mrr': 0.30847162, 'map': 0.28644785}
Epoch 95 [33.7s]: train==[0.13117=0.13112 + 0.00006]
Epoch 96 [35.0s]: train==[0.13110=0.13104 + 0.00006]
Epoch 97 [46.3s]: train==[0.13099=0.13093 + 0.00006]
Epoch 98 [36.5s]: train==[0.12926=0.12921 + 0.00006]
Epoch 99 [30.1s]: train==[0.13001=0.12995 + 0.00006]
valid:{'recall': 0.22568408, 'hit_ratio': 0.48163107, 'precision': 0.06770655, 'ndcg': 0.20258577, 'mrr': 0.30744135, 'map': 0.28516287}
test_id:{'recall': 0.22568408, 'hit_ratio': 0.48163107, 'precision': 0.06770655, 'ndcg': 0.20258577, 'mrr': 0.30744135, 'map': 0.28516287}
The best epoch is  99
valid:{'recall': 0.22568408, 'hit_ratio': 0.48163107, 'precision': 0.06770655, 'ndcg': 0.20258577, 'mrr': 0.30744135, 'map': 0.28516287}
test_id:{'recall': 0.22568408, 'hit_ratio': 0.48163107, 'precision': 0.06770655, 'ndcg': 0.20258577, 'mrr': 0.30744135, 'map': 0.28516287}
The best epoch is  99
