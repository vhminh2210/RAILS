Epoch 0 [36.2s]: train==[2.38710=5.33103 + 2.38645 + 0.00065]
Epoch 1 [32.3s]: train==[2.12696=5.33355 + 2.12631 + 0.00065]
Epoch 2 [34.6s]: train==[1.91109=5.34210 + 1.91044 + 0.00065]
Epoch 3 [37.9s]: train==[1.72855=5.33232 + 1.72790 + 0.00065]
Epoch 4 [42.3s]: train==[1.57646=5.34046 + 1.57581 + 0.00065]
valid:{'recall': 0.00032057447, 'hit_ratio': 0.0009617234, 'precision': 9.617234e-05, 'ndcg': 0.00015043102, 'mrr': 0.000138076, 'map': 0.000138076}
test_id:{'recall': 0.00032057447, 'hit_ratio': 0.0009617234, 'precision': 9.617234e-05, 'ndcg': 0.00015043102, 'mrr': 0.000138076, 'map': 0.000138076}
Epoch 5 [45.4s]: train==[6.26319=4.74119 + 1.52134 + 0.00065]
Epoch 6 [44.1s]: train==[5.07440=3.54851 + 1.52523 + 0.00065]
Epoch 7 [50.4s]: train==[4.40736=2.88209 + 1.52462 + 0.00065]
Epoch 8 [52.7s]: train==[4.00244=2.47761 + 1.52418 + 0.00065]
Epoch 9 [64.6s]: train==[3.74139=2.21209 + 1.52864 + 0.00065]
valid:{'recall': 0.2467141, 'hit_ratio': 0.52298516, 'precision': 0.0740157, 'ndcg': 0.21728629, 'mrr': 0.32394734, 'map': 0.30070475}
test_id:{'recall': 0.2467141, 'hit_ratio': 0.52298516, 'precision': 0.0740157, 'ndcg': 0.21728629, 'mrr': 0.32394734, 'map': 0.30070475}
Epoch 10 [66.0s]: train==[3.52659=2.00182 + 1.52411 + 0.00065]
Epoch 11 [52.1s]: train==[3.38200=1.85999 + 1.52135 + 0.00065]
Epoch 12 [49.2s]: train==[3.27322=1.74813 + 1.52444 + 0.00065]
Epoch 13 [51.0s]: train==[3.17743=1.65624 + 1.52054 + 0.00065]
Epoch 14 [56.2s]: train==[3.10896=1.58547 + 1.52284 + 0.00065]
valid:{'recall': 0.2631923, 'hit_ratio': 0.55337566, 'precision': 0.07895916, 'ndcg': 0.22975166, 'mrr': 0.33848107, 'map': 0.31331137}
test_id:{'recall': 0.2631923, 'hit_ratio': 0.55337566, 'precision': 0.07895916, 'ndcg': 0.22975166, 'mrr': 0.33848107, 'map': 0.31331137}
Epoch 15 [56.9s]: train==[3.05191=1.52924 + 1.52202 + 0.00065]
Epoch 16 [68.7s]: train==[3.00114=1.48023 + 1.52026 + 0.00065]
Epoch 17 [55.8s]: train==[2.96789=1.44030 + 1.52693 + 0.00065]
Epoch 18 [76.3s]: train==[2.92760=1.40502 + 1.52192 + 0.00065]
Epoch 19 [44.4s]: train==[2.89665=1.37149 + 1.52451 + 0.00065]
valid:{'recall': 0.27152744, 'hit_ratio': 0.5674168, 'precision': 0.08145976, 'ndcg': 0.2356548, 'mrr': 0.34515524, 'map': 0.31913236}
test_id:{'recall': 0.27152744, 'hit_ratio': 0.5674168, 'precision': 0.08145976, 'ndcg': 0.2356548, 'mrr': 0.34515524, 'map': 0.31913236}
Epoch 20 [66.0s]: train==[2.86876=1.34285 + 1.52525 + 0.00065]
Epoch 21 [63.8s]: train==[2.83976=1.31777 + 1.52134 + 0.00065]
Epoch 22 [53.1s]: train==[2.81923=1.29976 + 1.51882 + 0.00065]
Epoch 23 [54.0s]: train==[2.80910=1.28194 + 1.52650 + 0.00065]
Epoch 24 [65.9s]: train==[2.78809=1.26146 + 1.52598 + 0.00065]
valid:{'recall': 0.27697724, 'hit_ratio': 0.5754953, 'precision': 0.08309478, 'ndcg': 0.24040167, 'mrr': 0.35154018, 'map': 0.32392615}
test_id:{'recall': 0.27697724, 'hit_ratio': 0.5754953, 'precision': 0.08309478, 'ndcg': 0.24040167, 'mrr': 0.35154018, 'map': 0.32392615}
Epoch 25 [72.3s]: train==[2.77378=1.25238 + 1.52075 + 0.00065]
Epoch 26 [53.6s]: train==[2.76604=1.24022 + 1.52517 + 0.00065]
Epoch 27 [60.2s]: train==[2.75281=1.22790 + 1.52425 + 0.00065]
Epoch 28 [52.3s]: train==[2.73782=1.20934 + 1.52783 + 0.00065]
Epoch 29 [54.1s]: train==[2.73073=1.20281 + 1.52727 + 0.00065]
valid:{'recall': 0.28056797, 'hit_ratio': 0.5806886, 'precision': 0.084171906, 'ndcg': 0.24367695, 'mrr': 0.35571328, 'map': 0.32785517}
test_id:{'recall': 0.28056797, 'hit_ratio': 0.5806886, 'precision': 0.084171906, 'ndcg': 0.24367695, 'mrr': 0.35571328, 'map': 0.32785517}
Epoch 30 [62.0s]: train==[2.71987=1.19399 + 1.52523 + 0.00065]
Epoch 31 [50.5s]: train==[2.70812=1.18752 + 1.51995 + 0.00065]
Epoch 32 [55.5s]: train==[2.70571=1.18061 + 1.52445 + 0.00065]
Epoch 33 [54.1s]: train==[2.69890=1.17223 + 1.52601 + 0.00065]
Epoch 34 [61.2s]: train==[2.69724=1.16804 + 1.52854 + 0.00065]
valid:{'recall': 0.28454313, 'hit_ratio': 0.58607423, 'precision': 0.08536446, 'ndcg': 0.24603266, 'mrr': 0.35704702, 'map': 0.32891858}
test_id:{'recall': 0.28454313, 'hit_ratio': 0.58607423, 'precision': 0.08536446, 'ndcg': 0.24603266, 'mrr': 0.35704702, 'map': 0.32891858}
Epoch 35 [55.3s]: train==[2.69345=1.16877 + 1.52403 + 0.00065]
Epoch 36 [54.2s]: train==[2.68195=1.16101 + 1.52029 + 0.00065]
Epoch 37 [54.8s]: train==[2.67274=1.15022 + 1.52186 + 0.00065]
Epoch 38 [49.6s]: train==[2.66681=1.14643 + 1.51973 + 0.00065]
Epoch 39 [62.8s]: train==[2.66319=1.14332 + 1.51922 + 0.00065]
valid:{'recall': 0.28621018, 'hit_ratio': 0.59011346, 'precision': 0.08586457, 'ndcg': 0.24759294, 'mrr': 0.35906544, 'map': 0.33148876}
test_id:{'recall': 0.28621018, 'hit_ratio': 0.59011346, 'precision': 0.08586457, 'ndcg': 0.24759294, 'mrr': 0.35906544, 'map': 0.33148876}
Epoch 40 [68.5s]: train==[2.66883=1.14328 + 1.52490 + 0.00065]
Epoch 41 [54.5s]: train==[2.66336=1.13838 + 1.52433 + 0.00065]
Epoch 42 [56.2s]: train==[2.66675=1.13995 + 1.52614 + 0.00065]
Epoch 43 [50.4s]: train==[2.65650=1.13229 + 1.52356 + 0.00065]
Epoch 44 [53.9s]: train==[2.65271=1.12937 + 1.52269 + 0.00065]
valid:{'recall': 0.28838995, 'hit_ratio': 0.5933834, 'precision': 0.086518586, 'ndcg': 0.24916446, 'mrr': 0.3605067, 'map': 0.3329637}
test_id:{'recall': 0.28838995, 'hit_ratio': 0.5933834, 'precision': 0.086518586, 'ndcg': 0.24916446, 'mrr': 0.3605067, 'map': 0.3329637}
Epoch 45 [53.4s]: train==[2.65182=1.12681 + 1.52436 + 0.00065]
Epoch 46 [54.8s]: train==[2.64601=1.12404 + 1.52131 + 0.00065]
Epoch 47 [57.6s]: train==[2.63957=1.11833 + 1.52059 + 0.00065]
Epoch 48 [59.3s]: train==[2.63724=1.11652 + 1.52007 + 0.00065]
Epoch 49 [51.9s]: train==[2.64131=1.11712 + 1.52354 + 0.00065]
valid:{'recall': 0.28986472, 'hit_ratio': 0.59453744, 'precision': 0.08696095, 'ndcg': 0.25067502, 'mrr': 0.36260718, 'map': 0.3344848}
test_id:{'recall': 0.28986472, 'hit_ratio': 0.59453744, 'precision': 0.08696095, 'ndcg': 0.25067502, 'mrr': 0.36260718, 'map': 0.3344848}
Epoch 50 [49.3s]: train==[2.64099=1.11612 + 1.52422 + 0.00065]
Epoch 51 [55.4s]: train==[2.63232=1.11346 + 1.51820 + 0.00065]
Epoch 52 [57.2s]: train==[2.62894=1.10693 + 1.52135 + 0.00065]
Epoch 53 [71.3s]: train==[2.63779=1.11385 + 1.52328 + 0.00065]
Epoch 54 [71.5s]: train==[2.63387=1.10534 + 1.52788 + 0.00065]
valid:{'recall': 0.29037738, 'hit_ratio': 0.5947298, 'precision': 0.08711487, 'ndcg': 0.25195774, 'mrr': 0.3648843, 'map': 0.33688644}
test_id:{'recall': 0.29037738, 'hit_ratio': 0.5947298, 'precision': 0.08711487, 'ndcg': 0.25195774, 'mrr': 0.3648843, 'map': 0.33688644}
Epoch 55 [61.8s]: train==[2.63473=1.10730 + 1.52677 + 0.00065]
Epoch 56 [58.8s]: train==[2.62762=1.10143 + 1.52554 + 0.00065]
Epoch 57 [56.3s]: train==[2.63162=1.10774 + 1.52322 + 0.00065]
Epoch 58 [51.7s]: train==[2.62453=1.09966 + 1.52422 + 0.00065]
Epoch 59 [56.4s]: train==[2.62495=1.09911 + 1.52518 + 0.00065]
valid:{'recall': 0.29191622, 'hit_ratio': 0.59799963, 'precision': 0.08757652, 'ndcg': 0.25261068, 'mrr': 0.365515, 'map': 0.3372969}
test_id:{'recall': 0.29191622, 'hit_ratio': 0.59799963, 'precision': 0.08757652, 'ndcg': 0.25261068, 'mrr': 0.365515, 'map': 0.3372969}
Epoch 60 [44.1s]: train==[2.62011=1.09896 + 1.52049 + 0.00066]
Epoch 61 [64.8s]: train==[2.62155=1.09608 + 1.52481 + 0.00066]
Epoch 62 [55.6s]: train==[2.61777=1.09328 + 1.52384 + 0.00066]
Epoch 63 [60.1s]: train==[2.61930=1.09556 + 1.52309 + 0.00066]
Epoch 64 [66.8s]: train==[2.61819=1.09382 + 1.52372 + 0.00066]
valid:{'recall': 0.29242927, 'hit_ratio': 0.598192, 'precision': 0.08773038, 'ndcg': 0.25356412, 'mrr': 0.36677176, 'map': 0.33814788}
test_id:{'recall': 0.29242927, 'hit_ratio': 0.598192, 'precision': 0.08773038, 'ndcg': 0.25356412, 'mrr': 0.36677176, 'map': 0.33814788}
Epoch 65 [68.4s]: train==[2.61871=1.09095 + 1.52710 + 0.00066]
Epoch 66 [67.8s]: train==[2.61785=1.09320 + 1.52399 + 0.00066]
Epoch 67 [45.7s]: train==[2.61152=1.08812 + 1.52275 + 0.00066]
Epoch 68 [49.6s]: train==[2.61703=1.09364 + 1.52274 + 0.00066]
Epoch 69 [52.1s]: train==[2.61833=1.09365 + 1.52403 + 0.00066]
valid:{'recall': 0.29422453, 'hit_ratio': 0.6030006, 'precision': 0.08826898, 'ndcg': 0.25453243, 'mrr': 0.36767334, 'map': 0.33958498}
test_id:{'recall': 0.29422453, 'hit_ratio': 0.6030006, 'precision': 0.08826898, 'ndcg': 0.25453243, 'mrr': 0.36767334, 'map': 0.33958498}
Epoch 70 [61.7s]: train==[2.60828=1.08353 + 1.52409 + 0.00066]
Epoch 71 [56.9s]: train==[2.61472=1.08707 + 1.52699 + 0.00066]
Epoch 72 [65.4s]: train==[2.60837=1.08768 + 1.52003 + 0.00066]
Epoch 73 [63.9s]: train==[2.61067=1.08594 + 1.52407 + 0.00066]
Epoch 74 [65.8s]: train==[2.61404=1.08730 + 1.52608 + 0.00066]
valid:{'recall': 0.29569918, 'hit_ratio': 0.60550106, 'precision': 0.08871138, 'ndcg': 0.25489116, 'mrr': 0.36690632, 'map': 0.33861506}
test_id:{'recall': 0.29569918, 'hit_ratio': 0.60550106, 'precision': 0.08871138, 'ndcg': 0.25489116, 'mrr': 0.36690632, 'map': 0.33861506}
Epoch 75 [54.8s]: train==[2.60505=1.08113 + 1.52326 + 0.00066]
Epoch 76 [69.5s]: train==[2.61047=1.08533 + 1.52448 + 0.00066]
Epoch 77 [58.3s]: train==[2.60151=1.07840 + 1.52246 + 0.00066]
Epoch 78 [56.7s]: train==[2.60942=1.08416 + 1.52460 + 0.00066]
Epoch 79 [82.0s]: train==[2.60265=1.07861 + 1.52339 + 0.00066]
valid:{'recall': 0.2973663, 'hit_ratio': 0.6095403, 'precision': 0.089211494, 'ndcg': 0.25546506, 'mrr': 0.36690003, 'map': 0.33837947}
test_id:{'recall': 0.2973663, 'hit_ratio': 0.6095403, 'precision': 0.089211494, 'ndcg': 0.25546506, 'mrr': 0.36690003, 'map': 0.33837947}
Epoch 80 [68.8s]: train==[2.60550=1.08358 + 1.52126 + 0.00066]
Epoch 81 [66.9s]: train==[2.60573=1.08244 + 1.52263 + 0.00066]
Epoch 82 [63.0s]: train==[2.59765=1.07840 + 1.51859 + 0.00066]
Epoch 83 [62.6s]: train==[2.60259=1.07601 + 1.52593 + 0.00066]
Epoch 84 [64.3s]: train==[2.60819=1.08341 + 1.52412 + 0.00066]
valid:{'recall': 0.29717404, 'hit_ratio': 0.6081939, 'precision': 0.08915378, 'ndcg': 0.2560979, 'mrr': 0.36891544, 'map': 0.33989543}
test_id:{'recall': 0.29717404, 'hit_ratio': 0.6081939, 'precision': 0.08915378, 'ndcg': 0.2560979, 'mrr': 0.36891544, 'map': 0.33989543}
Epoch 85 [54.5s]: train==[2.59863=1.07680 + 1.52117 + 0.00066]
Epoch 86 [51.3s]: train==[2.60123=1.07696 + 1.52361 + 0.00066]
Epoch 87 [53.2s]: train==[2.60482=1.07878 + 1.52538 + 0.00066]
Epoch 88 [45.2s]: train==[2.60178=1.07748 + 1.52365 + 0.00066]
Epoch 89 [47.2s]: train==[2.59439=1.07320 + 1.52053 + 0.00066]
valid:{'recall': 0.29762286, 'hit_ratio': 0.61030966, 'precision': 0.08928844, 'ndcg': 0.2570256, 'mrr': 0.37070692, 'map': 0.34210664}
test_id:{'recall': 0.29762286, 'hit_ratio': 0.61030966, 'precision': 0.08928844, 'ndcg': 0.2570256, 'mrr': 0.37070692, 'map': 0.34210664}
Epoch 90 [58.1s]: train==[2.59937=1.07657 + 1.52214 + 0.00066]
Epoch 91 [69.6s]: train==[2.59782=1.07662 + 1.52054 + 0.00066]
Epoch 92 [67.5s]: train==[2.60251=1.07731 + 1.52454 + 0.00066]
Epoch 93 [64.1s]: train==[2.60035=1.07592 + 1.52377 + 0.00066]
Epoch 94 [49.7s]: train==[2.59821=1.07306 + 1.52449 + 0.00066]
valid:{'recall': 0.29852042, 'hit_ratio': 0.6087709, 'precision': 0.089557685, 'ndcg': 0.2569154, 'mrr': 0.36897075, 'map': 0.34035465}
test_id:{'recall': 0.29852042, 'hit_ratio': 0.6087709, 'precision': 0.089557685, 'ndcg': 0.2569154, 'mrr': 0.36897075, 'map': 0.34035465}
Epoch 95 [49.2s]: train==[2.60346=1.07554 + 1.52726 + 0.00066]
Epoch 96 [58.3s]: train==[2.59193=1.07096 + 1.52031 + 0.00066]
Epoch 97 [54.1s]: train==[2.59492=1.07209 + 1.52217 + 0.00066]
Epoch 98 [50.9s]: train==[2.59495=1.07019 + 1.52410 + 0.00066]
Epoch 99 [53.7s]: train==[2.60058=1.07404 + 1.52588 + 0.00066]
valid:{'recall': 0.2970457, 'hit_ratio': 0.6074245, 'precision': 0.08911528, 'ndcg': 0.25655505, 'mrr': 0.36944205, 'map': 0.34122932}
test_id:{'recall': 0.2970457, 'hit_ratio': 0.6074245, 'precision': 0.08911528, 'ndcg': 0.25655505, 'mrr': 0.36944205, 'map': 0.34122932}
The best epoch is  94
valid:{'recall': 0.29852042, 'hit_ratio': 0.6087709, 'precision': 0.089557685, 'ndcg': 0.2569154, 'mrr': 0.36897075, 'map': 0.34035465}
test_id:{'recall': 0.29852042, 'hit_ratio': 0.6087709, 'precision': 0.089557685, 'ndcg': 0.2569154, 'mrr': 0.36897075, 'map': 0.34035465}
The best epoch is  94
